<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[小黄鸡]]></title>
  <link href="http://hunter222.github.io/atom.xml" rel="self"/>
  <link href="http://hunter222.github.io/"/>
  <updated>2016-09-04T20:43:50+08:00</updated>
  <id>http://hunter222.github.io/</id>
  <author>
    <name><![CDATA[chenjingxiu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[【转】mysql优化原理与方式]]></title>
    <link href="http://hunter222.github.io/blog/2016/09/02/mysql-optimize/"/>
    <updated>2016-09-02T18:19:30+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/09/02/mysql-optimize</id>
    <content type="html"><![CDATA[<p>注：由于本人总结的mysql笔记篇幅过长，截图过多，占用博客内存过大。因此在网上找到不错的文章转载过来方便以后参考:</p>

<p><a href="http://www.thinkphp.cn/topic/3855.html">http://www.thinkphp.cn/topic/3855.html</a></p>

<p>欢迎留言探讨！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Redis在php中的使用方法汇总(长篇)]]></title>
    <link href="http://hunter222.github.io/blog/2016/09/02/php-redis/"/>
    <updated>2016-09-02T18:19:28+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/09/02/php-redis</id>
    <content type="html"><![CDATA[<p>redis官方提供的命令使用技巧:</p>

<p>Redis::__construct构造函数</p>

<p>$redis = new Redis();</p>

<p>connect, open 链接redis服务</p>

<p>参数</p>

<p>host: string，服务地址</p>

<p>port: int,端口号</p>

<p>timeout: float,链接时长 (可选, 默认为 0 ，不限链接时间)</p>

<p>注: 在redis.conf中也有时间，默认为300</p>

<p>pconnect, popen 不会主动关闭的链接</p>

<p>参考上面</p>

<p>setOption 设置redis模式</p>

<p>getOption 查看redis设置的模式</p>

<p>ping 查看连接状态</p>

<p>get 得到某个key的值（string值）</p>

<p>如果该key不存在，return false</p>

<p>set 写入key 和 value（string值）</p>

<p>如果写入成功，return ture</p>

<p>setex 带生存时间的写入值</p>

<p>$redis->setex(&lsquo;key&rsquo;, 3600, &lsquo;value&rsquo;); // sets key → value, with 1h TTL.</p>

<p>setnx 判断是否重复的，写入值</p>

<p>$redis->setnx(&lsquo;key&rsquo;, &lsquo;value&rsquo;);</p>

<p>$redis->setnx(&lsquo;key&rsquo;, &lsquo;value&rsquo;);</p>

<p>delete 删除指定key的值</p>

<p>返回已经删除key的个数（长整数）</p>

<p>$redis->delete(&lsquo;key1&rsquo;, &lsquo;key2&rsquo;);</p>

<p>$redis->delete(array(&lsquo;key3&rsquo;, &lsquo;key4&rsquo;, &lsquo;key5&rsquo;));</p>

<p>ttl
得到一个key的生存时间</p>

<p>persist
移除生存时间到期的key
如果key到期 true 如果不到期 false</p>

<p>mset （redis版本1.1以上才可以用）
同时给多个key赋值</p>

<p>$redis->mset(array(&lsquo;key0&rsquo; => &lsquo;value0&rsquo;, &lsquo;key1&rsquo; => &lsquo;value1&rsquo;));</p>

<p>multi, exec, discard</p>

<p>进入或者退出事务模式</p>

<p>参数可选Redis::MULTI或Redis::PIPELINE. 默认是 Redis::MULTI</p>

<p>Redis::MULTI：将多个操作当成一个事务执行</p>

<p>Redis::PIPELINE:让（多条）执行命令简单的，更加快速的发送给服务器，但是没有任何原子性的保证
discard:删除一个事务</p>

<p>返回值</p>

<p>multi()，返回一个redis对象，并进入multi-mode模式，一旦进入multi-mode模式，以后调用的所有方法都会返回相同的对象，只到exec(）方法被调用。</p>

<p>watch, unwatch （代码测试后，不能达到所说的效果）</p>

<p>监测一个key的值是否被其它的程序更改。如果这个key在watch 和 exec （方法）间被修改，这个 MULTI/EXEC 事务的执行将失败（return false）</p>

<p>unwatch 取消被这个程序监测的所有key</p>

<p>参数，一对key的列表</p>

<p>$redis->watch(&lsquo;x&rsquo;);</p>

<p>$ret = $redis->multi() ->incr(&lsquo;x&rsquo;) ->exec();</p>

<p>subscribe *</p>

<p>方法回调。注意，该方法可能在未来里发生改变</p>

<p>publish *</p>

<p>发表内容到某一个通道。注意，该方法可能在未来里发生改变</p>

<p>exists</p>

<p>判断key是否存在。存在 true 不在 false</p>

<p>incr, incrBy</p>

<p>key中的值进行自增1，如果填写了第二个参数，者自增第二个参数所填的值</p>

<p>$redis->incr(&lsquo;key1&rsquo;);</p>

<p>$redis->incrBy(&lsquo;key1&rsquo;, 10);</p>

<p>decr, decrBy</p>

<p>做减法，使用方法同incr</p>

<p>getMultiple</p>

<p>传参</p>

<p>由key组成的数组</p>

<p>返回参数</p>

<p>如果key存在返回value，不存在返回false</p>

<p>$redis->set(&lsquo;key1&rsquo;, &lsquo;value1&rsquo;); $redis->set(&lsquo;key2&rsquo;, &lsquo;value2&rsquo;); $redis->set(&lsquo;key3&rsquo;, &lsquo;value3&rsquo;); $redis->getMultiple(array(&lsquo;key1&rsquo;, &lsquo;key2&rsquo;, &lsquo;key3&rsquo;));</p>

<p>$redis->lRem(&lsquo;key1&rsquo;, &lsquo;A&rsquo;, 2);</p>

<p>$redis->lRange(&lsquo;key1&rsquo;, 0, -1);</p>

<p>list相关操作</p>

<p>lPush</p>

<p>$redis->lPush(key, value);</p>

<p>在名称为key的list左边（头）添加一个值为value的 元素</p>

<p>rPush</p>

<p>$redis->rPush(key, value);</p>

<p>在名称为key的list右边（尾）添加一个值为value的 元素</p>

<p>lPushx/rPushx</p>

<p>$redis->lPushx(key, value);</p>

<p>在名称为key的list左边(头)/右边（尾）添加一个值为value的元素,如果value已经存在，则不添加</p>

<p>lPop/rPop</p>

<p>$redis->lPop(&lsquo;key&rsquo;);</p>

<p>输出名称为key的list左(头)起/右（尾）起的第一个元素，删除该元素</p>

<p>blPop/brPop</p>

<p>$redis->blPop(&lsquo;key1&rsquo;, &lsquo;key2&rsquo;, 10);</p>

<p>lpop命令的block版本。即当timeout为0时，若遇到名称为key i的list不存在或该list为空，则命令结束。如果timeout>0，则遇到上述情况时，等待timeout秒，如果问题没有解决，则对keyi+1开始的list执行pop操作</p>

<p>lSize</p>

<p>$redis->lSize(&lsquo;key&rsquo;);</p>

<p>返回名称为key的list有多少个元素</p>

<p>lIndex, lGet</p>

<p>$redis->lGet(&lsquo;key&rsquo;, 0);</p>

<p>返回名称为key的list中index位置的元素</p>

<p>lSet</p>

<p>$redis->lSet(&lsquo;key&rsquo;, 0, &lsquo;X&rsquo;);</p>

<p>给名称为key的list中index位置的元素赋值为value</p>

<p>lRange, lGetRange</p>

<p>$redis->lRange(&lsquo;key1&rsquo;, 0, -1);</p>

<p>返回名称为key的list中start至end之间的元素（end为 -1 ，返回所有）</p>

<p>lTrim, listTrim</p>

<p>$redis->lTrim(&lsquo;key&rsquo;, start, end);</p>

<p>截取名称为key的list，保留start至end之间的元素</p>

<p>lRem, lRemove</p>

<p>$redis->lRem(&lsquo;key&rsquo;, &lsquo;A&rsquo;, 2);</p>

<p>删除count个名称为key的list中值为value的元素。count为0，删除所有值为value的元素，count>0从头至尾删除count个值为value的元素，count&lt;0从尾到头删除|count|个值为value的元素</p>

<p>lInsert</p>

<p>在名称为为key的list中，找到值为pivot 的value，并根据参数Redis::BEFORE | Redis::AFTER，来确定，newvalue 是放在 pivot 的前面，或者后面。如果key不存在，不会插入，如果 pivot不存在，return -1</p>

<p>$redis->delete(&lsquo;key1&rsquo;); $redis->lInsert(&lsquo;key1&rsquo;, Redis::AFTER, &lsquo;A&rsquo;, &lsquo;X&rsquo;);</p>

<p>$redis->lPush(&lsquo;key1&rsquo;, &lsquo;A&rsquo;); $redis->lPush(&lsquo;key1&rsquo;, &lsquo;B&rsquo;); $redis->lPush(&lsquo;key1&rsquo;, &lsquo;C&rsquo;);</p>

<p>$redis->lInsert(&lsquo;key1&rsquo;, Redis::BEFORE, &lsquo;C&rsquo;, &lsquo;X&rsquo;);</p>

<p>$redis->lRange(&lsquo;key1&rsquo;, 0, -1);</p>

<p>$redis->lInsert(&lsquo;key1&rsquo;, Redis::AFTER, &lsquo;C&rsquo;, &lsquo;Y&rsquo;);</p>

<p>$redis->lRange(&lsquo;key1&rsquo;, 0, -1);</p>

<p>$redis->lInsert(&lsquo;key1&rsquo;, Redis::AFTER, &lsquo;W&rsquo;, &lsquo;value&rsquo;);</p>

<p>rpoplpush</p>

<p>返回并删除名称为srckey的list的尾元素，并将该元素添加到名称为dstkey的list的头部</p>

<p>$redis->delete(&lsquo;x&rsquo;, &lsquo;y&rsquo;);</p>

<p>$redis->lPush(&lsquo;x&rsquo;, &lsquo;abc&rsquo;); $redis->lPush(&lsquo;x&rsquo;, &lsquo;def&rsquo;); $redis->lPush(&lsquo;y&rsquo;, &lsquo;123&rsquo;);</p>

<p>$redis->lPush(&lsquo;y&rsquo;, &lsquo;456&rsquo;); // move the last of x to the front of y. var_dump($redis->rpoplpush(&lsquo;x&rsquo;, &lsquo;y&rsquo;));</p>

<p>var_dump($redis->lRange(&lsquo;x&rsquo;, 0, -1));</p>

<p>var_dump($redis->lRange(&lsquo;y&rsquo;, 0, -1));</p>

<p>string(3) &ldquo;abc&rdquo;</p>

<p>array(1) { [0]=> string(3) &ldquo;def&rdquo; }</p>

<p>array(3) { [0]=> string(3) &ldquo;abc&rdquo; [1]=> string(3) &ldquo;456&rdquo; [2]=> string(3) &ldquo;123&rdquo; }</p>

<p>SET操作相关</p>

<p>sAdd</p>

<p>向名称为key的set中添加元素value,如果value存在，不写入，return false</p>

<p>$redis->sAdd(key , value);</p>

<p>sRem, sRemove</p>

<p>删除名称为key的set中的元素value</p>

<p>$redis->sAdd(&lsquo;key1&rsquo; , &lsquo;set1&rsquo;);</p>

<p>$redis->sAdd(&lsquo;key1&rsquo; , &lsquo;set2&rsquo;);</p>

<p>$redis->sAdd(&lsquo;key1&rsquo; , &lsquo;set3&rsquo;);</p>

<p>$redis->sRem(&lsquo;key1&rsquo;, &lsquo;set2&rsquo;);</p>

<p>sMove</p>

<p>将value元素从名称为srckey的集合移到名称为dstkey的集合</p>

<p>$redis->sMove(seckey, dstkey, value);</p>

<p>sIsMember, sContains</p>

<p>名称为key的集合中查找是否有value元素，有ture 没有 false</p>

<p>$redis->sIsMember(key, value);</p>

<p>sCard, sSize</p>

<p>返回名称为key的set的元素个数</p>

<p>sPop</p>

<p>随机返回并删除名称为key的set中一个元素</p>

<p>sRandMember</p>

<p>随机返回名称为key的set中一个元素，不删除</p>

<p>sInter</p>

<p>求交集</p>

<p>sInterStore</p>

<p>求交集并将交集保存到output的集合</p>

<p>$redis->sInterStore(&lsquo;output&rsquo;, &lsquo;key1&rsquo;, &lsquo;key2&rsquo;, &lsquo;key3&rsquo;)</p>

<p>sUnion</p>

<p>求并集</p>

<p>$redis->sUnion(&lsquo;s0&rsquo;, &lsquo;s1&rsquo;, &lsquo;s2&rsquo;);</p>

<p>s0,s1,s2 同时求并集</p>

<p>sUnionStore</p>

<p>求并集并将并集保存到output的集合</p>

<p>$redis->sUnionStore(&lsquo;output&rsquo;, &lsquo;key1&rsquo;, &lsquo;key2&rsquo;, &lsquo;key3&rsquo;)；</p>

<p>sDiff</p>

<p>求差集</p>

<p>sDiffStore</p>

<p>求差集并将差集保存到output的集合</p>

<p>sMembers, sGetMembers</p>

<p>返回名称为key的set的所有元素</p>

<p>sort</p>

<p>排序，分页等</p>

<p>参数</p>

<p>&lsquo;by&rsquo; => &lsquo;some_pattern_*&rsquo;,</p>

<p>&lsquo;limit&rsquo; => array(0, 1),</p>

<p>&lsquo;get&rsquo; => &lsquo;some_other_pattern_*&rsquo; or an array of patterns,</p>

<p>&lsquo;sort&rsquo; => &lsquo;asc&rsquo; or &lsquo;desc&rsquo;,</p>

<p>&lsquo;alpha&rsquo; => TRUE,</p>

<p>&lsquo;store&rsquo; => &lsquo;external-key&rsquo;
例子</p>

<p>$redis->delete(&rsquo;s'); $redis->sadd(&rsquo;s', 5); $redis->sadd(&rsquo;s', 4); $redis->sadd(&rsquo;s', 2); $redis->sadd(&rsquo;s', 1); $redis->sadd(&rsquo;s', 3);</p>

<p>var_dump($redis->sort(&rsquo;s')); // 1,2,3,4,5</p>

<p>var_dump($redis->sort(&rsquo;s', array(&lsquo;sort&rsquo; => &lsquo;desc&rsquo;))); // 5,4,3,2,1</p>

<p>var_dump($redis->sort(&rsquo;s', array(&lsquo;sort&rsquo; => &lsquo;desc&rsquo;, &lsquo;store&rsquo; => &lsquo;out&rsquo;))); // (int)5</p>

<p>string命令</p>

<p>getSet</p>

<p>返回原来key中的值，并将value写入key</p>

<p>$redis->set(&lsquo;x&rsquo;, &lsquo;42&rsquo;);</p>

<p>$exValue = $redis->getSet(&lsquo;x&rsquo;, &lsquo;lol&rsquo;); // return &lsquo;42&rsquo;, replaces x by &lsquo;lol&rsquo;</p>

<p>$newValue = $redis->get(&lsquo;x&rsquo;)&lsquo; // return 'lol&rsquo;</p>

<p>append</p>

<p>string，名称为key的string的值在后面加上value</p>

<p>$redis->set(&lsquo;key&rsquo;, &lsquo;value1&rsquo;);</p>

<p>$redis->append(&lsquo;key&rsquo;, &lsquo;value2&rsquo;);</p>

<p>$redis->get(&lsquo;key&rsquo;);</p>

<p>getRange （方法不存在）</p>

<p>返回名称为key的string中start至end之间的字符</p>

<p>$redis->set(&lsquo;key&rsquo;, &lsquo;string value&rsquo;);</p>

<p>$redis->getRange(&lsquo;key&rsquo;, 0, 5);</p>

<p>$redis->getRange(&lsquo;key&rsquo;, -5, -1);</p>

<p>setRange （方法不存在）</p>

<p>改变key的string中start至end之间的字符为value</p>

<p>$redis->set(&lsquo;key&rsquo;, &lsquo;Hello world&rsquo;);</p>

<p>$redis->setRange(&lsquo;key&rsquo;, 6, &ldquo;redis&rdquo;);</p>

<p>$redis->get(&lsquo;key&rsquo;);</p>

<p>strlen</p>

<p>得到key的string的长度</p>

<p>$redis->strlen(&lsquo;key&rsquo;);</p>

<p>getBit/setBit</p>

<p>返回2进制信息</p>

<p>zset（sorted set）操作相关</p>

<p>zAdd(key, score, member)：向名称为key的zset中添加元素member，score用于排序。如果该元素已经
存在，则根据score更新该元素的顺序。</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 1, &lsquo;val1&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 0, &lsquo;val0&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 5, &lsquo;val5&rsquo;);</p>

<p>$redis->zRange(&lsquo;key&rsquo;, 0, -1); // array(val0, val1, val5)</p>

<p>zRange(key, start, end,withscores)：返回名称为key的zset（元素已按score从小到大排序）中的
index从start到end的所有元素</p>

<p>$redis->zAdd(&lsquo;key1&rsquo;, 0, &lsquo;val0&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key1&rsquo;, 2, &lsquo;val2&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key1&rsquo;, 10, &lsquo;val10&rsquo;);</p>

<p>$redis->zRange(&lsquo;key1&rsquo;, 0, -1); // with scores $redis->zRange(&lsquo;key1&rsquo;, 0, -1, true);</p>

<p>zDelete, zRem</p>

<p>zRem(key, member) ：删除名称为key的zset中的元素member</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 0, &lsquo;val0&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 2, &lsquo;val2&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 10, &lsquo;val10&rsquo;);</p>

<p>$redis->zDelete(&lsquo;key&rsquo;, &lsquo;val2&rsquo;);</p>

<p>$redis->zRange(&lsquo;key&rsquo;, 0, -1);</p>

<p>zRevRange(key, start, end,withscores)：返回名称为key的zset（元素已按score从大到小排序）中
的index从start到end的所有元素.withscores: 是否输出socre的值，默认false，不输出</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 0, &lsquo;val0&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 2, &lsquo;val2&rsquo;);</p>

<p>$redis->zAdd(&lsquo;key&rsquo;, 10, &lsquo;val10&rsquo;);</p>

<p>$redis->zRevRange(&lsquo;key&rsquo;, 0, -1); // with scores $redis->zRevRange(&lsquo;key&rsquo;, 0, -1,
true);</p>

<p>zRangeByScore, zRevRangeByScore</p>

<p>$redis->zRangeByScore(key, star, end, array(withscores， limit ));
返回名称为key的zset中score >= star且score &lt;= end的所有元素</p>

<p>zCount</p>

<p>$redis->zCount(key, star, end);
返回名称为key的zset中score >= star且score &lt;= end的所有元素的个数</p>

<p>zRemRangeByScore, zDeleteRangeByScore</p>

<p>$redis->zRemRangeByScore(&lsquo;key&rsquo;, star, end);
删除名称为key的zset中score >= star且score &lt;= end的所有元素，返回删除个数</p>

<p>zSize, zCard</p>

<p>返回名称为key的zset的所有元素的个数</p>

<p>zScore</p>

<p>$redis->zScore(key, val2);
返回名称为key的zset中元素val2的score</p>

<p>zRank, zRevRank</p>

<p>$redis->zRevRank(key, val);
返回名称为key的zset（元素已按score从小到大排序）中val元素的rank（即index，从0开始），若没有val元素，返回“null”。zRevRank 是从大到小排序</p>

<p>zIncrBy</p>

<p>$redis->zIncrBy(&lsquo;key&rsquo;, increment, &lsquo;member&rsquo;);
如果在名称为key的zset中已经存在元素member，则该元素的score增加increment；否则向集合中添加该元素，其score的值为increment</p>

<p>zUnion/zInter</p>

<p>参数</p>

<p>keyOutput</p>

<p>arrayZSetKeys</p>

<p>arrayWeights</p>

<p>aggregateFunction Either &ldquo;SUM&rdquo;, &ldquo;MIN&rdquo;, or &ldquo;MAX&rdquo;: defines the behaviour to use on duplicate entries during the zUnion.</p>

<p>对N个zset求并集和交集，并将最后的集合保存在dstkeyN中。对于集合中每一个元素的score，在进行
AGGREGATE运算前，都要乘以对于的WEIGHT参数。如果没有提供WEIGHT，默认为1。默认的AGGREGATE是SUM，即结果集合中元素的score是所有集合对应元素进行SUM运算的值，而MIN和MAX是指，结果集合中元素的score是所有集合对应元素中最小值和最大值。</p>

<p>Hash操作</p>

<p>hSet</p>

<p>$redis->hSet(&lsquo;h&rsquo;, &lsquo;key1&rsquo;, &lsquo;hello&rsquo;);</p>

<p>向名称为h的hash中添加元素key1—>hello</p>

<p>hGet</p>

<p>$redis->hGet(&lsquo;h&rsquo;, &lsquo;key1&rsquo;);
返回名称为h的hash中key1对应的value（hello）</p>

<p>hLen</p>

<p>$redis->hLen(&lsquo;h&rsquo;);
返回名称为h的hash中元素个数</p>

<p>hDel</p>

<p>$redis->hDel(&lsquo;h&rsquo;, &lsquo;key1&rsquo;);
删除名称为h的hash中键为key1的域</p>

<p>hKeys</p>

<p>$redis->hKeys(&lsquo;h&rsquo;);
返回名称为key的hash中所有键</p>

<p>hVals</p>

<p>$redis->hVals(&lsquo;h&rsquo;)
返回名称为h的hash中所有键对应的value</p>

<p>hGetAll</p>

<p>$redis->hGetAll(&lsquo;h&rsquo;);
返回名称为h的hash中所有的键（field）及其对应的value</p>

<p>hExists</p>

<p>$redis->hExists(&lsquo;h&rsquo;, &lsquo;a&rsquo;);
名称为h的hash中是否存在键名字为a的域</p>

<p>hIncrBy</p>

<p>$redis->hIncrBy(&lsquo;h&rsquo;, &lsquo;x&rsquo;, 2);
将名称为h的hash中x的value增加2</p>

<p>hMset</p>

<p>$redis->hMset(&lsquo;user:1&rsquo;, array(&lsquo;name&rsquo; => &lsquo;Joe&rsquo;, &lsquo;salary&rsquo; => 2000));
向名称为key的hash中批量添加元素</p>

<p>hMGet</p>

<p>$redis->hmGet(&lsquo;h&rsquo;, array(&lsquo;field1&rsquo;, &lsquo;field2&rsquo;));
返回名称为h的hash中field1,field2对应的value</p>

<p>redis 操作相关</p>

<p>flushDB
清空当前数据库</p>

<p>flushAll
清空所有数据库</p>

<p>randomKey
随机返回key空间的一个key</p>

<p>$key = $redis->randomKey();</p>

<p>select</p>

<p>选择一个数据库</p>

<p>move</p>

<p>转移一个key到另外一个数据库</p>

<p>$redis->select(0); // switch to DB 0</p>

<p>$redis->set(&lsquo;x&rsquo;, &lsquo;42&rsquo;); // write 42 to x</p>

<p>$redis->move(&lsquo;x&rsquo;, 1); // move to DB 1</p>

<p>$redis->select(1); // switch to DB 1</p>

<p>$redis->get(&lsquo;x&rsquo;); // will return 42</p>

<p>rename, renameKey
给key重命名</p>

<p>$redis->set(&lsquo;x&rsquo;, &lsquo;42&rsquo;);</p>

<p>$redis->rename(&lsquo;x&rsquo;, &lsquo;y&rsquo;);</p>

<p>$redis->get(&lsquo;y&rsquo;); // → 42</p>

<p>$redis->get(&lsquo;x&rsquo;); // → <code>FALSE</code></p>

<p>renameNx</p>

<p>与remane类似，但是，如果重新命名的名字已经存在，不会替换成功</p>

<p>setTimeout, expire</p>

<p>设定一个key的活动时间（s）</p>

<p>$redis->setTimeout(&lsquo;x&rsquo;, 3);</p>

<p>expireAt</p>

<p>key存活到一个unix时间戳时间</p>

<p>$redis->expireAt(&lsquo;x&rsquo;, time() + 3);</p>

<p>keys, getKeys
返回满足给定pattern的所有key</p>

<p>$keyWithUserPrefix = $redis->keys(&lsquo;user*&rsquo;);</p>

<p>dbSize
查看现在数据库有多少key</p>

<p>$count = $redis->dbSize();</p>

<p>auth
密码认证</p>

<p>$redis->auth(&lsquo;foobared&rsquo;);</p>

<p>bgrewriteaof
使用aof来进行数据库持久化</p>

<p>$redis->bgrewriteaof();</p>

<p>slaveof
选择从服务器</p>

<p>$redis->slaveof(&lsquo;10.0.1.7&rsquo;, 6379);</p>

<p>save
将数据同步保存到磁盘</p>

<p>bgsave
将数据异步保存到磁盘</p>

<p>lastSave
返回上次成功将数据保存到磁盘的Unix时戳</p>

<p>info
返回redis的版本信息等详情</p>

<p>type
返回key的类型值</p>

<p>string: Redis::REDIS_STRING</p>

<p>set: Redis::REDIS_SET</p>

<p>list: Redis::REDIS_LIST</p>

<p>zset: Redis::REDIS_ZSET</p>

<p>hash: Redis::REDIS_HASH</p>

<p>other: Redis::REDIS_NOT_FOUND</p>

<p>示例代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1//使用autoload加载相关库,这边重点就是为了require $file;
</span><span class='line'>  2spl_autoload_register(function($class) {
</span><span class='line'>  3$file = __DIR__.’/lib/Predis/’.$class.’.php’;
</span><span class='line'>  4 if (file_exists($file)) {
</span><span class='line'>  5 require $file;
</span><span class='line'>  6 return true;
</span><span class='line'>  7 }
</span><span class='line'>  8 });
</span><span class='line'>  9 
</span><span class='line'> 10 //配置连接的IP、端口、以及相应的数据库
</span><span class='line'> 11 $server = array(
</span><span class='line'> 12 ‘host’     =&gt; ’127.0.0.1′,
</span><span class='line'> 13 ‘port’     =&gt; 6379,
</span><span class='line'> 14 ‘database’ =&gt; 15
</span><span class='line'> 15 );
</span><span class='line'> 16 $redis = new Client($server);
</span><span class='line'> 17 
</span><span class='line'> 18 //普通set/get操作
</span><span class='line'> 19 $redis-&gt;set(‘library’, ‘predis’);
</span><span class='line'> 20 $retval = $redis-&gt;get(‘library’);
</span><span class='line'> 21 echo $retval; //显示 ‘predis’
</span><span class='line'> 22 
</span><span class='line'> 23 //setex set一个存储时效
</span><span class='line'> 24 $redis-&gt;setex(‘str’, 10, ‘bar’); //表示存储有效期为10秒
</span><span class='line'> 25 
</span><span class='line'> 26 //setnx/msetnx相当于add操作,不会覆盖已有值
</span><span class='line'> 27 $redis-&gt;setnx(‘foo’,12); //true
</span><span class='line'> 28 $redis-&gt;setnx(‘foo’,34); //false
</span><span class='line'> 29 
</span><span class='line'> 30 //getset操作,set的变种,结果返回替换前的值
</span><span class='line'> 31 $redis-&gt;getset(‘foo’,56);//返回34
</span><span class='line'> 32 
</span><span class='line'> 33 // incrby/incr/decrby/decr 对值的递增和递减
</span><span class='line'> 34 $redis-&gt;incr(‘foo’); //foo为57
</span><span class='line'> 35 $redis-&gt;incrby(‘foo’,2); //foo为59
</span><span class='line'> 36 
</span><span class='line'> 37 //exists检测是否存在某值
</span><span class='line'> 38 $redis-&gt;exists(‘foo’);//true
</span><span class='line'> 39 
</span><span class='line'> 40 //del 删除
</span><span class='line'> 41 $redis-&gt;del(‘foo’);//true
</span><span class='line'> 42 
</span><span class='line'> 43 //type 类型检测,字符串返回string,列表返回 list,set表返回set/zset,hash表返回hash
</span><span class='line'> 44 $redis-&gt;type(‘foo’);//不存在,返回none
</span><span class='line'> 45 $redis-&gt;set(‘str’,'test’);
</span><span class='line'> 46 $redis-&gt;type(‘str’); //字符串，返回string
</span><span class='line'> 47 
</span><span class='line'> 48 //append 连接到已存在字符串
</span><span class='line'> 49 $redis-&gt;append(‘str’,'_123′); //返回累加后的字符串长度8,此进str为 ‘test_123′
</span><span class='line'> 50 
</span><span class='line'> 51 //setrange 部分替换操作
</span><span class='line'> 52 $redis-&gt;setrange(‘str’,0,’abc’); //返回3,参数2为0时等同于set操作
</span><span class='line'> 53 $redis-&gt;setrange(‘str’,2,’cd’);//返回4,表示从第2个字符后替换,这时’str’为’abcd’
</span><span class='line'> 54 
</span><span class='line'> 55 //substr 部分获取操作
</span><span class='line'> 56 $redis-&gt;substr(‘str’,0,2);//表示从第0个起，取到第2个字符，共3个，返回’abc’
</span><span class='line'> 57 
</span><span class='line'> 58 //strlen 获取字符串长度
</span><span class='line'> 59 $redis-&gt;strlen(‘str’); //返回4
</span><span class='line'> 60 
</span><span class='line'> 61 //setbit/getbit 位存储和获取
</span><span class='line'> 62 $redis-&gt;setbit(‘binary’,31,1);  //表示在第31位存入1,这边可能会有大小端问题?不过没关系,getbit 应该不会有问题
</span><span class='line'> 63 $redis-&gt;getbit(‘binary’,31);    //返回1
</span><span class='line'> 64 
</span><span class='line'> 65 //keys 模糊查找功能,支持*号以及?号(匹配一个字符)
</span><span class='line'> 66 $redis-&gt;set(‘foo1′,123);
</span><span class='line'> 67 $redis-&gt;set(‘foo2′,456);
</span><span class='line'> 68 $redis-&gt;keys(‘foo*’); //返回foo1和foo2的array
</span><span class='line'> 69 $redis-&gt;keys(‘f?o?’);  //同上
</span><span class='line'> 70 
</span><span class='line'> 71 //randomkey 随机返回一个key
</span><span class='line'> 72 $redis-&gt;randomkey(); //可能是返回 ‘foo1′或者是’foo2′及其它任何一存在redis的key
</span><span class='line'> 73 
</span><span class='line'> 74 //rename/renamenx 对key进行改名,所不同的是renamenx不允许改成已存在的key
</span><span class='line'> 75 $redis-&gt;rename(‘str’,'str2′); //把原先命名为’str’的key改成了’str2′
</span><span class='line'> 76 
</span><span class='line'> 77 //expire 设置key-value的时效性,ttl 获取剩余有效期,persist 重新设置为永久存储
</span><span class='line'> 78 $redis-&gt;expire(‘foo’, 1); //设置有效期为1秒
</span><span class='line'> 79 $redis-&gt;ttl(‘foo’); //返回有效期值1s
</span><span class='line'> 80 $redis-&gt;expire(‘foo’); //取消expire行为
</span><span class='line'> 81 
</span><span class='line'> 82 //dbsize 返回redis当前数据库的记录总数
</span><span class='line'> 83 $redis-&gt;dbsize();
</span><span class='line'> 84 
</span><span class='line'> 85 /*
</span><span class='line'> 86 队列操作
</span><span class='line'> 87 */
</span><span class='line'> 88 
</span><span class='line'> 89 //rpush/rpushx 有序列表操作,从队列后插入元素
</span><span class='line'> 90 //lpush/lpushx 和rpush/rpushx的区别是插入到队列的头部,同上,’x'含义是只对已存在的key进行操作
</span><span class='line'> 91 $redis-&gt;rpush(‘fooList’, ‘bar1′); //返回一个列表的长度1
</span><span class='line'> 92 $redis-&gt;lpush(‘fooList’, ‘bar0′); //返回一个列表的长度2
</span><span class='line'> 93 $redis-&gt;rpushx(‘fooList’, ‘bar2′); //返回3,rpushx只对已存在的队列做添加,否则返回0
</span><span class='line'> 94 //llen返回当前列表长度
</span><span class='line'> 95 $redis-&gt;llen(‘fooList’);//3
</span><span class='line'> 96 
</span><span class='line'> 97 //lrange 返回队列中一个区间的元素
</span><span class='line'> 98 $redis-&gt;lrange(‘fooList’,0,1); //返回数组包含第0个至第1个共2个元素
</span><span class='line'> 99 $redis-&gt;lrange(‘fooList’,0,-1);//返回第0个至倒数第一个,相当于返回所有元素,注意redis中很多时候会用到负数,下同
</span><span class='line'>100 
</span><span class='line'>101 //lindex 返回指定顺序位置的list元素
</span><span class='line'>102 $redis-&gt;lindex(‘fooList’,1); //返回’bar1′
</span><span class='line'>103 
</span><span class='line'>104 //lset 修改队列中指定位置的value
</span><span class='line'>105 $redis-&gt;lset(‘fooList’,1,’123′);//修改位置1的元素,返回true
</span><span class='line'>106 
</span><span class='line'>107 //lrem 删除队列中左起指定数量的字符
</span><span class='line'>108 $redis-&gt;lrem(‘fooList’,1,’_'); //删除队列中左起(右起使用-1)1个字符’_'(若有)
</span><span class='line'>109 
</span><span class='line'>110 //lpop/rpop 类似栈结构地弹出(并删除)最左或最右的一个元素
</span><span class='line'>111 $redis-&gt;lpop(‘fooList’); //’bar0′
</span><span class='line'>112 $redis-&gt;rpop(‘fooList’); //’bar2′
</span><span class='line'>113 
</span><span class='line'>114 //ltrim 队列修改，保留左边起若干元素，其余删除
</span><span class='line'>115 $redis-&gt;ltrim(‘fooList’, 0,1); //保留左边起第0个至第1个元素
</span><span class='line'>116 
</span><span class='line'>117 //rpoplpush 从一个队列中pop出元素并push到另一个队列
</span><span class='line'>118 $redis-&gt;rpush(‘list1′,’ab0′);
</span><span class='line'>119 $redis-&gt;rpush(‘list1′,’ab1′);
</span><span class='line'>120 $redis-&gt;rpush(‘list2′,’ab2′);
</span><span class='line'>121 $redis-&gt;rpush(‘list2′,’ab3′);
</span><span class='line'>122 $redis-&gt;rpoplpush(‘list1′,’list2′);//结果list1 =&gt;array(‘ab0′),list2 =&gt;array(‘ab1′,’ab2′,’ab3′)
</span><span class='line'>123 $redis-&gt;rpoplpush(‘list2′,’list2′);//也适用于同一个队列,把最后一个元素移到头部list2 =&gt;array(‘ab3′,’ab1′,’ab2′)
</span><span class='line'>124 
</span><span class='line'>125 //linsert 在队列的中间指定元素前或后插入元素
</span><span class='line'>126 $redis-&gt;linsert(‘list2′, ‘before’,'ab1′,’123′); //表示在元素’ab1′之前插入’123′
</span><span class='line'>127 $redis-&gt;linsert(‘list2′, ‘after’,'ab1′,’456′);   //表示在元素’ab1′之后插入’456′
</span><span class='line'>128 
</span><span class='line'>129 //blpop/brpop 阻塞并等待一个列队不为空时，再pop出最左或最右的一个元素（这个功能在php以外可以说非常好用）
</span><span class='line'>130 //brpoplpush 同样是阻塞并等待操作，结果同rpoplpush一样
</span><span class='line'>131 $redis-&gt;blpop(‘list3′,10); //如果list3为空则一直等待,直到不为空时将第一元素弹出,10秒后超时
</span><span class='line'>132 
</span><span class='line'>133 /**
</span><span class='line'>134 set表操作
</span><span class='line'>135 */
</span><span class='line'>136 
</span><span class='line'>137 //sadd 增加元素,返回true,重复返回false
</span><span class='line'>138 $redis-&gt;sadd(‘set1′,’ab’);
</span><span class='line'>139 $redis-&gt;sadd(‘set1′,’cd’);
</span><span class='line'>140 $redis-&gt;sadd(‘set1′,’ef’);
</span><span class='line'>141 
</span><span class='line'>142 //srem 移除指定元素
</span><span class='line'>143 $redis-&gt;srem(‘set1′,’cd’); //删除’cd’元素
</span><span class='line'>144 
</span><span class='line'>145 //spop 弹出首元素
</span><span class='line'>146 $redis-&gt;spop(‘set1′);
</span><span class='line'>147 
</span><span class='line'>148 //smove 移动当前set表的指定元素到另一个set表
</span><span class='line'>149 $redis-&gt;sadd(‘set2′,’123′);
</span><span class='line'>150 $redis-&gt;smove(‘set1′,’set2′,’ab’);//移动’set1′中的’ab’到’set2′,返回true or false
</span><span class='line'>151 
</span><span class='line'>152 //scard 返回当前set表元素个数
</span><span class='line'>153 $redis-&gt;scard(‘set2′);//2
</span><span class='line'>154 
</span><span class='line'>155 //sismember 判断元素是否属于当前表
</span><span class='line'>156 $redis-&gt;sismember(‘set2′,’123′); //true or false
</span><span class='line'>157 
</span><span class='line'>158 //smembers 返回当前表的所有元素
</span><span class='line'>159 $redis-&gt;smembers(‘set2′); //array(’123′,’ab’);
</span><span class='line'>160 
</span><span class='line'>161 //sinter/sunion/sdiff  返回两个表中元素的交集/并集/补集
</span><span class='line'>162 $redis-&gt;sadd(‘set1′,’ab’);
</span><span class='line'>163 $redis-&gt;sinter(‘set2′,’set1′); //返回array(‘ab’)
</span><span class='line'>164 
</span><span class='line'>165 //sinterstore/sunionstore/sdiffstore 将两个表交集/并集/补集元素copy到第三个表中
</span><span class='line'>166 $redis-&gt;set(‘foo’,0);
</span><span class='line'>167 $redis-&gt;sinterstore(‘foo’,'set1′); //这边等同于将’set1′的内容copy到’foo’中，并将’foo’转为set表
</span><span class='line'>168 $redis-&gt;sinterstore(‘foo’,array(‘set1′,’set2′)); //将’set1′和’set2′中相同的元素copy到’foo’表中,覆盖’foo’原有内容
</span><span class='line'>169 
</span><span class='line'>170 //srandmember 返回表中一个随机元素
</span><span class='line'>171 $redis-&gt;srandmember(‘set1′);
</span><span class='line'>172 
</span><span class='line'>173 /**
</span><span class='line'>174 有序set表操作
</span><span class='line'>175 */
</span><span class='line'>176 
</span><span class='line'>177 //sadd 增加元素,并设置序号,返回true,重复返回false
</span><span class='line'>178 $redis-&gt;zadd(‘zset1′,1,’ab’);
</span><span class='line'>179 $redis-&gt;zadd(‘zset1′,2,’cd’);
</span><span class='line'>180 $redis-&gt;zadd(‘zset1′,3,’ef’);
</span><span class='line'>181 
</span><span class='line'>182 //zincrby 对指定元素索引值的增减,改变元素排列次序
</span><span class='line'>183 $redis-&gt;zincrby(‘zset1′,10,’ab’);//返回11
</span><span class='line'>184 
</span><span class='line'>185 //zrem 移除指定元素
</span><span class='line'>186 $redis-&gt;zrem(‘zset1′,’ef’); //true or false
</span><span class='line'>187 
</span><span class='line'>188 //zrange 按位置次序返回表中指定区间的元素
</span><span class='line'>189 $redis-&gt;zrange(‘zset1′,0,1); //返回位置0和1之间(两个)的元素
</span><span class='line'>190 $redis-&gt;zrange(‘zset1′,0,-1);//返回位置0和倒数第一个元素之间的元素(相当于所有元素)
</span><span class='line'>191 
</span><span class='line'>192 //zrevrange 同上,返回表中指定区间的元素,按次序倒排
</span><span class='line'>193 $redis-&gt;zrevrange(‘zset1′,0,-1); //元素顺序和zrange相反
</span><span class='line'>194 
</span><span class='line'>195 //zrangebyscore/zrevrangebyscore 按顺序/降序返回表中指定索引区间的元素
</span><span class='line'>196 $redis-&gt;zadd(‘zset1′,3,’ef’);
</span><span class='line'>197 $redis-&gt;zadd(‘zset1′,5,’gh’);
</span><span class='line'>198 $redis-&gt;zrangebyscore(‘zset1′,2,9); //返回索引值2-9之间的元素 array(‘ef’,'gh’)
</span><span class='line'>199 //参数形式
</span><span class='line'>200 $redis-&gt;zrangebyscore(‘zset1′,2,9,’withscores’); //返回索引值2-9之间的元素并包含索引值 array(array(‘ef’,3),array(‘gh’,5))
</span><span class='line'>201 $redis-&gt;zrangebyscore(‘zset1′,2,9,array(‘withscores’ =&gt;true,’limit’=&gt;array(1, 2))); //返回索引值2-9之间的元素,’withscores’ =&gt;true表示包含索引值; ‘limit’=&gt;array(1, 2),表示最多返回2条,结果为array(array(‘ef’,3),array(‘gh’,5))
</span><span class='line'>202 
</span><span class='line'>203 //zunionstore/zinterstore 将多个表的并集/交集存入另一个表中
</span><span class='line'>204 $redis-&gt;zunionstore(‘zset3′,array(‘zset1′,’zset2′,’zset0′)); //将’zset1′,’zset2′,’zset0′的并集存入’zset3′
</span><span class='line'>205 //其它参数
</span><span class='line'>206 $redis-&gt;zunionstore(‘zset3′,array(‘zset1′,’zset2′),array(‘weights’ =&gt; array(5,0)));//weights参数表示权重，其中表示并集后值大于5的元素排在前，大于0的排在后
</span><span class='line'>207 $redis-&gt;zunionstore(‘zset3′,array(‘zset1′,’zset2′),array(‘aggregate’ =&gt; ‘max’));//’aggregate’ =&gt; ‘max’或’min’表示并集后相同的元素是取大值或是取小值
</span><span class='line'>208 
</span><span class='line'>209 //zcount 统计一个索引区间的元素个数
</span><span class='line'>210 $redis-&gt;zcount(‘zset1′,3,5);//2
</span><span class='line'>211 $redis-&gt;zcount(‘zset1′,’(3′,5)); //’(3′表示索引值在3-5之间但不含3,同理也可以使用’(5′表示上限为5但不含5
</span><span class='line'>212 
</span><span class='line'>213 //zcard 统计元素个数
</span><span class='line'>214 $redis-&gt;zcard(‘zset1′);//4
</span><span class='line'>215 
</span><span class='line'>216 //zscore 查询元素的索引
</span><span class='line'>217 $redis-&gt;zscore(‘zset1′,’ef’);//3
</span><span class='line'>218 
</span><span class='line'>219 //zremrangebyscore 删除一个索引区间的元素
</span><span class='line'>220 $redis-&gt;zremrangebyscore(‘zset1′,0,2); //删除索引在0-2之间的元素(‘ab’,'cd’),返回删除元素个数2
</span><span class='line'>221 
</span><span class='line'>222 //zrank/zrevrank 返回元素所在表顺序/降序的位置(不是索引)
</span><span class='line'>223 $redis-&gt;zrank(‘zset1′,’ef’);//返回0,因为它是第一个元素;zrevrank则返回1(最后一个)
</span><span class='line'>224 
</span><span class='line'>225 //zremrangebyrank 删除表中指定位置区间的元素
</span><span class='line'>226 $redis-&gt;zremrangebyrank(‘zset1′,0,10); //删除位置为0-10的元素,返回删除的元素个数2
</span><span class='line'>227 
</span><span class='line'>228 /**
</span><span class='line'>229 hash表操作
</span><span class='line'>230 */
</span><span class='line'>231 
</span><span class='line'>232 //hset/hget 存取hash表的数据
</span><span class='line'>233 $redis-&gt;hset(‘hash1′,’key1′,’v1′); //将key为’key1′ value为’v1′的元素存入hash1表
</span><span class='line'>234 $redis-&gt;hset(‘hash1′,’key2′,’v2′);
</span><span class='line'>235 $redis-&gt;hget(‘hash1′,’key1′);  //取出表’hash1′中的key ‘key1′的值,返回’v1′
</span><span class='line'>236 
</span><span class='line'>237 //hexists 返回hash表中的指定key是否存在
</span><span class='line'>238 $redis-&gt;hexists (‘hash1′,’key1′); //true or false
</span><span class='line'>239 
</span><span class='line'>240 //hdel 删除hash表中指定key的元素
</span><span class='line'>241 $redis-&gt;hdel(‘hash1′,’key2′); //true or false
</span><span class='line'>242 
</span><span class='line'>243 //hlen 返回hash表元素个数
</span><span class='line'>244 $redis-&gt;hlen(‘hash1′); //1
</span><span class='line'>245 
</span><span class='line'>246 //hsetnx 增加一个元素,但不能重复
</span><span class='line'>247 $redis-&gt;hsetnx(‘hash1′,’key1′,’v2′); //false
</span><span class='line'>248 $redis-&gt;hsetnx(‘hash1′,’key2′,’v2′); //true
</span><span class='line'>249 
</span><span class='line'>250 //hmset/hmget 存取多个元素到hash表
</span><span class='line'>251 $redis-&gt;hmset(‘hash1′,array(‘key3′=&gt;’v3′,’key4′=&gt;’v4′));
</span><span class='line'>252 $redis-&gt;hmget(‘hash1′,array(‘key3′,’key4′)); //返回相应的值 array(‘v3′,’v4′)
</span><span class='line'>253 
</span><span class='line'>254 //hincrby 对指定key进行累加
</span><span class='line'>255 $redis-&gt;hincrby(‘hash1′,’key5′,3); //返回3
</span><span class='line'>256 $redis-&gt;hincrby(‘hash1′,’key5′,10); //返回13
</span><span class='line'>257 
</span><span class='line'>258 //hkeys 返回hash表中的所有key
</span><span class='line'>259 $redis-&gt;hkeys(‘hash1′); //返回array(‘key1′,’key2′,’key3′,’key4′,’key5′)
</span><span class='line'>260 
</span><span class='line'>261 //hvals 返回hash表中的所有value
</span><span class='line'>262 $redis-&gt;hvals(‘hash1′); //返回array(‘v1′,’v2′,’v3′,’v4′,13)
</span><span class='line'>263 
</span><span class='line'>264 //hgetall 返回整个hash表元素
</span><span class='line'>265 $redis-&gt;hgetall(‘hash1′); //返回array(‘key1′=&gt;’v1′,’key2′=&gt;’v2′,’key3′=&gt;’v3′,’key4′=&gt;’v4′,’key5′=&gt;13)
</span><span class='line'>266 
</span><span class='line'>267 /**
</span><span class='line'>268 排序操作
</span><span class='line'>269 */
</span><span class='line'>270 
</span><span class='line'>271 //sort 排序
</span><span class='line'>272 $redis-&gt;rpush(‘tab’,3);
</span><span class='line'>273 $redis-&gt;rpush(‘tab’,2);
</span><span class='line'>274 $redis-&gt;rpush(‘tab’,17);
</span><span class='line'>275 $redis-&gt;sort(‘tab’);  //返回array(2,3,17)
</span><span class='line'>276 //使用参数,可组合使用 array(‘sort’ =&gt; ‘desc’,'limit’ =&gt; array(1, 2))
</span><span class='line'>277 $redis-&gt;sort(‘tab’,array(‘sort’ =&gt; ‘desc’));  //降序排列,返回array(17,3,2)
</span><span class='line'>278 $redis-&gt;sort(‘tab’,array(‘limit’ =&gt; array(1, 2)));  //返回顺序位置中1的元素2个(这里的2是指个数,而不是位置),返回array(3,17)
</span><span class='line'>279 $redis-&gt;sort(‘tab’,array(‘limit’ =&gt; array(‘alpha’ =&gt; true))); //按首字符排序返回array(17,2,3),因为17的首字符是’1′所以排首位置
</span><span class='line'>280 $redis-&gt;sort(‘tab’,array(‘limit’ =&gt; array(‘store’ =&gt; ‘ordered’))); //表示永久性排序,返回元素个数
</span><span class='line'>281 $redis-&gt;sort(‘tab’,array(‘limit’ =&gt; array(‘get’ =&gt; ‘pre_*’))); //使用了通配符’*'过滤元素,表示只返回以’pre_’开头的元素
</span><span class='line'>282 
</span><span class='line'>283 /**
</span><span class='line'>284 redis管理操作
</span><span class='line'>285 */
</span><span class='line'>286 
</span><span class='line'>287 //select 指定要操作的数据库
</span><span class='line'>288 $redis-&gt;select(‘mydb’); //指定为mydb,不存在则创建
</span><span class='line'>289 
</span><span class='line'>290 //flushdb 清空当前库
</span><span class='line'>291 $redis-&gt;flushdb();
</span><span class='line'>292 
</span><span class='line'>293 //move 移动当库的元素到其它库
</span><span class='line'>294 $redis-&gt;set(‘foo’, ‘bar’);
</span><span class='line'>295 $redis-&gt;move(‘foo’, ‘mydb2′); //若’mydb2′库存在
</span><span class='line'>296 
</span><span class='line'>297 //info 显示服务当状态信息
</span><span class='line'>298 $redis-&gt;info();
</span><span class='line'>299 
</span><span class='line'>300 //slaveof 配置从服务器
</span><span class='line'>301 $redis-&gt;slaveof(’127.0.0.1′,80); //配置127.0.0.1端口80的服务器为从服务器
</span><span class='line'>302 $redis-&gt;slaveof(); //清除从服务器
</span><span class='line'>303 
</span><span class='line'>304 //同步保存服务器数据到磁盘
</span><span class='line'>305 $redis-&gt;save();
</span><span class='line'>306 //异步保存服务器数据到磁盘
</span><span class='line'>307 $redis-&gt;bgsave();
</span><span class='line'>308 //??
</span><span class='line'>309 $redis-&gt;bgrewriteaof();
</span><span class='line'>310 //返回最后更新磁盘的时间
</span><span class='line'>311 $redis-&gt;lastsave();
</span><span class='line'>312 
</span><span class='line'>313 //set/get多个key-value
</span><span class='line'>314 $mkv = array(
</span><span class='line'>315 ‘usr:0001′ =&gt; ‘First user’,
</span><span class='line'>316 ‘usr:0002′ =&gt; ‘Second user’,
</span><span class='line'>317 ‘usr:0003′ =&gt; ‘Third user’
</span><span class='line'>318 );
</span><span class='line'>319 $redis-&gt;mset($mkv); //存储多个key对应的value
</span><span class='line'>320 $retval = $redis-&gt;mget(array_keys($mkv)); //获取多个key对应的value
</span><span class='line'>321 print_r($retval);
</span><span class='line'>322 
</span><span class='line'>323 //批量操作
</span><span class='line'>324 $replies = $redis-&gt;pipeline(function($pipe) {
</span><span class='line'>325 $pipe-&gt;ping();
</span><span class='line'>326 $pipe-&gt;flushdb();
</span><span class='line'>327 $pipe-&gt;incrby(‘counter’, 10); //增量操作
</span><span class='line'>328 $pipe-&gt;incrby(‘counter’, 30);
</span><span class='line'>329 $pipe-&gt;exists(‘counter’);
</span><span class='line'>330 $pipe-&gt;get(‘counter’);
</span><span class='line'>331 $pipe-&gt;mget(‘does_not_exist’, ‘counter’);
</span><span class='line'>332 });
</span><span class='line'>333 print_r($replies);
</span><span class='line'>334 
</span><span class='line'>335 //CAS,事务性操作
</span><span class='line'>336 
</span><span class='line'>337 function zpop($client, $zsetKey) {
</span><span class='line'>338 $element = null;
</span><span class='line'>339 $options = array(
</span><span class='line'>340 ‘cas’   =&gt; true,     // Initialize with support for CAS operations
</span><span class='line'>341 ‘watch’ =&gt; $zsetKey, // Key that needs to be WATCHed to detect changes
</span><span class='line'>342 ‘retry’ =&gt; 3,        // Number of retries on aborted transactions, after
</span><span class='line'>343 // which the client bails out with an exception.
</span><span class='line'>344 );
</span><span class='line'>345 
</span><span class='line'>346 $txReply = $client-&gt;multiExec($options, function($tx)
</span><span class='line'>347 use ($zsetKey, &$element) {
</span><span class='line'>348 @list($element) = $tx-&gt;zrange($zsetKey, 0, 0);
</span><span class='line'>349 if (isset($element)) {
</span><span class='line'>350 $tx-&gt;multi();     // With CAS, MULTI *must* be explicitly invoked.
</span><span class='line'>351 $tx-&gt;zrem($zsetKey, $element);
</span><span class='line'>352 }
</span><span class='line'>353 });
</span><span class='line'>354 return $element;
</span><span class='line'>355 }
</span><span class='line'>356 $zpopped = zpop($redis, ‘zset’);
</span><span class='line'>357 echo isset($zpopped) ? “ZPOPed $zpopped” : “Nothing to ZPOP!”, “\n”;
</span><span class='line'>358 
</span><span class='line'>359 //对存取的key加前缀,如: ‘nrk:’
</span><span class='line'>360 $redis-&gt;getProfile()-&gt;setPreprocessor(new KeyPrefixPreprocessor(‘nrk:’));
</span><span class='line'>361 
</span><span class='line'>362 //分布式存储的一些方法
</span><span class='line'>363 $multiple_servers = array(
</span><span class='line'>364 array(
</span><span class='line'>365 ‘host’     =&gt; ’127.0.0.1′,
</span><span class='line'>366 ‘port’     =&gt; 6379,
</span><span class='line'>367 ‘database’ =&gt; 15,
</span><span class='line'>368 ‘alias’    =&gt; ‘first’,
</span><span class='line'>369 ),
</span><span class='line'>370 array(
</span><span class='line'>371 ‘host’     =&gt; ’127.0.0.1′,
</span><span class='line'>372 ‘port’     =&gt; 6380,
</span><span class='line'>373 ‘database’ =&gt; 15,
</span><span class='line'>374 ‘alias’    =&gt; ‘second’,
</span><span class='line'>375 ),
</span><span class='line'>376 );
</span><span class='line'>377 
</span><span class='line'>378 use Predis\Distribution\IDistributionStrategy;
</span><span class='line'>379 
</span><span class='line'>380 class NaiveDistributionStrategy implements IDistributionStrategy {
</span><span class='line'>381 private $_nodes, $_nodesCount;
</span><span class='line'>382 
</span><span class='line'>383 public function __constructor() {
</span><span class='line'>384 $this-&gt;_nodes = array();
</span><span class='line'>385 $this-&gt;_nodesCount = 0;
</span><span class='line'>386 }
</span><span class='line'>387 
</span><span class='line'>388 public function add($node, $weight = null) {
</span><span class='line'>389 $this-&gt;_nodes[] = $node;
</span><span class='line'>390 $this-&gt;_nodesCount++;
</span><span class='line'>391 }
</span><span class='line'>392 
</span><span class='line'>393 public function remove($node) {
</span><span class='line'>394 $this-&gt;_nodes = array_filter($this-&gt;_nodes, function($n) use($node) {
</span><span class='line'>395 return $n !== $node;
</span><span class='line'>396 });
</span><span class='line'>397 $this-&gt;_nodesCount = count($this-&gt;_nodes);
</span><span class='line'>398 }
</span><span class='line'>399 
</span><span class='line'>400 public function get($key) {
</span><span class='line'>401 $count = $this-&gt;_nodesCount;
</span><span class='line'>402 if ($count === 0) {
</span><span class='line'>403 throw new RuntimeException(‘No connections’);
</span><span class='line'>404 }
</span><span class='line'>405 return $this-&gt;_nodes[$count &gt; 1 ? abs(crc32($key) % $count) : 0];
</span><span class='line'>406 }
</span><span class='line'>407 
</span><span class='line'>408 public function generateKey($value) {
</span><span class='line'>409 return crc32($value);
</span><span class='line'>410 }
</span><span class='line'>411 }
</span><span class='line'>412 
</span><span class='line'>413 //配置键分布策略
</span><span class='line'>414 $options = array(
</span><span class='line'>415 ‘key_distribution’ =&gt; new NaiveDistributionStrategy(),
</span><span class='line'>416 );
</span><span class='line'>417 
</span><span class='line'>418 $redis = new Predis\Client($multiple_servers, $options);
</span><span class='line'>419 
</span><span class='line'>420 for ($i = 0; $i set(“key:$i”, str_pad($i, 4, ’0′, 0));
</span><span class='line'>421 $redis-&gt;get(“key:$i”);
</span><span class='line'>422 }
</span><span class='line'>423 
</span><span class='line'>424 $server1 = $redis-&gt;getClientFor(‘first’)-&gt;info();
</span><span class='line'>425 $server2 = $redis-&gt;getClientFor(‘second’)-&gt;info();
</span><span class='line'>426 
</span><span class='line'>427 printf(“Server ‘%s’ has %d keys while server ‘%s’ has %d keys.\n”,
</span><span class='line'>428 ‘first’, $server1['db15']['keys'], ‘second’, $server2['db15']['keys']</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[数据库表类型中MyISam和innoDB的区别]]></title>
    <link href="http://hunter222.github.io/blog/2016/09/02/MyISam-innoDb/"/>
    <updated>2016-09-02T18:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/09/02/MyISam-innoDb</id>
    <content type="html"><![CDATA[<p>MySQL的事务支持不是绑定在MySQL服务器本身，而是与存储引擎相关1.MyISAM：不支持事务，用于只读程序提高性能 2.InnoDB：支持ACID事务、行级锁、并发 3.Berkeley DB：支持事务</p>

<p> 一个事务是一个连续的一组数据库操作，就好像它是一个单一的工作单元进行。换言之，永远不会是完整的事务，除非该组内的每个单独的操作是成功的。如果在事务的任何操作失败，则整个事务将失败。</p>

<p>实际上，会俱乐部许多SQL查询到一个组中，将执行所有的人都一起作为事务的一部分。</p>

<p>事务的特性：
事务有以下四个标准属性的缩写ACID，通常被称为：</p>

<p>原子性: 确保工作单元内的所有操作都成功完成，否则事务将被中止在故障点，和以前的操作将回滚到以前的状态。</p>

<p>一致性: 确保数据库正确地改变状态后，成功提交的事务。</p>

<p>隔离性: 使事务操作彼此独立的和透明的。</p>

<p>持久性: 确保提交的事务的结果或效果的系统出现故障的情况下仍然存在。</p>

<p>在MySQL中，事务开始使用COMMIT或ROLLBACK语句开始工作和结束。开始和结束语句的SQL命令之间形成了大量的事务。</p>

<p>COMMIT &amp; ROLLBACK:
这两个关键字提交和回滚主要用于MySQL的事务。</p>

<p>当一个成功的事务完成后，发出COMMIT命令应使所有参与表的更改才会生效。</p>

<p>如果发生故障时，应发出一个ROLLBACK命令返回的事务中引用的每一个表到以前的状态。</p>

<p>可以控制的事务行为称为AUTOCOMMIT设置会话变量。如果AUTOCOMMIT设置为1（默认值），然后每一个SQL语句（在事务与否）被认为是一个完整的事务，并承诺在默认情况下，当它完成。 AUTOCOMMIT设置为0时，发出SET AUTOCOMMIT =0命令，在随后的一系列语句的作用就像一个事务，直到一个明确的COMMIT语句时，没有活动的提交。</p>

<p>可以通过使用mysql_query()函数在PHP中执行这些SQL命令。</p>

<p>通用事务例子</p>

<p>这一系列事件是独立于所使用的编程语言，可以建立在任何使用的语言来创建应用程序的逻辑路径。</p>

<p>可以通过使用mysql_query()函数在PHP中执行这些SQL命令。</p>

<p>BEGIN WORK开始事务发出SQL命令</p>

<p>发出一个或多个SQL命令，如SELECT，INSERT，UPDATE或DELETE</p>

<p>检查是否有任何错误，一切都依据的需要。</p>

<p>如果有任何错误，那么问题ROLLBACK命令，否则发出COMMIT命令。</p>

<p>在MySQL中的事务安全表类型：</p>

<p>如果打算使用MySQL事务编程，那么就需要一种特殊的方式创建表。有很多支持事务但最流行的是InnoDB表类型。</p>

<p>从源代码编译MySQL时，InnoDB表支持需要特定的编译参数。如果MySQL版本没有InnoDB支持，请互联网服务提供商建立一个版本的MySQL支持InnoDB表类型，或者下载并安装Windows或Linux/UNIX的MySQL-Max二进制分发和使用的表类型在开发环境中。</p>

<p>如果MySQL安装支持InnoDB表，只需添加一个的TYPE=InnoDB 定义表创建语句。例如，下面的代码创建InnoDB表tcount_tbl：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@host# mysql -u root -p password;
</span><span class='line'>Enter password:*******
</span><span class='line'>mysql&gt; use TUTORIALS;
</span><span class='line'>Database changed
</span><span class='line'>mysql&gt; create table tcount_tbl
</span><span class='line'>    -&gt; (
</span><span class='line'>    -&gt; tutorial_author varchar(40) NOT NULL,
</span><span class='line'>    -&gt; tutorial_count  INT
</span><span class='line'>    -&gt; ) TYPE=InnoDB;
</span><span class='line'>Query OK, 0 rows affected (0.05 sec)</span></code></pre></td></tr></table></div></figure>


<p>可以使用其他GEMINI或BDB表类型，但它取决于您的安装，如果它支持这两种类型。</p>

<p>由于项目设计里面，牵扯到了金钱的转移，于是就要用到MYSQL的事务处理，来保证一组处理结果的正确性。用了事务，就不可避免的要牺牲一部分速度，来保证数据的正确性。</p>

<p>只有InnoDB支持事务</p>

<p>事务 ACID Atomicity（原子性）、Consistency（稳定性）、Isolation（隔离性）、Durability（可靠性）</p>

<p>1、事务的原子性</p>

<p>一组事务，要么成功；要么撤回。</p>

<p>2、稳定性</p>

<p>有非法数据（外键约束之类），事务撤回。</p>

<p>3、隔离性</p>

<p>事务独立运行。</p>

<p>一个事务处理后的结果，影响了其他事务，那么其他事务会撤回。</p>

<p>事务的100%隔离，需要牺牲速度。</p>

<p>4、可靠性</p>

<p>软、硬件崩溃后，InnoDB数据表驱动会利用日志文件重构修改。</p>

<p>可靠性和高速度不可兼得， innodb_flush_log_at_trx_commit选项 决定什么时候吧事务保存到日志里。
开启事务</p>

<p>START TRANSACTION 或 BEGIN</p>

<p>提交事务（关闭事务）</p>

<p>COMMIT</p>

<p>放弃事务（关闭事务）</p>

<p>ROLLBACK</p>

<p>折返点</p>

<p>SAVEPOINT adqoo_1</p>

<p>ROLLBACK TO SAVEPOINT adqoo_1</p>

<p>发生在折返点 adqoo_1 之前的事务被提交，之后的被忽略</p>

<p>事务的终止</p>

<p>设置“自动提交”模式</p>

<p>SET AUTOCOMMIT = 0</p>

<p>每条SQL都是同一个事务的不同命令，之间由 COMMIT 或 ROLLBACK隔开</p>

<p>掉线后，没有 COMMIT 的事务都被放弃</p>

<p>事务锁定模式</p>

<p>系统默认： 不需要等待某事务结束，可直接查询到结果，但不能再进行修改、删除。</p>

<p>缺点：查询到的结果，可能是已经过期的。</p>

<p>优点：不需要等待某事务结束，可直接查询到结果。</p>

<p>需要用以下模式来设定锁定模式</p>

<p>1、SELECT …… LOCK IN SHARE MODE（共享锁）</p>

<p>查询到的数据，就是数据库在这一时刻的数据（其他已commit事务的结果，已经反应到这里了）</p>

<p>SELECT 必须等待，某个事务结束后才能执行</p>

<p>2、SELECT …… FOR UPDATE（排它锁）</p>

<p>例如 SELECT * FROM tablename WHERE id&lt;200</p>

<p>那么id&lt;200的数据，被查询到的数据，都将不能再进行修改、删除、SELECT …… LOCK IN SHARE MODE操作
一直到此事务结束</p>

<p>共享锁 和 排它锁 的区别：在于是否阻断其他客户发出的 SELECT …… LOCK IN SHARE MODE命令</p>

<p>3、INSERT / UPDATE / DELETE</p>

<p>所有关联数据都会被锁定，加上排它锁</p>

<p>4、防插入锁</p>

<p>例如 SELECT * FROM tablename WHERE id>200</p>

<p>那么id>200的记录无法被插入</p>

<p>5、死锁</p>

<p>自动识别死锁</p>

<p>先进来的进程被执行，后来的进程收到出错消息，并按ROLLBACK方式回滚</p>

<p>innodb_lock_wait_timeout = n 来设置最长等待时间，默认是50秒</p>

<p>事务隔离模式</p>

<p>SET [SESSION|GLOBAL] TRANSACTION ISOLATION LEVEL</p>

<p>READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE</p>

<p>1、不带SESSION、GLOBAL的SET命令</p>

<p>只对下一个事务有效</p>

<p>2、SET SESSION</p>

<p>为当前会话设置隔离模式</p>

<p>3、SET GLOBAL</p>

<p>为以后新建的所有MYSQL连接设置隔离模式（当前连接不包括在内）</p>

<p>隔离模式</p>

<p>   READ UNCOMMITTED</p>

<p>不隔离SELECT</p>

<p>其他事务未完成的修改（未COMMIT），其结果也考虑在内</p>

<p>   READ COMMITTED</p>

<p>把其他事务的 COMMIT 修改考虑在内</p>

<p>同一个事务中，同一 SELECT 可能返回不同结果</p>

<p>   REPEATABLE READ（默认）</p>

<p>不把其他事务的修改考虑在内，无论其他事务是否用COMMIT命令提交过
同一个事务中，同一 SELECT 返回同一结果（前提是本事务，不修改）</p>

<p>   SERIALIZABLE</p>

<p>和REPEATABLE READ类似，给所有的SELECT都加上了 共享锁</p>

<p>出错处理</p>

<p>根据出错信息，执行相应的处理</p>

<p>mysql事物处理实例</p>

<p>MYSQL的事务处理主要有两种方法</p>

<p>1.用begin,rollback,commit来实现</p>

<pre><code>begin开始一个事务

rollback事务回滚

commit 事务确认
</code></pre>

<p>2.直接用set来改变mysql的自动提交模式</p>

<pre><code>mysql默认是自动提交的，也就是你提交一个query，就直接执行！可以通过

set autocommit = 0 禁止自动提交

set autocommit = 1 开启自动提交

来实现事务的处理。
</code></pre>

<p>但要注意当用set autocommit = 0 的时候，你以后所有的sql都将作为事务处理，直到你用commit确认或 rollback结束，注意当你结束这个事务的同时也开启了新的事务！按第一种方法只将当前的做为一个事务!</p>

<p>MYSQL只有 INNODB和BDB类型的数据表才支持事务处理，其他的类型是不支持的!</p>

<p>MYSQL5.0 WINXP下测试通过</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql&gt; use test;
</span><span class='line'>    Database changed
</span><span class='line'>    mysql&gt; CREATE TABLE `dbtest`(
</span><span class='line'>    -&gt; id int(4)
</span><span class='line'>    -&gt; ) TYPE=INNODB;
</span><span class='line'>Query OK, 0 rows affected, 1 warning (0.05 sec)
</span><span class='line'>mysql&gt; select * from dbtest
</span><span class='line'>    -&gt; ;
</span><span class='line'>Empty set (0.01 sec)
</span><span class='line'>mysql&gt; begin;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>mysql&gt; insert into dbtest values(5);
</span><span class='line'>Query OK, 1 row affected (0.00 sec)
</span><span class='line'>mysql&gt; insert into dbtest value(6);
</span><span class='line'>Query OK, 1 row affected (0.00 sec)
</span><span class='line'>mysql&gt; commit;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>mysql&gt; select * from dbtest;
</span><span class='line'>+------+
</span><span class='line'>| id   |
</span><span class='line'>+------+
</span><span class='line'>|    5 |
</span><span class='line'>|    6 |
</span><span class='line'>+------+
</span><span class='line'>2 rows in set (0.00 sec)
</span><span class='line'>mysql&gt; begin;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>mysql&gt; insert into dbtest values(7);
</span><span class='line'>Query OK, 1 row affected (0.00 sec)
</span><span class='line'>mysql&gt; rollback;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>mysql&gt; select * from dbtest;
</span><span class='line'>+------+
</span><span class='line'>| id   |
</span><span class='line'>+------+
</span><span class='line'>|    5 |
</span><span class='line'>|    6 |
</span><span class='line'>+------+
</span><span class='line'>2 rows in set (0.00 sec)</span></code></pre></td></tr></table></div></figure>


<p>mysql> mysql事务处理</p>

<p>php代码实现事务的处理可以通过PHP预定义类mysqli的以下方法实现。</p>

<p>autocommit(boolean)：该方法用于限定查询结果是否自动提交，如果该方法的参数为true则自动提交，如果参数为false则关闭自动提交。MySQL数据库默认为自动提交。</p>

<p>rollback()：利用mysqli类中的该方法可以实现事务的回滚。</p>

<p>commit()：利用该方法可以实现提交所有查询。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>include_once("conn.php");
</span><span class='line'>$id=$_GET[id];
</span><span class='line'>$conn-&gt;autocommit(false);
</span><span class='line'>if(!$conn-&gt;query("delete from tb_sco where id='".$id."'"))
</span><span class='line'>{
</span><span class='line'>  $conn-&gt;rollback();
</span><span class='line'>}
</span><span class='line'>if(!$conn-&gt;query("delete from tb_stu where id='".$id."'"))
</span><span class='line'>{
</span><span class='line'>  $conn-&gt;rollback();
</span><span class='line'>}
</span><span class='line'>  $conn-&gt;commit();
</span><span class='line'>  $conn-&gt;autocommit(true);
</span><span class='line'>  echo "ok"
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<p>示例2：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>require('connectDB.php'); //建立数据库连接
</span><span class='line'>mssql_query("BEGIN TRANSACTION DEPS02_DEL"); //开始事务
</span><span class='line'>$delete_dep_sql="DELETE FROM TBLDEPARTMENT WHERE DEPTID='{$_GET[deptid]}'";
</span><span class='line'>// echo $delete_dep_sql."&lt;br&gt;";
</span><span class='line'>mssql_query($delete_dep_sql); //操作数据库
</span><span class='line'>// var_dump($del_result);
</span><span class='line'>$delete_result = mssql_query("select @@ROWCOUNT as id");
</span><span class='line'>$delete_info = mssql_fetch_array($delete_result);
</span><span class='line'>$delete_rows = $delete_info[0];
</span><span class='line'>// var_dump($delete_rows);
</span><span class='line'>mssql_free_result($delete_result);
</span><span class='line'>echo "&lt;script language=javascript&gt;";
</span><span class='line'>if(true){    //判断是否回滚提交
</span><span class='line'>mssql_query("COMMIT TRANSACTION DEPS02_DEL"); //提交事务
</span><span class='line'>echo "alert('delete success!');";
</span><span class='line'>}else{
</span><span class='line'>mssql_query("ROLLBACK TRANSACTION DEPS02_DEL"); //回滚事务
</span><span class='line'>echo "alert('delete faile!');";
</span><span class='line'>}
</span><span class='line'>echo "&lt;/script&gt;";mssql_close();
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<p>例3</p>

<p>  MySQL的事务处理在处理实际问题中有着广泛且重要的应用，最常见的应用如银行转账业务、电子商务支付业务等等。但是，值得注意的是，MySQL的事务处理功能在MYSIAM存储引擎中是不支持的，在InnoDB存储引擎中是支持的。现在上传一段代码，作为引导认识MySQL事务处理的开始，简单的实例，但融汇思想，相信会有很大的帮助。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>$conn=mysql_connect('localhost','root','yourpassword')or die(mysql_error());
</span><span class='line'>mysql_select_db('transaction',$conn);
</span><span class='line'>mysql_query('set names utf8');
</span><span class='line'>//创建事务
</span><span class='line'>mysql_query('START TRANSACTION') or die(mysql_error());
</span><span class='line'>$sqlA="update A set account=account-1";
</span><span class='line'>if(!mysql_query($sqlA)){
</span><span class='line'>&nbsp;&nbsp;&nbsp; mysql_query('ROLLBACK') or exit(mysql_error());//判断当执行失败时回滚
</span><span class='line'>&nbsp;   exit();
</span><span class='line'>}
</span><span class='line'>$sqlB="update B set account=account+1";
</span><span class='line'>if(!mysql_query($sqlB)){
</span><span class='line'>&nbsp;&nbsp;&nbsp; mysql_query('ROLLBACK') or exit(mysql_error());//判断当执行失败时回滚
</span><span class='line'>&nbsp;   exit();
</span><span class='line'>}
</span><span class='line'>mysql_query('COMMIT')or die(mysql_error());//执行事务
</span><span class='line'>mysql_close($conn);
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<p>以上代码可以作为模拟银行转账业务的事务流程。以表A、B分别表示两个已在银行开户的账户，当账户A执行转出1元给账户B的操作时，如果操作执行失败，转出将会回滚至原始状态，不继续向下执行动作。反之，如果操作执行成功，则账户B可用余额将增加1元，否则事务回滚至原始状态。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[验证码工具类的使用]]></title>
    <link href="http://hunter222.github.io/blog/2016/09/01/php-yanzhengma/"/>
    <updated>2016-09-01T18:19:27+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/09/01/php-yanzhengma</id>
    <content type="html"><![CDATA[<p>1.工具类：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>class Captcha
</span><span class='line'>{
</span><span class='line'>    private $charset = 'abcdefghkmnprstuvwxyzABCDEFGHKMNPRSTUVWXYZ23456789';
</span><span class='line'> // 随机因子，
</span><span class='line'>    private $code;
</span><span class='line'> // 验证码字符串
</span><span class='line'>    private $codelen = 4;
</span><span class='line'> // 验证码长度
</span><span class='line'>    private $width = 150;
</span><span class='line'> // 宽度
</span><span class='line'>    private $height = 40;
</span><span class='line'> // 高度
</span><span class='line'>    private $img;
</span><span class='line'> // 图形资源句柄
</span><span class='line'>    private $font;
</span><span class='line'> // 指定的字体
</span><span class='line'>    private $fontsize = 20;
</span><span class='line'> // 指定字体大小
</span><span class='line'>    private $fontcolor;
</span><span class='line'> // 指定字体颜色                        
</span><span class='line'>    // 构造方法初始化
</span><span class='line'>    public function __construct($codelen = 4, $width = 150, $height = 40, $fontsize = 20, $font = "elephant.ttf")
</span><span class='line'>    {
</span><span class='line'>        $this-&gt;codelen = $codelen;
</span><span class='line'>        $this-&gt;width = $width;
</span><span class='line'>        $this-&gt;height = $height;
</span><span class='line'>        $this-&gt;fontsize = $fontsize;
</span><span class='line'>        $this-&gt;font = $font;
</span><span class='line'>    }
</span><span class='line'>    // 生成随机码
</span><span class='line'>    private function createCode()
</span><span class='line'>    {
</span><span class='line'>        $_len = strlen($this-&gt;charset) - 1;
</span><span class='line'>        for ($i = 0; $i &lt; $this-&gt;codelen; $i ++) {
</span><span class='line'>            $this-&gt;code .= $this-&gt;charset[mt_rand(0, $_len)];
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    // 生成背景
</span><span class='line'>    private function createBg()
</span><span class='line'>    {
</span><span class='line'>        $this-&gt;img = imagecreatetruecolor($this-&gt;width, $this-&gt;height);
</span><span class='line'>        $color = imagecolorallocate($this-&gt;img, mt_rand(157, 255), mt_rand(157, 255), mt_rand(157, 255));
</span><span class='line'>        imagefilledrectangle($this-&gt;img, 0, $this-&gt;height, $this-&gt;width, 0, $color);
</span><span class='line'>    }  
</span><span class='line'>    // 生成文字
</span><span class='line'>    private function createFont()
</span><span class='line'>    {
</span><span class='line'>        $_x = $this-&gt;width / $this-&gt;codelen;
</span><span class='line'>        for ($i = 0; $i &lt; $this-&gt;codelen; $i ++) {
</span><span class='line'>            $this-&gt;fontcolor = imagecolorallocate($this-&gt;img, mt_rand(0, 156), mt_rand(0, 156), mt_rand(0, 156));
</span><span class='line'>            imagettftext($this-&gt;img, $this-&gt;fontsize, mt_rand(- 30, 30), $_x * $i + mt_rand(1, 5), $this-&gt;height / 1.4, $this-&gt;fontcolor, $this-&gt;font, $this-&gt;code[$i]);
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    // 生成线条、雪花
</span><span class='line'>    private function createLine()
</span><span class='line'>    {
</span><span class='line'>        for ($i = 0; $i &lt; 6; $i ++) {
</span><span class='line'>            $color = imagecolorallocate($this-&gt;img, mt_rand(0, 156), mt_rand(0, 156), mt_rand(0, 156));
</span><span class='line'>            imageline($this-&gt;img, mt_rand(0, $this-&gt;width), mt_rand(0, $this-&gt;height), mt_rand(0, $this-&gt;width), mt_rand(0, $this-&gt;height), $color);
</span><span class='line'>        }
</span><span class='line'>        for ($i = 0; $i &lt; 100; $i ++) {
</span><span class='line'>            $color = imagecolorallocate($this-&gt;img, mt_rand(200, 255), mt_rand(200, 255), mt_rand(200, 255));
</span><span class='line'>            imagestring($this-&gt;img, mt_rand(1, 5), mt_rand(0, $this-&gt;width), mt_rand(0, $this-&gt;height), '*', $color);
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    // 输出
</span><span class='line'>    private function outPut()
</span><span class='line'>    {
</span><span class='line'>        header('Content-type:image/png');
</span><span class='line'>        imagepng($this-&gt;img);
</span><span class='line'>        imagedestroy($this-&gt;img);
</span><span class='line'>    }
</span><span class='line'>    // 对外生成
</span><span class='line'>    public function generateCode()
</span><span class='line'>    {
</span><span class='line'>        $this-&gt;createBg();
</span><span class='line'>        $this-&gt;createCode();
</span><span class='line'>        $this-&gt;createLine();
</span><span class='line'>        $this-&gt;createFont();
</span><span class='line'>        $this-&gt;outPut();
</span><span class='line'>    }   
</span><span class='line'>    // 获取验证码
</span><span class='line'>    public function getCode()
</span><span class='line'>    {
</span><span class='line'>        return strtolower($this-&gt;code);
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>//调用实例
</span><span class='line'>//$c = new Captcha();
</span><span class='line'>//$c-&gt;generateCode();
</span><span class='line'>//$_SESSION['captcha'] = $c-&gt;getCode();</span></code></pre></td></tr></table></div></figure>


<p>2.在php代码中调用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//验证码
</span><span class='line'>    public function yanzhengmaAction() {
</span><span class='line'>      //调用Captcha类
</span><span class='line'>        $this-&gt;library("Captcha");
</span><span class='line'>        $c = new Captcha(4,142,30);
</span><span class='line'>        $c-&gt;generateCode();
</span><span class='line'>        $_SESSION['yanzhengma'] = $c-&gt;getCode();
</span><span class='line'>    }</span></code></pre></td></tr></table></div></figure>


<p>3.在HTML网页中代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;td colspan="2" align="right"&gt;&lt;img src="index.php?p=admin&c=login&a=yanzhengma" width="142" height="30" alt="验证码图片" border="1" onclick= this.src="index.php?p=admin&c=login&a=yanzhengma&"+Math.random() style="cursor: pointer;" title="看不清？点击更换另一个验证码。" /&gt;</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Php常用的防黑客攻击的几种情况]]></title>
    <link href="http://hunter222.github.io/blog/2016/09/01/php-sql-xss/"/>
    <updated>2016-09-01T18:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/09/01/php-sql-xss</id>
    <content type="html"><![CDATA[<h6>1.防止暴力破解</h6>

<p>Get方式恶意攻击，（dos），通常硬件的方式来防止，防火墙。
Post方式暴力破解，从程序的角度来防止，最通用的方法就是增加验证码(验证码使用文章：<a href="http://hunter222.github.io/blog/2016/09/01/php-yanzhengma">http://hunter222.github.io/blog/2016/09/01/php-yanzhengma</a>)。</p>

<p>注意：验证码常见错误：</p>

<ol>
<li><p>字体文件的位置不对</p></li>
<li><p>由于在生成验证码的时候，使用了header()函数，它有一个特点，它之前不能有任何的输出，包括空格。解决办法，从index.php开始查找，凡是被包含进来的文件都需要查找</p></li>
<li><p>还需要注意一个的，就是你的文件编码要确保是 utf-8的，而不是带BOM头的utf-8。</p></li>
</ol>


<h6>2.防sql注入</h6>

<p>黑客通过在表单中填入特殊的字符或者是url中增加特殊的字符，然后想数据库发起请求，拼凑出sql语句，达到攻击的目的。</p>

<p>有两种形式：</p>

<p>Post表单提交；防止方式：1.MD5加密密码，2.使用addslashes函数给特殊字符单引号添加反斜杠</p>

<p>Get，url传参；防止方式：url传回的<em>GET[&lsquo;&rsquo;]加上1，如：$pages = $</em>GET[&lsquo;id&rsquo;]+1</p>

<p>凡是是用户提交的信息，都是不能相信的，都需要进行处理，其中之一就是转义。
也就意味着在所有的 收集表单信息的地方，都要调用 addslashes函数。当要转义数组时需要批量处理，代码如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//批量转义
</span><span class='line'>function  deepslashes($data){
</span><span class='line'>    //判断$data形式
</span><span class='line'>    if (empty($data)){
</span><span class='line'>        return $data;
</span><span class='line'>    }
</span><span class='line'>    //遍历数组
</span><span class='line'>    return is_array($data) ? array_map('deepslashes', $data) : addslashes($data);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h6>3.xss攻击</h6>

<p>Xss: cross site script 跨站脚本攻击</p>

<p>Css 被占用，表示样式表</p>

<p>恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意攻击用户的特殊目的。</p>

<p>防止方法：使用Htmlspecialchars函数 和  htmlentites函数把特殊字符转义，批量处理的示例代码如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//批量实体转义
</span><span class='line'>   function deepspecialchars($data){
</span><span class='line'>       if (empty($data)){
</span><span class='line'>           return $data;
</span><span class='line'>       }
</span><span class='line'>       return is_array($data) ? array_map('deepspecialchars', $data) : htmlspecialchars($data);
</span><span class='line'>   }</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于php文件操作示例]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/php-files/"/>
    <updated>2016-08-31T18:19:32+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/php-files</id>
    <content type="html"><![CDATA[<h6>一 、解析路径：</h6>

<p>1 获得文件名:</p>

<p>basename();</p>

<p>给出一个包含有指向一个文件的全路径的字符串，本函数返回基本的文件名。如果文件名是以 suffix 结束的，那这一部分也会被去掉。
eg:</p>

<p>$path = &ldquo;/home/httpd/html/index.php&rdquo;;</p>

<p>$file = basename($path,&ldquo;.php&rdquo;); // $file is set to &ldquo;index&rdquo;</p>

<p>2 得到目录部分：</p>

<p>dirname();</p>

<p>给出一个包含有指向一个文件的全路径的字符串，本函数返回去掉文件名后的目录名。
eg:</p>

<p>$path = &ldquo;/etc/passwd&rdquo;;</p>

<p>你$file = dirname($path); // $file is set to &ldquo;/etc&rdquo;</p>

<p>3 得到路径关联数组
pathinfo();
得到一个指定路径中的三个部分：目录名，基本名，扩展名。
eg:
$pathinfo = pathinfo(&ldquo;www/test/index.html&rdquo;);
var_dump($pathinfo);
// $path[&lsquo;dirname&rsquo;]
$path[&lsquo;basename&rsquo;]
$path[&lsquo;extenssion&rsquo;]</p>

<p>二、文件类型
1. filetype();
返回文件的类型。可能的值有 fifo，char，dir，block，link，file 和 unknown。
eg:
echo filetype(&lsquo;/etc/passwd&rsquo;); // file
echo filetype(&lsquo;/etc/&rsquo;);        // dir</p>

<p>三、得到给定文件有用信息数组(很有用)</p>

<ol>
<li>fstat();
通过已打开的文件指针取得文件信息
获取由文件指针 handle 所打开文件的统计信息。本函数和 stat() 函数相似，除了它是作用于已打开的文件指针而不是文件名。
eg:</li>
</ol>


<p>// 打开文件
$fp = fopen(&ldquo;/etc/passwd&rdquo;, &ldquo;r&rdquo;);
// 取得统计信息
$fstat = fstat($fp);
// 关闭文件
fclose($fp);
// 只显示关联数组部分
print_r(array_slice($fstat, 13));
2. stat()
获取由 filename 指定的文件的统计信息(类比fstat())#p#副标题#e#</p>

<p>四、计算大小
1. filesize()
返回文件大小的字节数，如果出错返回 FALSE 并生成一条 E_WARNING 级的错误。
eg:</p>

<p>// 输出类似：somefile.txt: 1024 bytes
$filename = &lsquo;somefile.txt&rsquo;;
echo $filename . &lsquo;: &rsquo; . filesize($filename) . &lsquo; bytes&rsquo;;</p>

<ol>
<li>disk_free_space()
获得目录所在磁盘分区的可用空间（字节单位）
eg</li>
</ol>


<p>// $df 包含根目录下可用的字节数
$df = disk_free_space(&ldquo;/&rdquo;);
//在 Windows 下:
disk_free_space(&ldquo;C:&rdquo;);
disk_free_space(&ldquo;D:&rdquo;);</p>

<ol>
<li>disk_total_space()
返回一个目录的磁盘总大小
eg:(同上，换掉函数)</li>
</ol>


<p>另：如需要计算一个目录大小，可以编写一个递归函数来实现</p>

<p>代码
function dir_size($dir){
    $dir_size = 0;
    if($dh = @opendir($dir)){
        while(($filename = readdir($dh)) != false){
            if($filename !=&lsquo;.&rsquo; and $filename !=&lsquo;..&rsquo;){</p>

<pre><code>            if(is_file($dir.'/'.$filename)){
                $dir_size +=filesize($dir.'/'.$filename);

            }elseif(is_dir($dir.'/'.$filename)){

                $dir_size +=dir_size($dir.'/'.$filename);
            }
        }

    }#end while

}# end opendir

@closedir($dh);
return $dir_size;
</code></pre>

<p>} #end function</p>

<p>五、 访问与修改时间
1. fileatime(): 最后访问时间
2. filectime(): 最后改变时间（任何数据的修改）
3. filemtime(): 最后修改时间（指仅是内容修改）</p>

<p>六、 文件的I/O操作</p>

<ol>
<li>fopen &ndash; 打开文件或者 URL</li>
</ol>


<p>mode 说明
&lsquo;r&rsquo; 只读方式打开，将文件指针指向文件头。
&lsquo;r+&rsquo; 读写方式打开，将文件指针指向文件头。
&lsquo;w&rsquo; 写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。
&lsquo;w+&rsquo; 读写方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。
&lsquo;a&rsquo; 写入方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。
&lsquo;a+&rsquo; 读写方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。
&lsquo;x&rsquo; 创建并以写入方式打开，将文件指针指向文件头。如果文件已存在，则 fopen() 调用失败并返回 FALSE，
&lsquo;x+&rsquo; 创建并以读写方式打开，将文件指针指向文件头。如果文件已存在，则 fopen() 调用失败并返回 FALSE
eg:</p>

<p>$handle = fopen(&ldquo;/home/rasmus/file.txt&rdquo;, &ldquo;r&rdquo;);#p#副标题#e#
 2. file &ndash; 把整个文件读入一个数组中(此函数是很有用的)</p>

<p>和 file_get_contents() 一样，只除了 file() 将文件作为一个数组返回。数组中的每个单元都是文件中相应的一行，包括换行符在内。如果失败 file() 返回 FALSE。
eg:</p>

<p>代码
$lines = file(&lsquo;<a href="http://www.example.com/">http://www.example.com/</a>&rsquo;);
// 在数组中循环，显示 HTML 的源文件并加上行号。
foreach ($lines as $line_num => $line) {
    echo &ldquo;Line #<b>{$line_num}</b> : &rdquo; . htmlspecialchars($line) . &ldquo;<br />\n&rdquo;;
}
// 另一个例子将 web 页面读入字符串。参见 file_get_contents()。
$html = implode(&lsquo;&rsquo;, file (&lsquo;<a href="http://www.example.com/">http://www.example.com/</a>&rsquo;));
3. fgets &ndash; 从文件指针中读取一行</p>

<p>从 handle 指向的文件中读取一行并返回长度最多为 length - 1 字节的字符串。碰到换行符（包括在返回值中）、EOF 或者已经读取了 length - 1 字节后停止（看先碰到那一种情况）。如果没有指定 length，则默认为 1K，或者说 1024 字节。
eg:</p>

<p>$handle = @fopen(&ldquo;/tmp/inputfile.txt&rdquo;, &ldquo;r&rdquo;);
if ($handle) {
    while (!feof($handle)) {
        $buffer = fgets($handle, 4096);
        echo $buffer;
    }
    fclose($handle);
}
 4. fgetss &ndash; 从文件指针中读取一行并过滤掉 HTML 标记</p>

<p>和 fgets() 相同，只除了 fgetss 尝试从读取的文本中去掉任何 HTML 和 PHP 标记。</p>

<p>   可以用可选的第三个参数指定哪些标记不被去掉</p>

<p>   另：对的目录的操作：
1. opendir &ndash; 打开目录句柄，打开一个目录句柄，可用于之后的 closedir()，readdir() 和 rewinddir() 调用中。
2. readdir &ndash; 从目录句柄中读取条目，返回目录中下一个文件的文件名。文件名以在文件系统中的排序返回。
eg:</p>

<p>代码
// 注意在 4.0.0-RC2 之前不存在 !== 运算符</p>

<p>if ($handle = opendir(&lsquo;/path/to/files&rsquo;)) {
    echo &ldquo;Directory handle: $handle\n&rdquo;;
    echo &ldquo;Files:\n&rdquo;;</p>

<pre><code>while (false !== ($file = readdir($handle))) {
    echo "$file\n";
}

while ($file = readdir($handle)) {
    echo "$file\n";
}
 closedir($handle);
</code></pre>

<p>}
3. scandir &ndash; 列出指定路径中的文件和目录(很有用),返回一个 array，包含有 directory 中的文件和目录。
默认的排序顺序是按字母升序排列。如果使用了可选参数 sorting_order（设为 1），则排序顺序是按字母降序排列。
eg:</p>

<p>$dir    = &lsquo;/tmp&rsquo;;
$files1 = scandir($dir);
$files2 = scandir($dir, 1);</p>

<p>print_r($files1);
print_r($files2); <br/>
另外注：</p>

<p>七、 对文件属性的操作（操作系统环境不同，可能有所不一样，这点要注意）</p>

<pre><code>1文件是否可读：

   boolis_readable ( string filename )

     如果由 filename 指定的文件或目录存在并且可读则返回 TRUE。

    记住 PHP 也许只能以运行 webserver 的用户名（通常为 'nobody'）来访问文件。不计入安全模式的限制。

2 文件是否可写

     bool is_writable ( string filename )

    如果文件存在并且可写则返回 TRUE。filename 参数可以是一个允许进行是否可写检查的目录名。

     记住 PHP 也许只能以运行 webserver 的用户名（通常为 'nobody'）来访问文件。不计入安全模式的限制
</code></pre>

<p>   3  检查文件是否存在</p>

<pre><code>boolfile_exists ( string filename )

  如果由 filename 指定的文件或目录存在则返回 TRUE，否则返回 FALSE
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux的基础语法]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/linux-base/"/>
    <updated>2016-08-31T18:19:31+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/linux-base</id>
    <content type="html"><![CDATA[<h5>Linux的目录结构：</h5>

<p>/bin bin是Binary的缩写。这个目录存放着最经常使用的命令。</p>

<p>/boot这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。</p>

<p>/dev dev是Device(设备)的缩写。该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。</p>

<p>/etc这个目录用来存放所有的系统管理所需要的配置文件和子目录。</p>

<p>/home用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。</p>

<p>/lib这个目录里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。</p>

<p>/lost+found这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。</p>

<p>/media Linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，Linux会把识别的设备挂载到这个目录下。</p>

<p>/mnt系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。</p>

<p>/opt 这是给主机额外安装软件所摆放的目录。比如您安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。</p>

<p>/proc这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping您的机器：
echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all。/root该目录为系统管理员，也称作超级权限者的用户主目录。</p>

<p>/sbin s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。</p>

<p>/selinux 这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。</p>

<p>/srv 该目录存放一些服务启动之后需要提取的数据。</p>

<p>/sys 这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs ，sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。该文件系统是内核设备树的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统种被创建。</p>

<p>/tmp这个目录是用来存放一些临时文件的。</p>

<p>/usr 这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与windows下的program files目录。</p>

<p>/usr/bin 系统用户使用的应用程序。</p>

<p>/usr/sbin 超级用户使用的比较高级的管理程序和系统守护程序。</p>

<p>/usr/src 内核源代码默认的放置目录。</p>

<p>/var这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。</p>

<p>在Linux系统中，有几个目录是比较重要的，平时需要注意不要误删除或者随意更改内部文件。/etc： 上边也提到了，这个是系统中的配置文件，如果您更改了该目录下的某个文件可能会导致系统不能启动。/bin, /sbin, /usr/bin, /usr/sbin: 这是系统预设的执行文件的放置目录，比如 ls 就是在/bin/ 目录下的。值得提出的是，/bin, /usr/bin 是给系统用户使用的指令（除root外的通用账户），而/sbin, /usr/sbin 则是给root使用的指令。 /var： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在/var/log 目录下，另外mail的预设放置也是在这里。</p>

<h5>常用的linux命令大全：</h5>

<h6>#系统信息:</h6>

<p>arch 显示机器的处理器架构(1)</p>

<p>uname -m 显示机器的处理器架构(2)</p>

<p>uname -r 显示正在使用的内核版本</p>

<p>dmidecode -q 显示硬件系统部件 - (SMBIOS / DMI)</p>

<p>hdparm -i /dev/hda 罗列一个磁盘的架构特性</p>

<p>hdparm -tT /dev/sda 在磁盘上执行测试性读取操作</p>

<p>cat /proc/cpuinfo 显示CPU info的信息</p>

<p>cat /proc/interrupts 显示中断</p>

<p>cat /proc/meminfo 校验内存使用</p>

<p>cat /proc/swaps 显示哪些swap被使用</p>

<p>cat /proc/version 显示内核的版本</p>

<p>cat /proc/net/dev 显示网络适配器及统计</p>

<p>cat /proc/mounts 显示已加载的文件系统</p>

<p>lspci -tv 罗列 PCI 设备</p>

<p>lsusb -tv 显示 USB 设备</p>

<p>date 显示系统日期</p>

<p>cal 2007 显示2007年的日历表</p>

<p>date 041217002007.00 设置日期和时间 - 月日时分年.秒</p>

<p>clock -w 将时间修改保存到 BIOS</p>

<p>关机 (系统的关机、重启以及登出 ):</p>

<p>shutdown -h now 关闭系统(1)</p>

<p>init 0 关闭系统(2)</p>

<p>telinit 0 关闭系统(3)</p>

<p>shutdown -h hours:minutes &amp; 按预定时间关闭系统</p>

<p>shutdown -c 取消按预定时间关闭系统</p>

<p>shutdown -r now 重启(1)</p>

<p>reboot 重启(2)</p>

<p>logout 注销</p>

<h6>文件和目录:</h6>

<p>cd /home 进入 &lsquo;/ home&rsquo; 目录'</p>

<p>cd .. 返回上一级目录</p>

<p>cd ../.. 返回上两级目录</p>

<p>cd 进入个人的主目录</p>

<p>cd ~user1 进入个人的主目录</p>

<p>cd - 返回上次所在的目录</p>

<p>pwd 显示工作路径</p>

<p>ls 查看目录中的文件</p>

<p>ls -F 查看目录中的文件</p>

<p>ls -l 显示文件和目录的详细资料</p>

<p>ls -a 显示隐藏文件</p>

<p>ls <em>[0-9]</em> 显示包含数字的文件名和目录名</p>

<p>tree 显示文件和目录由根目录开始的树形结构(1)</p>

<p>lstree 显示文件和目录由根目录开始的树形结构(2)</p>

<p>mkdir dir1 创建一个叫做 &lsquo;dir1&rsquo; 的目录'</p>

<p>mkdir dir1 dir2 同时创建两个目录</p>

<p>mkdir -p /tmp/dir1/dir2 创建一个目录树</p>

<p>rm -f file1 删除一个叫做 &lsquo;file1&rsquo; 的文件'</p>

<p>rmdir dir1 删除一个叫做 &lsquo;dir1&rsquo; 的目录'</p>

<p>rm -rf dir1 删除一个叫做 &lsquo;dir1&rsquo; 的目录并同时删除其内容</p>

<p>rm -rf dir1 dir2 同时删除两个目录及它们的内容</p>

<p>mv dir1 new_dir 重命名/移动 一个目录</p>

<p>cp file1 file2 复制一个文件</p>

<p>cp dir/* . 复制一个目录下的所有文件到当前工作目录</p>

<p>cp -a /tmp/dir1 . 复制一个目录到当前工作目录</p>

<p>cp -a dir1 dir2 复制一个目录</p>

<p>ln -s file1 lnk1 创建一个指向文件或目录的软链接</p>

<p>ln file1 lnk1 创建一个指向文件或目录的物理链接</p>

<p>touch -t 0712250000 file1 修改一个文件或目录的时间戳 -
(YYMMDDhhmm)</p>

<p>file file1 outputs the mime type of the file as text</p>

<p>iconv -l 列出已知的编码</p>

<p>iconv -f fromEncoding -t toEncoding inputFile > outputFile creates a new from the given input file by assuming it is encoded in fromEncoding and converting it to toEncoding.
find . -maxdepth 1 -name *.jpg -print -exec convert &ldquo;{}&rdquo; -resize 80x60 &ldquo;thumbs/{}&rdquo; \; batch resize files in the current directory and send them to a thumbnails directory (requires convert from Imagemagick)</p>

<h6>文件搜索:</h6>

<p>find / -name file1 从 &lsquo;/&rsquo; 开始进入根文件系统搜索文件和目录</p>

<p>find / -user user1 搜索属于用户 &lsquo;user1&rsquo; 的文件和目录</p>

<p>find /home/user1 -name *.bin 在目录 &lsquo;/ home/user1&rsquo; 中搜索带有'.bin' 结尾的文件</p>

<p>find /usr/bin -type f -atime +100 搜索在过去100天内未被使用过的执行文件</p>

<p>find /usr/bin -type f -mtime -10 搜索在10天内被创建或者修改过的文件</p>

<p>find / -name *.rpm -exec chmod 755 &lsquo;{}&rsquo; \; 搜索以 &lsquo;.rpm&rsquo; 结尾的文件并定义其权限</p>

<p>find / -xdev -name *.rpm 搜索以 &lsquo;.rpm&rsquo; 结尾的文件，忽略光驱、捷盘等可移动设备</p>

<p>locate *.ps 寻找以 &lsquo;.ps&rsquo; 结尾的文件 - 先运行 &lsquo;updatedb&rsquo; 命令</p>

<p>whereis halt 显示一个二进制文件、源码或man的位置</p>

<p>which halt 显示一个二进制文件或可执行文件的完整路径
挂载一个文件系统:</p>

<p>mount /dev/hda2 /mnt/hda2 挂载一个叫做hda2的盘 - 确定目录 &lsquo;/
mnt/hda2&rsquo; 已经存在</p>

<p>umount /dev/hda2 卸载一个叫做hda2的盘 - 先从挂载点 &lsquo;/ mnt/</p>

<p>hda2' 退出</p>

<p>fuser -km /mnt/hda2 当设备繁忙时强制卸载</p>

<p>umount -n /mnt/hda2 运行卸载操作而不写入 /etc/mtab 文件- 当文件为只读或当磁盘写满时非常有用</p>

<p>mount /dev/fd0 /mnt/floppy 挂载一个软盘</p>

<p>mount /dev/cdrom /mnt/cdrom 挂载一个cdrom或dvdrom</p>

<p>mount /dev/hdc /mnt/cdrecorder 挂载一个cdrw或dvdrom</p>

<p>mount /dev/hdb /mnt/cdrecorder 挂载一个cdrw或dvdrom
mount -o loop file.iso /mnt/cdrom 挂载一个文件或ISO镜像文件</p>

<p>mount -t vfat /dev/hda5 /mnt/hda5 挂载一个Windows FAT32文件系统</p>

<p>mount /dev/sda1 /mnt/usbdisk 挂载一个usb 捷盘或闪存设备</p>

<p>mount -t smbfs -o username=user,password=pass //WinClient/</p>

<p>share /mnt/share 挂载一个windows网络共享</p>

<h6>磁盘空间:</h6>

<p>df -h 显示已经挂载的分区列表</p>

<p>ls -lSr |more 以尺寸大小排列文件和目录</p>

<p>du -sh dir1 估算目录 &lsquo;dir1&rsquo; 已经使用的磁盘空间'</p>

<p>du -sk * | sort -rn 以容量大小为依据依次显示文件和目录的大小</p>

<p>rpm -q -a &ndash;qf &lsquo;%10{SIZE}t%{NAME}n&rsquo; | sort -k1,1n 以大小为依据依次显示已安装的rpm包所使用的空间 (fedora, redhat类系统)</p>

<p>dpkg-query -W -f=&lsquo;${Installed-Size;10}t${Package}n&rsquo; | sort -k1,1n 以大小为依据显示已安装的deb包所使用的空间 (ubuntu, debian类系统)</p>

<h6>用户和群组:</h6>

<p>groupadd group_name 创建一个新用户组</p>

<p>groupdel group_name 删除一个用户组</p>

<p>groupmod -n new_group_name old_group_name 重命名一个用户组</p>

<p>useradd -c &ldquo;Name Surname &rdquo; -g admin -d /home/user1 -s /</p>

<p>bin/bash user1 创建一个属于 &ldquo;admin&rdquo; 用户组的用户</p>

<p>useradd user1 创建一个新用户</p>

<p>userdel -r user1 删除一个用户 ( &lsquo;-r&rsquo; 排除主目录)</p>

<p>usermod -c &ldquo;User FTP&rdquo; -g system -d /ftp/user1 -s /bin/</p>

<p>nologin user1 修改用户属性</p>

<p>passwd 修改口令</p>

<p>passwd user1 修改一个用户的口令 (只允许root执行)</p>

<p>chage -E 2005-12-31 user1 设置用户口令的失效期限</p>

<p>pwck 检查 &lsquo;/etc/passwd&rsquo; 的文件格式和语法修正以及存在的用户</p>

<p>grpck 检查 &lsquo;/etc/passwd&rsquo; 的文件格式和语法修正以及存在的群组</p>

<p>newgrp group_name 登陆进一个新的群组以改变新创建文件的预设群组</p>

<p>文件的权限 - 使用 &ldquo;+&rdquo; 设置权限，使用 &ldquo;-&rdquo; 用于取消</p>

<p>ls -lh 显示权限</p>

<p>ls /tmp | pr -T5 -W$COLUMNS 将终端划分成5栏显示</p>

<p>chmod ugo+rwx directory1 设置目录的所有人(u)、群组(g)以及其他人(o)以读（r ）、写(w)和执行(x)的权限</p>

<p>chmod go-rwx directory1 删除群组(g)与其他人(o)对目录的读写执行权限</p>

<p>chown user1 file1 改变一个文件的所有人属性</p>

<p>chown -R user1 directory1 改变一个目录的所有人属性并同时改变改目录下所有文件的属性</p>

<p>chgrp group1 file1 改变文件的群组</p>

<p>chown user1:group1 file1 改变一个文件的所有人和群组属性</p>

<p>find / -perm -u+s 罗列一个系统中所有使用了SUID控制的文件</p>

<p>chmod u+s /bin/file1 设置一个二进制文件的 SUID 位 - 运行该文件的用户也被赋予和所有者同样的权限</p>

<p>chmod u-s /bin/file1 禁用一个二进制文件的 SUID位</p>

<p>chmod g+s /home/public 设置一个目录的SGID 位 - 类似SUID ，不过这是针对目录的</p>

<p>chmod g-s /home/public 禁用一个目录的 SGID 位</p>

<p>chmod o+t /home/public 设置一个文件的 STIKY 位 - 只允许合法所有人删除文件</p>

<p>chmod o-t /home/public 禁用一个目录的 STIKY 位</p>

<p>文件的特殊属性 - 使用 &ldquo;+&rdquo; 设置权限，使用 &ldquo;-&rdquo; 用于取消</p>

<p>chattr +a file1 只允许以追加方式读写文件</p>

<p>chattr +c file1 允许这个文件能被内核自动压缩/解压</p>

<p>chattr +d file1 在进行文件系统备份时，dump程序将忽略这个文件</p>

<p>chattr +i file1 设置成不可变的文件，不能被删除、修改、重命名或者链接</p>

<p>chattr +s file1 允许一个文件被安全地删除</p>

<p>chattr +S file1 一旦应用程序对这个文件执行了写操作，使系统立刻把修改的结果写到磁盘</p>

<p>chattr +u file1 若文件被删除，系统会允许你在以后恢复这个被删除的文件</p>

<p>lsattr 显示特殊的属性</p>

<h6>打包和压缩文件:</h6>

<p>bunzip2 file1.bz2 解压一个叫做 &lsquo;file1.bz2'的文件</p>

<p>bzip2 file1 压缩一个叫做 &lsquo;file1&rsquo; 的文件</p>

<p>gunzip file1.gz 解压一个叫做 &lsquo;file1.gz'的文件</p>

<p>gzip file1 压缩一个叫做 &lsquo;file1'的文件</p>

<p>gzip -9 file1 最大程度压缩</p>

<p>rar a file1.rar test_file 创建一个叫做 &lsquo;file1.rar&rsquo; 的包</p>

<p>rar a file1.rar file1 file2 dir1 同时压缩 &lsquo;file1&rsquo;, &lsquo;file2&rsquo;
以及目录 &lsquo;dir1&rsquo;</p>

<p>rar x file1.rar 解压rar包</p>

<p>unrar x file1.rar 解压rar包</p>

<p>tar -cvf archive.tar file1 创建一个非压缩的 tarball</p>

<p>tar -cvf archive.tar file1 file2 dir1 创建一个包含了 &lsquo;file1&rsquo;, &lsquo;file2&rsquo; 以及 &lsquo;dir1'的档案文件</p>

<p>tar -tf archive.tar 显示一个包中的内容</p>

<p>tar -xvf archive.tar 释放一个包</p>

<p>tar -xvf archive.tar -C /tmp 将压缩包释放到 /tmp目录下</p>

<p>tar -cvfj archive.tar.bz2 dir1 创建一个bzip2格式的压缩包</p>

<p>tar -xvfj archive.tar.bz2 解压一个bzip2格式的压缩包</p>

<p>tar -cvfz archive.tar.gz dir1 创建一个gzip格式的压缩包</p>

<p>tar -xvfz archive.tar.gz 解压一个gzip格式的压缩包</p>

<p>zip file1.zip file1 创建一个zip格式的压缩包</p>

<p>zip -r file1.zip file1 file2 dir1 将几个文件和目录同时压缩成一个zip格式的压缩包</p>

<p>unzip file1.zip 解压一个zip格式压缩包</p>

<p>RPM 包 - （Fedora, Redhat及类似系统）</p>

<p>rpm -ivh package.rpm 安装一个rpm包</p>

<p>rpm -ivh &ndash;nodeeps package.rpm 安装一个rpm包而忽略依赖关系警告</p>

<p>rpm -U package.rpm 更新一个rpm包但不改变其配置文件</p>

<p>rpm -F package.rpm 更新一个确定已经安装的rpm包</p>

<p>rpm -e package_name.rpm 删除一个rpm包</p>

<p>rpm -qa 显示系统中所有已经安装的rpm包</p>

<p>rpm -qa | grep httpd 显示所有名称中包含 &ldquo;httpd&rdquo; 字样的rpm包</p>

<p>rpm -qi package_name 获取一个已安装包的特殊信息</p>

<p>rpm -qg &ldquo;System Environment/Daemons&rdquo; 显示一个组件的rpm包</p>

<p>rpm -ql package_name 显示一个已经安装的rpm包提供的文件列表</p>

<p>rpm -qc package_name 显示一个已经安装的rpm包提供的配置文件列表</p>

<p>rpm -q package_name &ndash;whatrequires 显示与一个rpm包存在依赖关
系的列表</p>

<p>rpm -q package_name &ndash;whatprovides 显示一个rpm包所占的体积</p>

<p>rpm -q package_name &ndash;scripts 显示在安装/删除期间所执行的脚本l</p>

<p>rpm -q package_name &ndash;changelog 显示一个rpm包的修改历史</p>

<p>rpm -qf /etc/httpd/conf/httpd.conf 确认所给的文件由哪个rpm包所提供</p>

<p>rpm -qp package.rpm -l 显示由一个尚未安装的rpm包提供的文件列表</p>

<p>rpm &ndash;import /media/cdrom/RPM-GPG-KEY 导入公钥数字证书</p>

<p>rpm &ndash;checksig package.rpm 确认一个rpm包的完整性</p>

<p>rpm -qa gpg-pubkey 确认已安装的所有rpm包的完整性</p>

<p>rpm -V package_name 检查文件尺寸、 许可、类型、所有者、群组、MD5检查以及最后修改时间</p>

<p>rpm -Va 检查系统中所有已安装的rpm包- 小心使用</p>

<p>rpm -Vp package.rpm 确认一个rpm包还未安装</p>

<p>rpm2cpio package.rpm | cpio &ndash;extract &ndash;make-directories</p>

<p><em>bin</em> 从一个rpm包运行可执行文件</p>

<p>rpm -ivh /usr/src/redhat/RPMS/<code>arch</code>/package.rpm 从一个rpm
源码安装一个构建好的包</p>

<p>rpmbuild &ndash;rebuild package_name.src.rpm 从一个rpm源码构建一个 rpm 包</p>

<h6>YUM 软件包升级器 - （Fedora, RedHat及类似系统）</h6>

<p>yum install package_name 下载并安装一个rpm包</p>

<p>yum localinstall package_name.rpm 将安装一个rpm包，使用你自己的软件仓库为你解决所有依赖关系</p>

<p>yum update package_name.rpm 更新当前系统中所有安装的rpm包</p>

<p>yum update package_name 更新一个rpm包</p>

<p>yum remove package_name 删除一个rpm包</p>

<p>yum list 列出当前系统中安装的所有包</p>

<p>yum search package_name 在rpm仓库中搜寻软件包</p>

<p>yum clean packages 清理rpm缓存删除下载的包</p>

<p>yum clean headers 删除所有头文件</p>

<p>yum clean all 删除所有缓存的包和头文件</p>

<p>DEB 包 (Debian, Ubuntu 以及类似系统)</p>

<p>dpkg -i package.deb 安装/更新一个 deb 包</p>

<p>dpkg -r package_name 从系统删除一个 deb 包</p>

<p>dpkg -l 显示系统中所有已经安装的 deb 包</p>

<p>dpkg -l | grep httpd 显示所有名称中包含 &ldquo;httpd&rdquo; 字样的deb包</p>

<p>dpkg -s package_name 获得已经安装在系统中一个特殊包的信息</p>

<p>dpkg -L package_name 显示系统中已经安装的一个deb包所提供的文件列表</p>

<p>dpkg &ndash;contents package.deb 显示尚未安装的一个包所提供的文件列表</p>

<p>dpkg -S /bin/ping 确认所给的文件由哪个deb包提供</p>

<p>APT 软件工具 (Debian, Ubuntu 以及类似系统)</p>

<p>apt-get install package_name 安装/更新一个 deb 包</p>

<p>apt-cdrom install package_name 从光盘安装/更新一个 deb 包</p>

<p>apt-get update 升级列表中的软件包</p>

<p>apt-get upgrade 升级所有已安装的软件</p>

<p>apt-get remove package_name 从系统删除一个deb包</p>

<p>apt-get check 确认依赖的软件仓库正确</p>

<p>apt-get clean 从下载的软件包中清理缓存</p>

<p>apt-cache search searched-package 返回包含所要搜索字符串的软件包名称</p>

<h6>查看文件内容:</h6>

<p>cat file1 从第一个字节开始正向查看文件的内容</p>

<p>tac file1 从最后一行开始反向查看一个文件的内容</p>

<p>more file1 查看一个长文件的内容</p>

<p>less file1 类似于 &lsquo;more&rsquo; 命令，但是它允许在文件中和正向操作一样的反向操作</p>

<p>head -2 file1 查看一个文件的前两行</p>

<p>tail -2 file1 查看一个文件的最后两行</p>

<p>tail -f /var/log/messages 实时查看被添加到一个文件中的内容</p>

<h6>文本处理:</h6>

<p>cat file1 file2 &hellip; | command &lt;></p>

<p>file1_in.txt_or_file1_out.txt general syntax for text</p>

<p>manipulation using PIPE, STDIN and STDOUT</p>

<p>cat file1 | command( sed, grep, awk, grep, etc&hellip;) ></p>

<p>result.txt 合并一个文件的详细说明文本，并将简介写入一个新文件中</p>

<p>cat file1 | command( sed, grep, awk, grep, etc&hellip;) >></p>

<p>result.txt 合并一个文件的详细说明文本，并将简介写入一个已有的文件中</p>

<p>grep Aug /var/log/messages 在文件 &lsquo;/var/log/messages'中查找关键词"Aug"</p>

<p>grep ^Aug /var/log/messages 在文件 &lsquo;/var/log/messages'中查找以"Aug"开始的词汇</p>

<p>grep [0-9] /var/log/messages 选择 &lsquo;/var/log/messages&rsquo; 文件中所有包含数字的行</p>

<p>grep Aug -R /var/log/* 在目录 &lsquo;/var/log&rsquo; 及随后的目录中搜索字符串"Aug"</p>

<p>sed &rsquo;s/stringa1/stringa2/g' example.txt 将example.txt文件中的 &ldquo;string1&rdquo; 替换成 &ldquo;string2&rdquo;</p>

<p>sed &lsquo;/^$/d&rsquo; example.txt 从example.txt文件中删除所有空白行</p>

<p>sed &lsquo;/ *#/d; /^$/d&rsquo; example.txt 从example.txt文件中删除所有注释和空白行</p>

<p>echo &lsquo;esempio&rsquo; | tr &lsquo;[:lower:]&rsquo; &lsquo;[:upper:]&rsquo; 合并上下单元格内容</p>

<p>sed -e &lsquo;1d&rsquo; result.txt 从文件example.txt 中排除第一行</p>

<p>sed -n &lsquo;/stringa1/p&rsquo; 查看只包含词汇 &ldquo;string1"的行</p>

<p>sed -e &rsquo;s/ *$//&lsquo; example.txt 删除每一行最后的空白字符</p>

<p>sed -e &rsquo;s/stringa1//g' example.txt 从文档中只删除词汇 &ldquo;string1&rdquo; 并保留剩余全部</p>

<p>sed -n &lsquo;1,5p;5q&rsquo; example.txt 查看从第一行到第5行内容</p>

<p>sed -n &lsquo;5p;5q&rsquo; example.txt 查看第5行</p>

<p>sed -e &rsquo;s/00*/0/g' example.txt 用单个零替换多个零</p>

<p>cat -n file1 标示文件的行数</p>

<p>cat example.txt | awk &lsquo;NR%2==1&rsquo; 删除example.txt文件中的所有偶数行</p>

<p>echo a b c | awk &lsquo;{print $1}&rsquo; 查看一行第一栏</p>

<p>echo a b c | awk &lsquo;{print $1,$3}&rsquo; 查看一行的第一和第三栏</p>

<p>paste file1 file2 合并两个文件或两栏的内容</p>

<p>paste -d &lsquo;+&rsquo; file1 file2 合并两个文件或两栏的内容，中间用"+&ldquo;区分</p>

<p>sort file1 file2 排序两个文件的内容</p>

<p>sort file1 file2 | uniq 取出两个文件的并集(重复的行只保留一份)</p>

<p>sort file1 file2 | uniq -u 删除交集，留下其他的行</p>

<p>sort file1 file2 | uniq -d 取出两个文件的交集(只留下同时存在于两个文件中的文件)</p>

<p>comm -1 file1 file2 比较两个文件的内容只删除 &lsquo;file1&rsquo; 所包含的内容</p>

<p>comm -2 file1 file2 比较两个文件的内容只删除 &lsquo;file2&rsquo; 所包含的内容</p>

<p>comm -3 file1 file2 比较两个文件的内容只删除两个文件共有的部分</p>

<h6>字符设置和文件格式转换:</h6>

<p>dos2unix filedos.txt fileunix.txt 将一个文本文件的格式从MSDOS转换成UNIX</p>

<p>unix2dos fileunix.txt filedos.txt 将一个文本文件的格式从UNIX转换成MSDOS</p>

<p>recode ..HTML &lt; page.txt > page.html 将一个文本文件转换成html</p>

<p>recode -l | more 显示所有允许的转换格式</p>

<h6>文件系统分析:</h6>

<p>badblocks -v /dev/hda1 检查磁盘hda1上的坏磁块</p>

<p>fsck /dev/hda1 修复/检查hda1磁盘上linux文件系统的完整性</p>

<p>fsck.ext2 /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性</p>

<p>e2fsck /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性</p>

<p>e2fsck -j /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性</p>

<p>fsck.ext3 /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性</p>

<p>fsck.vfat /dev/hda1 修复/检查hda1磁盘上fat文件系统的完整性</p>

<p>fsck.msdos /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性</p>

<p>dosfsck /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性</p>

<h6>初始化一个文件系统:</h6>

<p>mkfs /dev/hda1 在hda1分区创建一个文件系统</p>

<p>mke2fs /dev/hda1 在hda1分区创建一个linux ext2的文件系统</p>

<p>mke2fs -j /dev/hda1 在hda1分区创建一个linux ext3(日志型)的文件系统</p>

<p>mkfs -t vfat 32 -F /dev/hda1 创建一个 FAT32 文件系统</p>

<p>fdformat -n /dev/fd0 格式化一个软盘</p>

<p>mkswap /dev/hda3 创建一个swap文件系统</p>

<h6>SWAP文件系统:</h6>

<p>mkswap /dev/hda3 创建一个swap文件系统</p>

<p>swapon /dev/hda3 启用一个新的swap文件系统</p>

<p>swapon /dev/hda2 /dev/hdb3 启用两个swap分区</p>

<h6>备份:</h6>

<p>dump -0aj -f /tmp/home0.bak /home 制作一个 &lsquo;/home&rsquo; 目录的完
整备份</p>

<p>dump -1aj -f /tmp/home0.bak /home 制作一个 &lsquo;/home&rsquo; 目录的交互式备份</p>

<p>restore -if /tmp/home0.bak 还原一个交互式备份</p>

<p>rsync -rogpav &ndash;delete /home /tmp 同步两边的目录</p>

<p>rsync -rogpav -e ssh &ndash;delete /home ip_address:/tmp 通过SSH通道rsync</p>

<p>rsync -az -e ssh &ndash;delete ip_addr:/home/public /home/local 通过ssh和压缩将一个远程目录同步到本地目录</p>

<p>rsync -az -e ssh &ndash;delete /home/local ip_addr:/home/public 通过ssh和压缩将本地目录同步到远程目录</p>

<p>dd bs=1M if=/dev/hda | gzip | ssh user@ip_addr &lsquo;dd
of=hda.gz&rsquo; 通过ssh在远程主机上执行一次备份本地磁盘的操作</p>

<p>dd if=/dev/sda of=/tmp/file1 备份磁盘内容到一个文件</p>

<p>tar -Puf backup.tar /home/user 执行一次对 &lsquo;/home/user&rsquo; 目录的交互式备份操作</p>

<p>( cd /tmp/local/ &amp;&amp; tar c . ) | ssh -C user@ip_addr &lsquo;cd /home/share/ &amp;&amp; tar x -p&rsquo; 通过ssh在远程目录中复制一个目录内容</p>

<p>( tar c /home ) | ssh -C user@ip_addr &lsquo;cd /home/backup-
home &amp;&amp; tar x -p&rsquo; 通过ssh在远程目录中复制一个本地目录</p>

<p>tar cf - . | (cd /tmp/backup ; tar xf - ) 本地将一个目录复制到另一个地方，保留原有权限及链接</p>

<p>find /home/user1 -name &lsquo;*.txt&rsquo; | xargs cp -av &ndash;target-directory=/home/backup/ &ndash;parents 从一个目录查找并复制所有以 &lsquo;.txt&rsquo; 结尾的文件到另一个目录</p>

<p>find /var/log -name &lsquo;*.log&rsquo; | tar cv &ndash;files-from=- |
bzip2 > log.tar.bz2 查找所有以 &lsquo;.log&rsquo; 结尾的文件并做成一个bzip包</p>

<p>dd if=/dev/hda of=/dev/fd0 bs=512 count=1 做一个将 MBR (Master Boot Record)内容复制到软盘的动作</p>

<p>dd if=/dev/fd0 of=/dev/hda bs=512 count=1 从已经保存到软盘的备份中恢复MBR内容</p>

<h6>光盘:</h6>

<p>cdrecord -v gracetime=2 dev=/dev/cdrom -eject blank=fast -force 清空一个可复写的光盘内容</p>

<p>mkisofs /dev/cdrom > cd.iso 在磁盘上创建一个光盘的iso镜像文件</p>

<p>mkisofs /dev/cdrom | gzip > cd_iso.gz 在磁盘上创建一个压缩了的光盘iso镜像文件</p>

<p>mkisofs -J -allow-leading-dots -R -V &ldquo;Label CD&rdquo; -iso-level 4 -o ./cd.iso data_cd 创建一个目录的iso镜像文件
cdrecord -v dev=/dev/cdrom cd.iso 刻录一个ISO镜像文件
gzip -dc cd_iso.gz | cdrecord dev=/dev/cdrom - 刻录一个压缩了的ISO镜像文件</p>

<p>mount -o loop cd.iso /mnt/iso 挂载一个ISO镜像文件</p>

<p>cd-paranoia -B 从一个CD光盘转录音轨到 wav 文件中</p>

<p>cd-paranoia &ndash; &ldquo;-3&rdquo; 从一个CD光盘转录音轨到 wav 文件中（参数-3）</p>

<p>cdrecord &ndash;scanbus 扫描总线以识别scsi通道</p>

<p>dd if=/dev/hdc | md5sum 校验一个设备的md5sum编码，例如一张 CD</p>

<h6>网络 - (以太网和WIFI无线):</h6>

<p>ifconfig eth0 显示一个以太网卡的配置</p>

<p>ifup eth0 启用一个 &lsquo;eth0&rsquo; 网络设备</p>

<p>ifdown eth0 禁用一个 &lsquo;eth0&rsquo; 网络设备</p>

<p>ifconfig eth0 192.168.1.1 netmask 255.255.255.0 控制IP地址</p>

<p>ifconfig eth0 promisc 设置 &lsquo;eth0&rsquo; 成混杂模式以嗅探数据包
(sniffing)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[【转】php的数组各种用法(上)]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/php-arrays/"/>
    <updated>2016-08-31T18:19:30+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/php-arrays</id>
    <content type="html"><![CDATA[<h5>一、数组操作的基本函数</h5>

<p>数组的键名和值</p>

<p>array_values($arr);获得数组的值</p>

<p>array_keys($arr);获得数组的键名</p>

<p>array_flip($arr);数组中的值与键名互换（如果有重复前面的会被后面的覆盖）</p>

<p>in_array(&ldquo;apple&rdquo;,$arr);在数组中检索apple</p>

<p>array_search(&ldquo;apple&rdquo;,$arr);在数组中检索apple ，如果存在返回键名</p>

<p>array_key_exists(&ldquo;apple&rdquo;,$arr);检索给定的键名是否存在数组中
isset($arr[apple]):检索给定的键名是否存在数组中</p>

<p>数组的内部指针</p>

<p>current($arr);返回数组中的当前单元</p>

<p>pos($arr);返回数组中的当前单元</p>

<p>key($arr);返回数组中当前单元的键名</p>

<p>prev($arr);将数组中的内部指针倒回一位</p>

<p>next($arr);将数组中的内部指针向前移动一位</p>

<p>end($arr);将数组中的内部指针指向最后一个单元</p>

<p>reset($arr;将数组中的内部指针指向第一个单元</p>

<p>each($arr);将返回数组当前元素的一个键名/值的构造数组，并使数组指针向前移动一位</p>

<p>list($key,$value)=each($arr);获得数组当前元素的键名和值
数组和变量之间的转换</p>

<p>extract($arr);用于把数组中的元素转换成变量导入到当前文件中，键名当作变量名，值作为变量值</p>

<p>注：（第二个参数很重要，可以看手册使用）使用方法  echo $a;
compact(var1,var2,var3);用给定的变量名创建一个数组</p>

<h5>二、数组的分段和填充</h5>

<p>数组的分段</p>

<p>array_slice($arr,0,3);可以将数组中的一段取出，此函数忽略键名</p>

<p>array_splice($arr,0,3，array(&ldquo;black&rdquo;,&ldquo;maroon&rdquo;));</p>

<p>可以将数组中的一段取出，与上个函数不同在于返回的序列从原数组中删除</p>

<p>分割多个数组</p>

<p>array_chunk($arr,3,TRUE);可以将一个数组分割成多个，TRUE为保留
原数组的键名</p>

<p>数组的填充</p>

<p>array_pad($arr,5,&lsquo;x&rsquo;);将一个数组填补到制定长度</p>

<h5>三、数组与栈</h5>

<p>array_push($arr,&ldquo;apple&rdquo;,&ldquo;pear&rdquo;);将一个或多个元素压入数组栈的末尾（入栈），返回入栈元素的个数
array_pop($arr);将数组栈的最后一个元素弹出（出栈）</p>

<h5>四、数组与列队</h5>

<p>array_shift($arr);数组中的第一个元素移出并作为结果返回（数组长度减1，其他元素向前移动一位，数字键名改为从零技术，文字键名不变）</p>

<p>array_unshift($arr,&ldquo;a&rdquo;,array(1,2));在数组的开头插入一个或多个元素</p>

<h5>五、回调函数</h5>

<p>array_walk($arr,&lsquo;function&rsquo;,&lsquo;words&rsquo;);使用用户函数对数组中的每个成员进行处理（第三个参数传递给回调函数function）</p>

<p>array_mpa(&ldquo;function&rdquo;,$arr1,$arr2);可以处理多个数组（当使用两个或更多数组时，他们的长度应该相同）</p>

<p>array_filter($arr,&ldquo;function&rdquo;);使用回调函数过滤数组中的每个元素，如果回调函数为TRUE，数组的当前元素会被包含在返回的结果数组中，数组的键名保留不变</p>

<p>array_reduce($arr,&ldquo;function&rdquo;,&ldquo;<em>&rdquo;);转化为单值函数（</em>为数组的第一个值）</p>

<h5>六、数组的排序</h5>

<p>通过元素值对数组排序</p>

<p>sort($arr);由小到大的顺序排序（第二个参数为按什么方式排序）忽略键名的数组排序</p>

<p>rsort($arr);由大到小的顺序排序（第二个参数为按什么方式排序）忽略键名的数组排序</p>

<p>usort($arr,&ldquo;function&rdquo;);使用用户自定义的比较函数对数组中的值进行排序（function中有两个参数，0表示相等，正数表示第一个大于第二个，负数表示第一个小于第二个）忽略键名的数组排序</p>

<p>asort($arr);由小到大的顺序排序（第二个参数为按什么方式排序）保留键名的数组排序</p>

<p>arsort($arr);由大到小的顺序排序（第二个参数为按什么方式排序）保留键名的数组排序</p>

<p>uasort($arr,&ldquo;function&rdquo;);使用用户自定义的比较函数对数组中的值进行排序（function中有两个参数，0表示相等，正数表示第一个大于第二
个，负数表示第一个小于第二个）保留键名的数组排序</p>

<p>通过键名对数组排序</p>

<p>ksort($arr);按照键名正序排序</p>

<p>krsort($arr);按照键名逆序排序</p>

<p>uksort($arr,&ldquo;function&rdquo;);使用用户自定义的比较函数对数组中的键名
进行排序（function中有两个参数，0表示相等，正数表示第一个大于第二个，负数表示第一个小于第二个）</p>

<p>自然排序法排序
natsort($arr);自然排序（忽略键名）
natcasesort($arr);自然排序（忽略大小写，忽略键名）</p>

<h5>七、数组的计算</h5>

<p>数组元素的求和</p>

<p>array_sum($arr);对数组内部的所有元素做求和运算
数组的合并</p>

<p>array_merge($arr1,$arr2);合并两个或多个数组（相同的字符串键名，后面的覆盖前面的，相同的数字键名，后面的不会做覆盖操作，而是附加到后面）</p>

<p>“+”$arr1+$arr2;对于相同的键名只保留后一个</p>

<p>array_merge_recursive($arr1,$arr2); 递归合并操作，如果数组中有相同的字符串键名，这些值将被合并到一个数组中去。如果一个值本身是一个数组，将按照相应的键名把它合并为另一个数组。当数组 具有相同的</p>

<p>数组键名时，后一个值将不会覆盖原来的值，而是附加到后面</p>

<p>数组的差集</p>

<p>array_diff($arr1,$arr2);返回差集结果数组</p>

<p>array_diff_assoc($arr1,$arr2,$arr3);返回差集结果数组，键名也做比较</p>

<p>数组的交集</p>

<p>array_intersect($arr1,$arr2);返回交集结果数组</p>

<p>array_intersect_assoc($arr1,$arr2);返回交集结果数组，键名也做比较</p>

<h5>八、其他的数组函数</h5>

<p>range(0,12);创建一个包含指定范围单元的数组</p>

<p>array_unique($arr);移除数组中重复的值，新的数组中会保留原始的键名</p>

<p>array_reverse($arr,TRUE);返回一个单元顺序与原数组相反的数组，如果第二个参数为TRUE保留原来的键名</p>

<p>//srand((float)microtime()*10000000); 随机种子触发器</p>

<p>array_rand($arr,2);从数组中随机取出一个或 多个元素</p>

<p>shuffle($arr);将数组的顺序打乱</p>

<p>本类函数允许用多种方法来操作数组和与之交互。数组的本质是储存，管理
和操作一组变量。</p>

<p>PHP 支持一维和多维数组，可以是用户创建或由另一个函数创建。有一些特定的数据库处理函数可以从数据库查询中生成数组，还有一些函数返回数组。</p>

<p>array_change_key_case — 返回字符串键名全为小写或大写的数组</p>

<p>array_chunk — 将一个数组分割成多个</p>

<p>array_combine — 创建一个数组，用一个数组的值作为其键名，另一个数组的值作为其值</p>

<p>array_count_values — 统计数组中所有的值出现的次数</p>

<p>array_diff_assoc — 带索引检查计算数组的差集</p>

<p>array_diff_key — 使用键名比较计算数组的差集</p>

<p>array_diff_uassoc — 用用户提供的回调函数做索引检查来计算数组的差集</p>

<p>array_diff_ukey — 用回调函数对键名比较计算数组的差集</p>

<p>array_diff — 计算数组的差集</p>

<p>array_fill_keys — Fill an array with values, specifying keys</p>

<p>array_fill — 用给定的值填充数组</p>

<p>array_filter — 用回调函数过滤数组中的单元</p>

<p>array_flip — 交换数组中的键和值</p>

<p>array_intersect_assoc — 带索引检查计算数组的交集</p>

<p>array_intersect_key — 使用键名比较计算数组的交集</p>

<p>array_intersect_uassoc — 带索引检查计算数组的交集，用回调函数比
较索引</p>

<p>array_intersect_ukey — 用回调函数比较键名来计算数组的交集</p>

<p>array_intersect — 计算数组的交集</p>

<p>array_key_exists — 检查给定的键名或索引是否存在于数组中</p>

<p>array_keys — 返回数组中所有的键名</p>

<p>array_map — 将回调函数作用到给定数组的单元上</p>

<p>array_merge_recursive — 递归地合并一个或多个数组</p>

<p>array_merge — 合并一个或多个数组</p>

<p>array_multisort — 对多个数组或多维数组进行排序</p>

<p>array_pad — 用值将数组填补到指定长度</p>

<p>array_pop — 将数组最后一个单元弹出（出栈）</p>

<p>array_product — 计算数组中所有值的乘积</p>

<p>array_push — 将一个或多个单元压入数组的末尾（入栈）</p>

<p>array_rand — 从数组中随机取出一个或多个单元</p>

<p>array_reduce — 用回调函数迭代地将数组简化为单一的值</p>

<p>array_reverse — 返回一个单元顺序相反的数组</p>

<p>array_search — 在数组中搜索给定的值，如果成功则返回相应的键名</p>

<p>array_shift — 将数组开头的单元移出数组</p>

<p>array_slice — 从数组中取出一段</p>

<p>array_splice — 把数组中的一部分去掉并用其它值取代</p>

<p>array_sum — 计算数组中所有值的和</p>

<p>array_udiff_assoc — 带索引检查计算数组的差集，用回调函数比较数据</p>

<p>array_udiff_uassoc — 带索引检查计算数组的差集，用回调函数比较数
据和索引</p>

<p>array_udiff — 用回调函数比较数据来计算数组的差集</p>

<p>array_uintersect_assoc — 带索引检查计算数组的交集，用回调函数比
较数据</p>

<p>array_uintersect_uassoc — 带索引检查计算数组的交集，用回调函数比较数据和索引</p>

<p>array_uintersect — 计算数组的交集，用回调函数比较数据</p>

<p>array_unique — 移除数组中重复的值</p>

<p>array_unshift — 在数组开头插入一个或多个单元</p>

<p>array_values — 返回数组中所有的值</p>

<p>array_walk_recursive — 对数组中的每个成员递归地应用用户函数</p>

<p>array_walk — 对数组中的每个成员应用用户函数</p>

<p>array — 新建一个数组</p>

<p>arsort — 对数组进行逆向排序并保持索引关系</p>

<p>asort — 对数组进行排序并保持索引关系</p>

<p>compact — 建立一个数组，包括变量名和它们的值</p>

<p>count — 计算数组中的单元数目或对象中的属性个数</p>

<p>current — 返回数组中的当前单元</p>

<p>each — 返回数组中当前的键／值对并将数组指针向前移动一步</p>

<p>end — 将数组的内部指针指向最后一个单元</p>

<p>extract — 从数组中将变量导入到当前的符号表</p>

<p>in_array — 检查数组中是否存在某个值</p>

<p>key — 从关联数组中取得键名</p>

<p>krsort — 对数组按照键名逆向排序</p>

<p>ksort — 对数组按照键名排序</p>

<p>list — 把数组中的值赋给一些变量</p>

<p>natcasesort — 用“自然排序”算法对数组进行不区分大小写字母的排序</p>

<p>natsort — 用“自然排序”算法对数组排序</p>

<p>next — 将数组中的内部指针向前移动一位</p>

<p>pos — current() 的别名</p>

<p>prev — 将数组的内部指针倒回一位</p>

<p>range — 建立一个包含指定范围单元的数组</p>

<p>reset — 将数组的内部指针指向第一个单元</p>

<p>rsort — 对数组逆向排序</p>

<p>shuffle — 将数组打乱</p>

<p>sizeof — count() 的别名</p>

<p>sort — 对数组排序</p>

<p>uasort — 使用用户自定义的比较函数对数组中的值进行排序并保持索引关
联</p>

<p>uksort — 使用用户自定义的比较函数对数组中的键名进行排序</p>

<p>usort — 使用用户自定义的比较函数对数组中的值进行排序</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[简单的mysql基本操作]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/Mysql-base/"/>
    <updated>2016-08-31T18:19:30+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/Mysql-base</id>
    <content type="html"><![CDATA[<h5>简单的mysql基本操作</h5>

<p>mysql 查看默认引擎</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>show variables like 'storage_engine';</span></code></pre></td></tr></table></div></figure>


<p>查看表详细结构语句</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SHOW CREARTE TABLE 表名 \G</span></code></pre></td></tr></table></div></figure>


<p>修改表名</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 旧表名 RENAME (TO) 新表名</span></code></pre></td></tr></table></div></figure>


<p>修改字段的数据类型</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 MODIFY 属性名 数据类型;
</span><span class='line'>
</span><span class='line'>eg：ALTER TABLE user MODIFY name varchar(30);</span></code></pre></td></tr></table></div></figure>


<p>修改字段名(属性名)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 CHANGE 旧属性名 新属性名 新数据类型;</span></code></pre></td></tr></table></div></figure>


<p>增加字段（属性）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE  表名 ADD 属性名1 数据类型【完整性约束条件】[FIRST] AFTER 属性名2</span></code></pre></td></tr></table></div></figure>


<p>删除字段（属性）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 DROP 属性名;</span></code></pre></td></tr></table></div></figure>


<p>修改字段的排列位置</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 MODIFY 属性名1 数据类型 [FIRST] AFTER 属性名2;</span></code></pre></td></tr></table></div></figure>


<p>更改表的存储引擎</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 engine=存储引擎名;</span></code></pre></td></tr></table></div></figure>


<p>删除表的外键约束</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 DROP FOREIGN KEY 外键别名;</span></code></pre></td></tr></table></div></figure>


<p>索引的优点：可以提高检索数据的速度</p>

<p>缺点：创建和维护索引需要耗费时间，占用物理空间，</p>

<p>在已经存在的表创建索引</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREARTE [UNIQUE | FULLTEXT | SPATIAL] INDEX 索引名 ON 表名(属性名[(长度)] [ASC|DESC]);</span></code></pre></td></tr></table></div></figure>


<p>用ALTER TABLE 来创建索引</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ALTER TABLE 表名 ADD [UNIQUE | FULLTEXT | SPATIAL] INDEX 索引名(属性名[(长度)] [ASC|DESC]);</span></code></pre></td></tr></table></div></figure>


<p>删除索引</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DROP INDEX 索引名 ON 表名</span></code></pre></td></tr></table></div></figure>


<p>创建视图的语法</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREARTE [ALGORITHM = { UNDEFINED | MERGE | TEMPTABLE}] VIEW  视图名 [(属性名字)] AS SELECT  语句
</span><span class='line'>
</span><span class='line'>[WITH [CASCADED | LOCAL] CHECK OPTION];</span></code></pre></td></tr></table></div></figure>


<p>查看视图</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DESC 视图名
</span><span class='line'>
</span><span class='line'>SHOW TABLES STATUS 查看视图基本信息
</span><span class='line'>
</span><span class='line'>SHOW TABLES STATUS LIKE ‘视图名’
</span><span class='line'>
</span><span class='line'>SHOW CREARTE VIEW 查看视图详细信息
</span><span class='line'>
</span><span class='line'>SHOW CREARTE VIEW  视图;</span></code></pre></td></tr></table></div></figure>


<p>修改视图</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREARTE OR REPLACE [ALGORITHM = { UNDEFINED | MERGE | TEMPTABLE}] VIEW  视图名 [(属性名字)] AS SELECT  语句
</span><span class='line'>
</span><span class='line'>[WITH [CASCADED | LOCAL] CHECK OPTION];
</span><span class='line'>
</span><span class='line'>ALTER [ALGORITHM = { UNDEFINED | MERGE | TEMPTABLE}] VIEW  视图名 [(属性名字)] AS SELECT  语句
</span><span class='line'>
</span><span class='line'>[WITH [CASCADED | LOCAL] CHECK OPTION];</span></code></pre></td></tr></table></div></figure>


<p>更新视图</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>UPDATE 视图 SET 属性名；</span></code></pre></td></tr></table></div></figure>


<p>删除视图</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DROP VIEW [IF EXISTS] 视图名列表 [RESTRICT|CASCADE]</span></code></pre></td></tr></table></div></figure>


<p>创建只有一种执行语句的触发器的形式如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREARTE TRIGGER 触发器名 BEFORE | AFTER 触发事件 ON 表名
</span><span class='line'>
</span><span class='line'>FOR EACH ROW 执行语句</span></code></pre></td></tr></table></div></figure>


<p>创建有多个执行语句的触发器的形式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREARTE TRIGGER 触发器名 BEFORE | AFTER 触发事件 ON 表名
</span><span class='line'>
</span><span class='line'>FOR EACH ROW
</span><span class='line'>
</span><span class='line'>BEGINE
</span><span class='line'>
</span><span class='line'>执行语句列表
</span><span class='line'>
</span><span class='line'>END</span></code></pre></td></tr></table></div></figure>


<p>查看触发器</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SHOW TRIGGER 触发器名</span></code></pre></td></tr></table></div></figure>


<p>删除触发器</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DROP TRIGGER 触发器名</span></code></pre></td></tr></table></div></figure>


<h4>附加：</h4>

<p>MySQL服务的配置和使用</p>

<p>修改MySQL管理员的口令：mysqladmin –u root password 密码字符串           <br/>
如：mysqldmin –u root password 111111</p>

<p>连接MySQL服务器，使用命令： mysql [-h 主机名或IP地址] [-u 用户名] [-p]    <br/>
如：mysql –u root –p</p>

<p>如已有密码需修改root密码用命令: mysqladmin –u root –p password 新密码字符串<br/>
如：mysqladmin –u root –p password 111111</p>

<p>创建数据库格式为：CREATE DATABASE 数据库名称；
如：mysql>create database abc;    默认创建数据库保存在/var/lib/mysql中</p>

<p>查看数据库是  mysql>show abc;</p>

<p>选择数据库是  USE 数据库名称;  如：mysql>use abc;</p>

<p>删除数据库是  DROP DATABASE 数据库名称； 如：mysql>drop database abc;</p>

<p>数据库的创建和删除</p>

<p>创建表是 CREATE TABLE 表名称(字段1，字段2，…[表级约束]) [TYPE=表类型]；</p>

<p>其中字段(1,2 )格式为:字段名 字段类型 [字段约束]
如创建一个表student，如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql&gt;create table student (
</span><span class='line'>sno varchar(7) not null,   字段不允许为空
</span><span class='line'>sname varchar (20 )not null,
</span><span class='line'>ssex char (1) default ‘t’,
</span><span class='line'>sbirthday date,
</span><span class='line'>sdepa char (20),
</span><span class='line'>primary key (sno)       表的主键
</span><span class='line'>);</span></code></pre></td></tr></table></div></figure>


<p>可用describe命令查看表的结构。</p>

<p>默认表的类型为MYISAM，并在/var/lib/mysql/abc 目录下建立student.frm(表定义文件)，student.MDY(数据文件)，stedent.MYI(索引文件)。</p>

<p>复制表 CREATE TABLE 新表名称 LIKE 原表名称；
如：mysql>create table xtable like student;</p>

<p>删除表 DROP TABLE 表名称1[表名称2…];
如：mysql> drop table xtale;</p>

<p>修改表 ALTER TABLE 表名称 更改动作1[动作2]；
动作有ADD(增加) DROP(删除)CHANGE、MODIFY(更改字段名和类型)RENAME</p>

<p>增加字段：mysql>alter table student add saddress varchar(25);</p>

<p>更改字段名和字段类型： mysql>alter table student change saddress sremark test;</p>

<p>即使不更改字段类型也要给出字段类型如：
mysql>alter table student change saddress sremark varchar (25);</p>

<p>更改字段类型　：mysql> alter table student modify sremark varchar(25);</p>

<p>删除字段：mysql>alter table student drop sremark；
更改表名称： mysql>alter table student rename to xs；</p>

<p>表中数据的插入、删除和修改</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   插入记录： INSERT INTO 表名称（字段名1,字段名2…
</span><span class='line'>               VALUES(字段1的值，字段2的值
</span><span class='line'>   如：mysql&gt;insert into student (sno,sname,ssex,sbirthday,sdepa)
</span><span class='line'>             values(‘0321001’,’Liu Tao’,dagault,19870201,’math’);
</span><span class='line'>   查看表  mysql&gt;select * from student;</span></code></pre></td></tr></table></div></figure>


<p>插入与前面相同的记录，可用insert命令的缩写格式，
如: mysql>insert into student values (‘0321001’, ‘Liu Tao’, default, 19870201, ‘mth’);</p>

<p>如果字段名列表中没有给出表中的某些字段，那么这些字段设置为默认值，
如：mysql>insert into student (sno,sname,sbirthday)
          values(‘0321002’,’Wang Jun’,1870112);</p>

<p>一个单独的insert语句中可使用多个valuse字句，插入多条记录，
如：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql&gt;insert into  student values
</span><span class='line'>         (‘0322001’, ‘Zhang Liaoyun’, ‘f’ 1971102,’computer’),
</span><span class='line'>         (‘0322002’, ‘Li Ming’, ‘t’ 1971105,’computer’);</span></code></pre></td></tr></table></div></figure>


<p>   删除记录： DELETE FROM 表名称 WHERE 条件表达式；
   如：mysql>delete from student where sno=’0321002’;</p>

<p>   删除student表中sno字段值前4位为‘0322’的记录
   如：mysql>delete from student where left (sno,4)=’0322’;</p>

<p>   删除所以记录，可以不带where字句
   如：mysql>delete from student;</p>

<p>   删除所以记录可以用命令truncate     删除表，然后重建表，所以比delete命令快
   如：mysql>truncate table student;</p>

<p>   修改记录 UPDATE 表名称 SET 字段名1=字段值1
            WHERE 条件表达式
   如： mysql>update student set sbirthday=1920113, sdepa=’math’ where sno=’0321002’;</p>

<p>索引的创建与删除</p>

<p>   在创建表的同时创建索引</p>

<p>  创建表时，可用INDEX字句或UNIQUE(字段值必须惟一)字句创建索引
   如：创建课程表course, 课程编号cno字段为主键，课程名称cname字段创建一个名为can的索引</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql&gt;create table course(
</span><span class='line'>cno varchar(5) not null,
</span><span class='line'>cname varchar(30) not null,
</span><span class='line'>teacher varchar(20),
</span><span class='line'>primary key (cno),
</span><span class='line'>index can (cname)
</span><span class='line'>);</span></code></pre></td></tr></table></div></figure>


<p>   向已存在的表添加索引   CREATE [UNIQUE ] INDEX 索引名ON表名称 (字段名1[(长度)])；
   如：mysql>create index sna on student (sname);</p>

<p>对于类型为CHAR和VARCHAR的字段建立索引时还可指定长度值，类型为BLOB和TEXT的字段索引时必须指定长度值。
   如mysql>create index sna on student (sname(10));</p>

<p>删除索引  DROP INDEX 索引 ON表名称；
   如：mysql>drop index sna on student;</p>

<p>用户的创建和删除</p>

<p>初始化时有5个MySQL授权表，其中host、tables_priv和columnts_priv 是空的，表user和db决定了MySQL默认的访问规则。默认有mysql和test两个数据库。</p>

<p>授权表：user  用户从哪些主机可以连接到数据库服务器，以及对所以数据库的访问权限（全局权限）</p>

<pre><code>    db   用户可以使用哪些权限，以及对数据库执行哪些操作（数据库级权限）

    host  当表db 中的host 字段值为空时，用户从哪些主机可以连接到数据库服务器。

    tables_priv  连接的用户可以访问哪些表（表级权限）

    columnts_priv  连接的用户可以访问哪些字段 （字段级权限）
</code></pre>

<p>创建新用户</p>

<p>以MySQL管理员连接到数据库服务器： #mysql –u root –p</p>

<p>创建新用户guess并设置密码，同时可以从任何主机连接数据库服务器：</p>

<p>mysql>insert into mysql.user (host,user,password)
values (‘%’,’gusee’,password(‘guest’));      使用password()函数，密码是加密的</p>

<p>重载MySQL授权表：mysql>flush privileges;
远程客户端连接数据库服务器 ：#mysql –h 192.168.0.50 –u guess –</p>

<p>p      开放服务器的TCP断口3306</p>

<p>查看当前用户可用数据库： show database</p>

<p>删除用户</p>

<p>mysql>delete from mysql.user where user=’guest’;</p>

<p>mysql>flush privileges;      重载MySQL授权表</p>

<p>更改用户密码</p>

<p>如：更改guset密码为123456</p>

<p>mysql>update mysql.user set password=password(‘123456’)
      where user =’guset’;</p>

<p>mysql>flush privileges;</p>

<p>或者是 mysql>set password for guset@’%’=password(‘123456’);</p>

<p>用户权限的设置</p>

<p>   在表user、db和host中，所有字段声明为ENUM(‘N’,’Y’),默认是‘N’;</p>

<p>   在表tables_priv和columns_priv中，权限字段声明为SET类型
   修改授权表中的访问权限有两中方法，一是使用 INSERT、UPDATE和
DELETE等DML语句，</p>

<p>   另一中是GRANT和GRVOKE语句
   使用GRANT语句授权：
   格式如下：</p>

<p>   GRANT 权限列表 [(字段列表)] on 数据库名称.表名称</p>

<p>   TO 用户名@域名或IP地址</p>

<p>   [INDETIFIED BY ‘密码值’] [WITH CRANT OPTION];</p>

<p>   授权哪个用户能连接，从哪连接
   如：授权用户guest从任意主机连接数据库服务器，并具有完全访问数据库abc的权限。</p>

<p>   Mysql>grant all on abc.* to guset@’%’ identified by ‘guest’</p>

<p>   注意几点：如指定用户不存在，则创建该新用户；
             ‘权限列表’处ALL表示授予全部权限，USAGE表不授予任何权限。</p>

<pre><code>         ‘数据库名称.表名称’处可以使用通配符“*”。如“abc.*”表数据库abc中所有表
           ‘用户名@域名或IP地址’设置谁能连，从哪连。用户名 不能用通配符，但可以用‘ ’空字符串，表任何用户；域名或IP地址可以用通配符“%”，使用是用单引号括起来。
</code></pre>

<p>   授权用户不同级别的访问权限
   如：新建用户tom,能从子网192.168.16.0访问数据库服务器，可以读
取数据库xsxk,并能修改表course 中字段teacher的值
   mysql>grant select on xsxd.* to tom@’192.168.16.%’ indentifiend by ‘123456’;</p>

<p>   mysql>grant update(teacher) on xsxd.course to tom@’192.168.16.%’’</p>

<p>   注意几点：数据库名称.表名称 用来设置权限运用的级别，有全局的（<em>.</em>）,指定数据库的（xsxd.*）</p>

<pre><code>         和指定表的（xsxd.student）;

         字段列表 设置权限运用中指定的表中的哪些字段，如update(cname,teacher)

         权限列表 指定的权限与权限运行的级别有关，如有写权限（FILE、PROCESS、RELOAD、SHUTDOWN）作为管理权限用于全局级别；对于字段级别只能指定SELECT、INSERT、UPDATE、REFERENCES
</code></pre>

<p>授予用户管理权限的权利
   如：管理员授予拥护admin可以从本地连接数据库服务器，对数据库
xsxk具有完全访问权限，并可以
       将拥有的权限赋予其他用户</p>

<p>   mysql>grant all on xsxd.* to admin@localhost indentified by ‘123456’ with grant option;
   其中with grant option 子句表示拥护拥有的权限可以赋予其他用户。</p>

<p>   mysql>qrant select on xsxd.student to bill@localhost;  授予bill用户权限</p>

<p>   mysql>show grants for admin@localhost;   查看用户权限</p>

<p>使用REVOKE语句撤权</p>

<p>   格式如下：</p>

<p>   REVOKE 权限列表[(字段列表)] on数据库名称.表名称
   FROM用户名@域名或IP地址
   如：撤消用户admin@localhost 对数据库xsxd的创建、删除数据库及表的权限，不撤消用户赋予其它用户的权限</p>

<p>   mysql>revoke create,drop on xsxd.* from admin@localhost;</p>

<p>   mysql>revoke grant option on xsxd.* from admin@localhost;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于php的正则表达式]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/zhengzebiaodashio/"/>
    <updated>2016-08-31T18:19:28+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/zhengzebiaodashio</id>
    <content type="html"><![CDATA[<p>&ldquo;^[0-9]<em>[1-9][0-9]</em>$"　　 //正整数</p>

<p>&ldquo;^((-\d+)|(0+))$"　　 //非正整数（负整数 + 0）</p>

<p>&ldquo;^-[0-9]<em>[1-9][0-9]</em>$"　　 //负整数</p>

<p>&ldquo;^-?\d+$"　　　　 //整数</p>

<p>&ldquo;^\d+(.\d+)?$"　　 //非负浮点数（正浮点数 + 0）</p>

<p>&ldquo;^(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>))$"　　 //正浮点数</p>

<p>&ldquo;^((-\d+(.\d+)?)|(0+(.0+)?))$&rdquo;//非正浮点数（负浮点数 + 0）
&ldquo;^(-(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>)))$"　　 //负浮点数</p>

<p>&ldquo;^(-?\d+)(.\d+)?$"　　 //浮点数</p>

<p>&ldquo;^[A-Za-z]+$"　　 //由26个英文字母组成的字符串</p>

<p>&ldquo;^[A-Z]+$"　　 //由26个英文字母的大写组成的字符串</p>

<p>&ldquo;^[a-z]+$"　　 //由26个英文字母的小写组成的字符串</p>

<p>&ldquo;^[A-Za-z0-9]+$"　　 //由数字和26个英文字母组成的字符串</p>

<p>&ldquo;^\w+$"　　 //由数字、26个英文字母或者下划线组成的字符串</p>

<p>&ldquo;^[\w-]+(.[\w-]+)*@[\w-]+(.[\w-]+)+$"　　　　//email地址</p>

<p>&ldquo;^[a-zA-z]+://(\w+(-\w+)<em>)(.(\w+(-\w+)</em>))<em>(\?\S</em>)?$&rdquo;//url
/^(d{2}|d{4})-((0([1-9]{1}))|(1[1|2]))-((<a href="[1-9]{1}">0-2</a>)|(3[0|1]))$/ // 年-月-日
/^((0([1-9]{1}))|(1[1|2]))/((<a href="[1-9]{1}">0-2</a>)|(3[0|1]))/(d{2}|d{4})$/ // 月/日/年</p>

<p>&ldquo;^([w-.]+)@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.)|(([w-]+.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?)$&rdquo; //Emil
/^((+?[0-9]{2,4}-[0-9]{3,4}-)|([0-9]{3,4}-))?([0-9]{7,8})(-[0-9]+)?$/ //电话号码</p>

<p>&ldquo;^(d{1,2}|1dd|2[0-4]d|25[0-5]).(d{1,2}|1dd|2[0-4]d|25[0-5]).(d{1,2}|1dd|2[0-4]d|25[0-5]).(d{1,2}|1dd|2[0-4]d|25[0-5])$&rdquo; //IP地址</p>

<p>匹配中文字符的正则表达式： [\u4e00-\u9fa5]</p>

<p>匹配双字节字符(包括汉字在内)：[^\x00-\xff]</p>

<p>匹配空行的正则表达式：\n[\s| ]*\r</p>

<p>匹配HTML标记的正则表达式：/&lt;(.<em>)>.</em>&lt;\/\1>|&lt;(.*) \/>/</p>

<p>匹配首尾空格的正则表达式：(^\s<em>)|(\s</em>$)</p>

<p>匹配Email地址的正则表达式：\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*</p>

<p>匹配网址URL的正则表达式：^[a-zA-z]+://(\w+(-\w+)<em>)(\.(\w+(-\w+)</em>))<em>(\?\S</em>)?$</p>

<p>匹配帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$</p>

<p>匹配国内电话号码：(\d{3}-|\d{4}-)?(\d{8}|\d{7})?</p>

<p>匹配腾讯QQ号：^[1-9]<em>[1-9][0-9]</em>$</p>

<p>利用正则表达式限制网页表单里的文本框输入内容：</p>

<p>用正则表达式限制只能输入中文：onkeyup=&ldquo;value=value.replace(/[^u4E00-u9FA5]/g,&lsquo;&rsquo;)&rdquo; onbeforepaste=&ldquo;clipboardData.setData(&lsquo;text&rsquo;,clipboardData.getData(&lsquo;text&rsquo;).replace(/[^u4E00-u9FA5]/g,&lsquo;&rsquo;))&rdquo;</p>

<p>用正则表达式限制只能输入全角字符：
onkeyup=&ldquo;value=value.replace(/[^uFF00-uFFFF]/g,&lsquo;&rsquo;)&rdquo;</p>

<p>onbeforepaste=&ldquo;clipboardData.setData(&lsquo;text&rsquo;,clipboardData.getData(&lsquo;text&rsquo;).replace(/[^uFF00-uFFFF]/g,&lsquo;&rsquo;))&rdquo;</p>

<p>用正则表达式限制只能输入数字：onkeyup=&ldquo;value=value.replace(/[^d]/g,&lsquo;&rsquo;) "onbeforepaste="clipboardData.setData(&lsquo;text&rsquo;,clipboardData.getData(&lsquo;text&rsquo;).replace(/[^d]/g,&lsquo;&rsquo;))&rdquo;</p>

<p>用正则表达式限制只能输入数字和英文：
onkeyup=&ldquo;value=value.replace(/[W]/g,&lsquo;&rsquo;) "onbeforepaste="clipboardData.setData(&lsquo;text&rsquo;,clipboardData.getData(&lsquo;text&rsquo;).replace(/[^d]/g,&lsquo;&rsquo;))&rdquo;</p>

<p>=========常用正则式</p>

<p>匹配中文字符的正则表达式： [\u4e00-\u9fa5]</p>

<p>匹配双字节字符(包括汉字在内)：[^\x00-\xff]</p>

<p>匹配空行的正则表达式：\n[\s| ]*\r</p>

<p>匹配HTML标记的正则表达式：/&lt;(.<em>)>.</em>&lt;\/\1>|&lt;(.*) \/>/</p>

<p>匹配首尾空格的正则表达式：(^\s<em>)|(\s</em>$)</p>

<p>匹配IP地址的正则表达式：/(\d+).(\d+).(\d+).(\d+)/g //</p>

<p>匹配Email地址的正则表达式：\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*</p>

<p>匹配网址URL的正则表达式：<a href="http://">http://</a>(/[\w-]+.)+[\w-]+(/[\w- ./?%&amp;=]*)?</p>

<p>sql语句：<sup>select|drop|delete|create|update|insert</sup>.*$</p>

<p>非负整数：^\d+$</p>

<p>正整数：^[0-9]<em>[1-9][0-9]</em>$</p>

<p>非正整数：<sup>(-\d+)|(0+)</sup>$</p>

<p>负整数：^-[0-9]<em>[1-9][0-9]</em>$</p>

<p>整数：^-?\d+$</p>

<p>非负浮点数：^\d+(.\d+)?$</p>

<p>正浮点数：<sup>(0-9)+.[0-9]<em>[1-9][0-9]</em></sup>|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>))$</p>

<p>非正浮点数：<sup>(-\d+.\d+)?</sup>|(0+(.0+)?))$</p>

<p>负浮点数：<sup>-((正浮点数正则式))</sup>$</p>

<p>英文字符串：^[A-Za-z]+$</p>

<p>英文大写串：^[A-Z]+$</p>

<p>英文小写串：^[a-z]+$</p>

<p>英文字符数字串：^[A-Za-z0-9]+$</p>

<p>英数字加下划线串：^\w+$</p>

<p>E-mail地址：^[\w-]+(.[\w-]+)<em>@[\w-]+(.[\w-]+)+$
URL：^[a-zA-Z]+://(\w+(-\w+)</em>)(.(\w+(-\w+)<em>))</em>(\?\s<em>)?$ 或：<sup>http</sup>:\/\/[A-Za-z0-9]+.[A-Za-z0-9]+[\/=\?%-&amp;_~`@[]\&lsquo;:+!]</em>([^&lt;>\&ldquo;\&rdquo;])*$</p>

<p>邮政编码：^[1-9]\d{5}$ 中文：^[\u0391-\uFFE5]+$</p>

<p>电话号码：<sup>((\d{2,3}))|(\d{3}-)</sup>?((0\d{2,3})|0\d{2,3}-)?[1-9]\d{6,7}(-\d{1,4})?$</p>

<p>手机号码：<sup>((\d{2,3}))|(\d{3}-)</sup>?13\d{9}$</p>

<p>双字节字符(包括汉字在内)：^\x00-\xff</p>

<p>匹配首尾空格：(^\s<em>)|(\s</em>$)（像vbscript那样的trim函数）</p>

<p>匹配HTML标记：&lt;(.<em>)>.</em>&lt;\/\1>|&lt;(.*) \/></p>

<p>匹配空行：\n[\s| ]*\r</p>

<p>提取信息中的网络链接：(h|H)(r|R)(e|E)(f|F) <em>= </em>(&lsquo;|&ldquo;)?(\w|\|\/|.)+(&rsquo;|&rdquo;| *|>)?</p>

<p>提取信息中的邮件地址：\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*</p>

<p>提取信息中的图片链接：(s|S)(r|R)(c|C) <em>= </em>(&lsquo;|&ldquo;)?(\w|\|\/|.)
+(&rsquo;|&rdquo;| *|>)?</p>

<p>提取信息中的IP地址：(\d+).(\d+).(\d+).(\d+)</p>

<p>提取信息中的中国手机号码：(86)<em>0</em>13\d{9}</p>

<p>提取信息中的中国固定电话号码：((\d{3,4})|\d{3,4}-|\s)?\d{8}</p>

<p>提取信息中的中国电话号码（包括移动和固定电话):((\d{3,4})|\d{3,4}-|\s)?\d{7,14}</p>

<p>提取信息中的中国邮政编码：[1-9]{1}(\d+){5}</p>

<p>提取信息中的浮点数（即小数):(-?\d*).?\d+</p>

<p>提取信息中的任何数字:(-?\d*)(.\d+)? IP：(\d+).(\d+).(\d+).(\d+)</p>

<p>电话区号：/^0\d{2,3}$/</p>

<p>腾讯QQ号：^[1-9]<em>[1-9][0-9]</em>$</p>

<p>帐号(字母开头，允许5-16字节，允许字母数字下划线)：
^[a-zA-Z][a-zA-Z0-9_]{4,15}$</p>

<p>中文、英文、数字及下划线：^[\u4e00-\u9fa5_a-zA-Z0-9]+$</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[【转】php的数组各种用法（下）]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/php-arrays2/"/>
    <updated>2016-08-31T18:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/php-arrays2</id>
    <content type="html"><![CDATA[<h5>3.1 什么是数组</h5>

<p>一个标量变量就是一个用来存储数值的命名区域。同样，一个数组就是一个用来存储一系列变量值的命名区域，因此，可以使用数组组织标量变量。
存储在数组中的值称为数组元素。每个数组元素有一个相关的索引（也称为关键字），它可以用来访问元素。在大多数编程语言中，数组都具有数字索引，而且这些索个通常是从0或1开始的。</p>

<h5>3.2 数字索引数组</h5>

<p>在PHP中，数字索引的默认值是从0开始的，当然也可以改变它。</p>

<p>3.2.1 数字索引数组的初始化</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$porducts = array( 'Tires', 'Oil', 'Spark Plugs' );</span></code></pre></td></tr></table></div></figure>


<p>就像echo语句一样，array()实际上是一个语言结构，而不是一个函数。
根据对数组内容的需求不同，可能不需要再像以上例子一样对它们进行手工的初始化操作。如果所需数据保存在另一个数组中，可以使用运算符“=”简单地将数组复制到另一个数组。</p>

<p>如果需要将按升序排列的数字保存在一个数组中，可以使用range()函数自动创建这个数组。如下这行代码将创建一个从1到10的数字数组：$numbers = range(1,10);</p>

<p>range()函数具有一个可选的第三个参数，这个参数允许设定值之间的步骤。例如，如需建立一个1到10之间的奇数数组，可以使用如下代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$odds = range(1,10,2);</span></code></pre></td></tr></table></div></figure>


<p>range()函数也可以对字符进行操作，如：$letters = range(&lsquo;a&rsquo;, &lsquo;z&rsquo;);</p>

<p>3.2.2 访问数组的内容
要访问一个变量的内容，可以直接使用其名称。如果该变量是一个数组，可以使用变量名称和关键字或索引的组合来访问其内容。关键字或索引将指定</p>

<p>我们要访问的变量。索引在变量名称后面用方括号括起来。</p>

<p>在默认的情况下，0元素是数组的第一个元素。
请注意，虽然PHP的字符串解析功能非常强大和智能，但是可能会引起混淆。当你将数组或其他变量嵌入双引号中的字符串时，如果不能正确解释它们，可以将它们放置在双引号之外，或者查找第4章的“字符串操作与正则表达式”获得更复杂的语法。</p>

<p>就像PHP的其他变量一样，数组不需要预先初始化或创建。在第一次使用它们的时候，它们会自动创建。</p>

<p>3.2.3. 使用循环访问数组
由于数组使用有序的数字作为索引，所以使用一个for循环就可以很容易地显示数组的内容。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for ($i=0; $i&lt;3; $i++)
</span><span class='line'>echo "$products[$i]";</span></code></pre></td></tr></table></div></figure>


<p>使用一个简单的循环就可以访问每个元素是数字索引数组的一个非常好的特性。也可以使用foreach循环，这个循环语句是专门为数组而设计的。如：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>foreach ($products as $current)
</span><span class='line'>echo $current. ' ';</span></code></pre></td></tr></table></div></figure>


<h5>3.3 使用不同索引的数组</h5>

<p>PHP还支持相关数组。在相关数组中，可以将每个变量值与任何关键字或索引关联起来。</p>

<p>3.3.1 初始化相关数组
如下所示的代码可以创建一个以产品名称作为关键字、以价格作为值的相关数组：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$prices = array( 'Tires'=&gt;100, 'Oil'=&gt;10, 'Spark Plugs'=&gt;4 );</span></code></pre></td></tr></table></div></figure>


<p>关键字和值之间的符号只是一个大于号与等于符号。</p>

<p>3.3.2 访问数组元素
同样，可以使用变量名称和关键字来访问数组的内容。例如$prices[&lsquo;Tires&rsquo;]。</p>

<p>3.3.3 使用循环语句
因为相关数组的索引不是数字，因此无法在for循环语句中使用一个简单的计数器对数组进行操作。但是可以使用foreach循环或list()和each()结构。</p>

<p>当使用foreach循环语句对相关数组进行操作时，foreach()循环具有不同的结构。可以按如下方式使用关键字：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>foreach ($prices as $key =&gt; $value)
</span><span class='line'>echo $key.'=&gt;'.$value.'&lt;br /&gt;';</span></code></pre></td></tr></table></div></figure>


<p>如下所示的代码将使用each()结构打印$prices数组的内容：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>while( $element = each($prices))
</span><span class='line'>{
</span><span class='line'>echo $element['key'];
</span><span class='line'>echo ' - ';
</span><span class='line'>echo $element['value'];
</span><span class='line'>echo '&lt;br /&gt;';
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>each()函数将返回数组的当前元素，并将下一个元素作为当前元素。因为在while循环中调用each()函数，它将按顺序返回数组中每个元素，并且当它到达数组末尾时，循环操作将终止。</p>

<p>在 这段代码中，变量$element是一个数组。当调用each()时，它将返回一个带有4个数值和4个指向数组位置的索引的数组。位置key和0包含了当 前元素的关键字，而位置value和1包含了当前元素的值。虽然这与选哪一种方法没什么不同，但我们选择了使用命名位置，而不是数字索引位置。
此外，还有一种更为高级和常见的方式来完成相同的操作。函数list()可以用来将一个数组分解为一系列的值。可以按照如下方式将函数each()返回的两个值分开：list( $product, $price) = each( $price);</p>

<p>以上代码使用each()从$prices数组中取出当前元素，并且将它作为数组返回，然后再指向下一个元素。它还使用list()将从each()返回的数组中所包含0、1两个元素变为两个名为$product和$price的新蛮量。
我们可以循环遍历整个$prices数组，使用如下所示的简短脚本显示它的内容：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>while(list($prodct, $pirce) = each($prices))
</span><span class='line'>echo "$product - $price&lt;br /&gt;";</span></code></pre></td></tr></table></div></figure>


<p>这段代码的输出结果与前面脚本的输出结果相同，但它更容易阅读，因为list()允许为新变量命名。</p>

<p>需要注意的一点是，当使用each()函数时，数组将记录当前元素。如果希望在相同的脚本中两次使用该数组，就必须使用函数reset()将当前元素重新设置到数组开始处。要再次遍历prices数组，可以使用如下所示的代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reset($prices);
</span><span class='line'>while(list($product, $price) = each($prices))
</span><span class='line'>echo "$product - $price&lt;br /&gt;";</span></code></pre></td></tr></table></div></figure>


<h5>3.4 数组操作符</h5>

<p>+联合，==等价，===恒等，!=不等价，&lt;>不等价，!==不恒等。
联合操作符尝试将$b中的元素添加到$a的末尾。如果$b中的元素与$a中的一些元素具有相同的索引，它们将不会被添加。即$a中的元素将不会被覆盖。</p>

<h5>3.5 多维数组</h5>

<p>数组不一定就是一个关键字和值的简单列表——数组中的每个位置还可以保存另一个数组。使用这种方法，可以创建一个二维数组。可以把二维数组当成一个矩阵，或者是一个具有宽度和高度或者行和列的网络。</p>

<h5>3.6 数组排序</h5>

<p>3.6.1 使用sort()函数
sort()函数是区分字母大小写的。所有的大家字母都在小写字母的前面。所以‘A’小于‘Z’，而'Z'小于‘a’。</p>

<p>该函数的第二个参数是可选的。这个可选参数可以传递SORT_REGULAR（默认值）、SORT_NUMERIC或SORT_STRING。指定排序类型 的功能是非常有用的，例如，当要比较可能包含有数字2和12的字符串时。从数学角度看，2要小于12，但是作为字符串，‘12’却要小于‘2’。</p>

<p>3.6.2 使用asort()函数和ksort()函数对相关数组排序
函数asort()根据数组的每个元素值进行排序。ksort()函数是按关键字排序而不是按值排序。</p>

<p>3.6.3 反向排序
函数rsort()将一个一维数字索引数组按降序排序。函数arsort()将一个一维相关数组按每个元素值的降序排序。函数krsort()针根据数组元素的关键字将一维数组按照降序排序。</p>

<p>为了访问一个一维数组中的数据，需要使用数组的名称和元素的索引，除了一个元素具有两个索引——行和列外，二维数组和一维数组是类似的。
可以使用双重for循环来实现同样的效果：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for ( $row=0; $row&lt;3; $row++ )
</span><span class='line'>{
</span><span class='line'>for ( $column=0; $column&lt;3; $column++ )
</span><span class='line'>{
</span><span class='line'>echo '|'.$products[$row][$column];
</span><span class='line'>|
</span><span class='line'>echo '|&lt;br /&gt;';
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>如果对一个大数组使用这种代码，那么将简洁得多。
你可能更喜欢创建列名称来代替数字。可以使用如下代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$products = array ( array ( 'Code'=&gt;'TIR', 'Descrīption'=&gt;'Tires', 'Price'=&gt;100 ), array ( 'Code'=&gt;'OIL', 'Descrīption'=&gt;'Oil', 'Price'=&gt;10 ), array ( 'Code'=&gt;'SPK', 'Descrīption'=&gt;'Spark Plugs', 'Price'=&gt;4 ) };</span></code></pre></td></tr></table></div></figure>


<p>如果希望检索单个值，那么使用这个数组会容易得多。请记住，将所描述的内容保存到用它的名 称命名的列中，与将其保存到所谓的第一列中相比，前者更容易记忆。使用描述性索引，不需要记住某个元素是存放在[x][y]位置的。使用一对有意义的行和 列的名称作为索引可以使用你很容易找到所需的数据。</p>

<p>然后，我们却不能使用一个简单的for循环按顺序遍历每一列。可以使用for循环遍历外部的数 字索引数组$products。$products数组的每一行都是一个具有描述性索引的数组。在while循环中使用each()和list()函数， 可以遍历整个内部数组。因此，需要一个内嵌有while循环的for循环。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for ( $row = 0; $row &lt; 3; $row++ }
</span><span class='line'>{
</span><span class='line'>while ( list ( $key, $value ) = each ( $products[$row] ) )
</span><span class='line'>{
</span><span class='line'>echo "|$value";
</span><span class='line'>}
</span><span class='line'>echo '|&lt;br /&gt;';
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>三维数组具有高、宽、深的概念。如果能轻松地将一个二维数组想像成一个有行和列的表格，那么就可以将三维数组想像成一堆像这样的表格。每个元素可以通过层、行和列进行引用。</p>

<p>根据创建多维数组的方法，可以创建四维、五维或六维数组。在PHP中，并没有设置数组维数的限制，但人们很难设想一个多于三维的数组。大多数的实际问题在逻辑上只需要使用三维或者更少维的数组结构就可以了。</p>

<h5>3.7 多维数组的排序</h5>

<p>对 多于一维的数组进行排序，或者不按字母和数字的顺序进行排，要复杂得多。PHP知道如何比较两个数字或字符串，但在多维数组中，每个元素都是一个数组。 PHP不知道如何比较两个数组，所以需要建立一个比较它们的方法。在大多数情况下，单词和数字的顺序是显而易见的——但对于复杂的对象，问题就会多一些。</p>

<p>3.7.1 用户定义排序
usort()中的“u”代表“user”，因为这个函数要求传入用户定义的比较函数。asort和ksort对应的版本uasort()和uksort()也要求传入用户定义的比较函数。</p>

<p>类似于asort()，当对非数字索引数组的值进行排序时，uasort()才会被使用。如果值是简单的数字或文本则可以使用asort。如果要比较的值像数组一样复杂，可以定义一个比较函数，然后使用uasort()。</p>

<p>类似于ksort()，当对非数字索引数组的关键字进行排序时才使用uksort()。如果值是简单的数字或文本就使用ksort。如果要比较的对象像数组一样复杂，可以定义一个比较函数，然后使用uksort()。</p>

<p>3.7.2 反向用户排序
函数sort()、asort()和ksort()都分别对应一个带字母“r”的反向排序函数。用户定义的排序没有反向变体，但可以对一个多维数组进行反向排序。</p>

<h5>3.8 对数组进行重新排序</h5>

<p>3.8.1 使用shuffle()函数
在PHP的早期版本中，shuffle()要求调用srand()函数时首先提供一个随机数生成器。如今，这个步骤已经不再需要了。</p>

<p>如果这个函数对你非常重要，可以在程序中应用该函数之前在服务器上测试它。</p>

<p>由于并不需要真正重新排序整个数组，使用array_rand()函数可以实现相同的功能。</p>

<p>3.8.2 使用array_reverse()函数
array_reverse()函数使用一个数组作参数，返回一个内容与参数数组相同但顺序相反的数组。</p>

<p>因为单独使用range()函数将创建一个升序序列，所以必须使用sort()函数或array_reverse()函数将数组中的数字变为降序。或者，也可以使用for循环通过一次一个元素的方式创建这个数组。如：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$numbers = array();
</span><span class='line'>for ($i=10; $i&gt;0; $i--)
</span><span class='line'>array_push( $numbers, $i );</span></code></pre></td></tr></table></div></figure>


<p>一个for循环可以像这样按降序方式运行。可以将计数器</p>

<p>一个for循环可以像这样按降序方式运行。可以将计数器的初始值设为一个大数，在每次循环末尾使用运算符“&ndash;”将计数器减1。</p>

<p>在这里，我们创建了一个空数组，然后使用array_push()函数将每个新元素添加到数组的末尾。请注意，和array_push()相反的函数是array_pop()，这个函数用来删除并返回数组末尾的一个元素。</p>

<p>或者，也可以使用array_reverse()函数将由range()函数所创建的数组进行反向排序。</p>

<p>请注意，array_reverse()函数将返回一个原数组修改后的副本。如果不再需要原来的数组，比如在这个例子中，可以用新的副本覆盖原来的版本。
如果数据只是一系列的整数，可以通过将-1作为range()函数的第三个可选调参数，以相反的顺序创建该数组。</p>

<h5>3.9 从文件载入数组</h5>

<p>使用file()函数将整个文件载入一个数组中。文件中的每行则成为数组中的一个元素。使用了count()函数来统计数组中的元素个数。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>explode("\t", $orders[$i])</span></code></pre></td></tr></table></div></figure>


<p>explode()函数可以将传入的字符串分割成一个个小块。每个制表符成为两个元素之间的断点。这个函数的可选参数limit可以用来限制被返回的最大块数。</p>

<p>可以使用许多方法从字符串中提取数字。在这里，我们使用了intval()函数。它可以将一个字符串转化成一个整数。这个转换是相当智能化的，它可以忽略某些部分，例如标签就不能转换成数字。</p>

<h5>3.10 执行其他的数组操作</h5>

<p>3.10.1 在数组中浏览：each()、current()、reset()、end()、next()、pos()和prev()</p>

<p>前面已经提到，每个数组都有一个内部指针指向数组中的当前元素。当使用函数each()时，就间接地使用了这个指针，但是也可以直接使用和操作这个指针。</p>

<p>如果创建一个新数组，那么当前指针就将被初始化，并指向数组的第一个元素。</p>

<p>调用next()或each()将使指针前移一个元素。调用each($array_name)会在指针前移一个位置之前返回当前元素。next()函数则有些不同——调用next($array_name)是将指针前移，然后再返回新的当前元素。</p>

<p>调用end($array_name)可以将指针移到数组末尾。</p>

<p>要反向遍历一个数组，可以使用end()和prev()函数。prev()函数和next()函数相反。它是将当前指针往回移一个位置然后再返回新的当前元素。</p>

<p>3.10.2 对数组的每一个元素应用任何函数：array_walk()
array_walk()函数需要三个参数。第一个是arr，也就是需要处理的数组。第二个是func，也就是用户自定义并将作用于数组中每个元素的函数。第三个参数userdata是可选的，如果使用它，它可以作为一个参数传递给我们自己的函数。</p>

<p>看一个销微复杂点的例子：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function my_multiply(&$value, $key, $factor)
</span><span class='line'>{
</span><span class='line'>$value *= $factor;
</span><span class='line'>}
</span><span class='line'>array_walk(&$array, 'my_multiply', 3);</span></code></pre></td></tr></table></div></figure>


<p>在这里，我们定义了一个名为my_multiply()的函数，它可以用所提供的乘法因子去乘以数组中的每个元素。</p>

<p>此外，还有一个需要注意的问题是传递毵数$value的方式。在my_multiply()的函数定义中，变量前面的地址符（&amp;）意味着$value是按引用方式传递的。按引用方式传递允许函数修改数组的内容。</p>

<p>3.10.3 统计数组元素个数：count()、sizeof()
和array_count_values()</p>

<p>count()函数和sizeof()函数具有同样的用途，都可以返回数组元素的个数。可以得到一个常规标量变量中的元素个数，如果传递给这个函数的数组是一个空数组，或者是一个没有经过设定的变量，返回的数组个数就是0。
如 果调用array_count_values($array)，这个函数将会统计每个特定的值在数组$array中出现过的次数（这就是数组的基数集）。 这个函数将返回一个包含频率表的相关数组。这个数组包含数组$array中的所有值，并以这些值作为相关数组的关键字。每个关键字所对应的数值就是关键字 在数组$array中出现的次数。</p>

<p>3.10.4 将数组转换成标量变量：extract()
对于一个非数字索引数组，而该数组又有许多关键字-值对，可以使用函数extract()将它们转换成一系列的标量变量。</p>

<p>函数extract()的作用是通过一个数组创建一系列的标量变量，这些变量的名称必须是数组中关键字的名称，而变量值则是数组中的值。</p>

<p>extract()函数具有两个可选参数：extract_type和prefix。变量extract_type将告诉extract()函数如何处理冲突。有时可能已经存在一个和数组关键字同名的变量，该函数的默认操作是覆盖已有的变量。
两个最常用的选项是EXTR_OVERWRITE（默认值）和EXTR_PREFIX_ALL。当知道会发生特定的冲突并且希望跳过该关键字或要给它加上前缀时，可能会用到其他选项。</p>

<p>extract()可以提取出一个元素，该元素的关键字必须是一个有效的变量名称，这就意味着以数字开始或包含空格的关键字将被跳过。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[linux下thinkphp的Nginx配置文件]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/Nginx-thinkphp/"/>
    <updated>2016-08-31T18:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/Nginx-thinkphp</id>
    <content type="html"><![CDATA[<h5>linux下thinkphp的Nginx配置文件(亲测有效)</h5>

<p>一个配置文件，完美支持普通,兼容,pathinfo,rewrite4种url模式，常见的静态文件404时也不会再去跑一遍fastcgi浪费资源。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>server {
</span><span class='line'>    listen       80;
</span><span class='line'>    server_name  thinkphp.lo;
</span><span class='line'>    root /var/www;
</span><span class='line'>    index  index.html index.htm index.php;
</span><span class='line'>
</span><span class='line'>    error_page  404              /404.html;
</span><span class='line'>    location = /404.html {
</span><span class='line'>        return 404 'Sorry, File not Found!';
</span><span class='line'>    }
</span><span class='line'>    error_page  500 502 503 504  /50x.html;
</span><span class='line'>    location = /50x.html {
</span><span class='line'>        root   /usr/share/nginx/html; # windows用户替换这个目录
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location / {
</span><span class='line'>        try_files $uri @rewrite;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location @rewrite {
</span><span class='line'>        set $static 0;
</span><span class='line'>        if  ($uri ~ \.(css|js|jpg|jpeg|png|gif|ico|woff|eot|svg|css\.map|min\.map)$) {
</span><span class='line'>            set $static 1;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        if ($static = 0) {
</span><span class='line'>            rewrite ^/(.*)$ /index.php?s=/$1;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location ~ /Uploads/.*\.php$ {
</span><span class='line'>        deny all;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location ~ \.php/ {
</span><span class='line'>       if ($request_uri ~ ^(.+\.php)(/.+?)($|\?)) { }
</span><span class='line'>       fastcgi_pass 127.0.0.1:9000;
</span><span class='line'>       include fastcgi_params;
</span><span class='line'>       fastcgi_param SCRIPT_NAME     $1;
</span><span class='line'>       fastcgi_param PATH_INFO       $2;
</span><span class='line'>       fastcgi_param SCRIPT_FILENAME $document_root$1;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location ~ \.php$ {
</span><span class='line'>        fastcgi_pass 127.0.0.1:9000;
</span><span class='line'>        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
</span><span class='line'>        include fastcgi_params;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location ~ /\.ht {
</span><span class='line'>        deny  all;
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在Centos6.5下搭建LNMP的方法]]></title>
    <link href="http://hunter222.github.io/blog/2016/08/31/centos-LNMP/"/>
    <updated>2016-08-31T17:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/08/31/centos-LNMP</id>
    <content type="html"><![CDATA[<h5>在Centos6.5下搭建LNMP的方法</h5>

<p>1：查看环境</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@10-4-14-168 html]# cat /etc/redhat-release
</span><span class='line'>CentOS release 6.5 (Final)</span></code></pre></td></tr></table></div></figure>


<p>2：关掉防火墙</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@10-4-14-168 html]# chkconfig iptables off</span></code></pre></td></tr></table></div></figure>


<p>3：配置CentOS 6.0 第三方yum源（CentOS默认的标准源里没有nginx软件包）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#wget http://www.atomicorp.com/installers/atomic
</span><span class='line'>#sh ./atomic
</span><span class='line'>#yum check-update</span></code></pre></td></tr></table></div></figure>


<p>4：安装开发包和库文件　(安装下面四个)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#yum -y install ntp make openssl openssl-devel pcre pcre-devel libpng
</span><span class='line'>
</span><span class='line'>libpng-devel libjpeg-6b libjpeg-devel-6b freetype freetype-devel gd gd-devel zlib zlib-devel
</span><span class='line'>
</span><span class='line'>gcc gcc-c++ libXpm libXpm-devel ncurses ncurses-devel libmcrypt libmcrypt-devel libxml2
</span><span class='line'>
</span><span class='line'>libxml2-devel imake autoconf automake screen sysstat compat-libstdc++-33 curl curl-devel</span></code></pre></td></tr></table></div></figure>


<p>5：卸载已安装的apache、mysql、php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># yum remove httpd
</span><span class='line'># yum remove mysql
</span><span class='line'># yum remove php</span></code></pre></td></tr></table></div></figure>


<p>6：安装nginx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># yum install nginx
</span><span class='line'># service nginx start
</span><span class='line'># chkconfig --levels 235 nginx on
</span><span class='line'>//设2、3、5级别开机启动</span></code></pre></td></tr></table></div></figure>


<p>7：安装mysql</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># yum install mysql mysql-server mysql-devel
</span><span class='line'># service mysqld start
</span><span class='line'># chkconfig --levels 235 mysqld on
</span><span class='line'>登陆MySQL删除空用户，修改root密码
</span><span class='line'>mysql&gt;select user,host,password from mysql.user;
</span><span class='line'> 
</span><span class='line'>mysql&gt;drop user ''@localhost;
</span><span class='line'> 
</span><span class='line'>mysql&gt;update mysql.user set password = PASSWORD('*********') where user='root';
</span><span class='line'> 
</span><span class='line'>mysql&gt;flush privileges;</span></code></pre></td></tr></table></div></figure>


<p>8：安装php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># yum install php lighttpd-fastcgi php-cli php-mysql php-gd php-imap php-ldap
</span><span class='line'>php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-mssql php-snmp php-soap
</span><span class='line'>//安装php和所需组件使PHP支持MySQL、FastCGI模式
</span><span class='line'>#yum install  php-tidy php-common php-devel php-fpm php-mysql
</span><span class='line'>
</span><span class='line'># service php-fpm start
</span><span class='line'># chkconfig --levels 235 php-fpm on</span></code></pre></td></tr></table></div></figure>


<p>9：配置nginx支持php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mv /etc/nginx/nginx.conf /etc/nginx/nginx.confbak
</span><span class='line'>//将配置文件改为备份文件
</span><span class='line'> 
</span><span class='line'># cp /etc/nginx/nginx.conf.default /etc/nginx/nginx.conf
</span><span class='line'>//由于原配置文件要自己去写因此可以使用默认的配置文件作为配置文件
</span><span class='line'> 
</span><span class='line'>//修改nginx配置文件，添加fastcgi支持
</span><span class='line'># vi /etc/nginx/nginx.conf
</span><span class='line'>index index.php index.html index.htm;
</span><span class='line'>//加入index.php
</span><span class='line'> 
</span><span class='line'>location ~ \.php$ {
</span><span class='line'>            root           /usr/share/nginx/html;
</span><span class='line'>            fastcgi_pass   127.0.0.1:9000;
</span><span class='line'>            fastcgi_index  index.php;
</span><span class='line'>            fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html$fastcgi_script_name;
</span><span class='line'>            include        fastcgi_params;
</span><span class='line'>        }
</span><span class='line'>//将以上代码注释去掉，并修改成nginx默认路径</span></code></pre></td></tr></table></div></figure>


<p>10：配置php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//编辑文件php.ini，在文件末尾添加cgi.fix_pathinfo = 1
</span><span class='line'>[root@CentOS ~]# vi /etc/php.ini</span></code></pre></td></tr></table></div></figure>


<p>11：重启nginx php-fpm</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># service nginx restart
</span><span class='line'># service php-fpm restart</span></code></pre></td></tr></table></div></figure>


<p>　　
12：建立info.php文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vi /usr/share/nginx/html/info.php
</span><span class='line'>&lt;?php
</span><span class='line'>   phpinfo();
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<p>13：测试nginx是否解析php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>本地浏览器输入：192.168.12.103/info.php
</span><span class='line'>显示php界面  环境搭建成功</span></code></pre></td></tr></table></div></figure>


<p>注：原文参考：<a href="http://www.cnblogs.com/xiaoit/p/3991037.html">http://www.cnblogs.com/xiaoit/p/3991037.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ajax对xml接收]]></title>
    <link href="http://hunter222.github.io/blog/2016/07/27/ajax-xml/"/>
    <updated>2016-07-27T17:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/07/27/ajax-xml</id>
    <content type="html"><![CDATA[<h5>ajax负责请求xml和接收xml信息，dom负责处理xml信息</h5>

<p>效果：
<img src="http://ww2.sinaimg.cn/mw690/710059dfgw1f7c5fj7vwgj20h307ign8.jpg" alt="haha" /></p>

<p>代码如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>    &lt;head&gt;
</span><span class='line'>        &lt;title&gt;新建网页&lt;/title&gt;
</span><span class='line'>        &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
</span><span class='line'>        &lt;meta name="description" content="" /&gt;
</span><span class='line'>        &lt;meta name="keywords" content="" /&gt;
</span><span class='line'>        &lt;script type="text/javascript"&gt;
</span><span class='line'>        function f1(){
</span><span class='line'>            var xhr = new XMLHttpRequest();
</span><span class='line'>            xhr.onreadystatechange = function(){
</span><span class='line'>                if(xhr.readyState==4){    
</span><span class='line'>                    var xmldom = xhr.responseXML;//这里有点不同
</span><span class='line'>                    var std = xmldom.getElementsByTagName('student');                 
</span><span class='line'>                    var s = "";
</span><span class='line'>                    for(var i=0; i&lt;std.length; i++){
</span><span class='line'>                        var nm = std[i].getElementsByTagName('name')[0].innerHTML;
</span><span class='line'>                        var age = std[i].getElementsByTagName('age')[0].firstChild.wholeText;
</span><span class='line'>                        var addr = std[i].getElementsByTagName('addr')[0].innerHTML;                       
</span><span class='line'>                        s += "名称："+nm+"--年龄："+age+"--地址："+addr+"&lt;br /&gt;";
</span><span class='line'>                    }
</span><span class='line'>                    document.body.innerHTML += s;
</span><span class='line'>                }
</span><span class='line'>            }
</span><span class='line'>            xhr.open('get','./stu.xml');
</span><span class='line'>            xhr.send(null);
</span><span class='line'>        }
</span><span class='line'>        &lt;/script&gt;
</span><span class='line'>    &lt;/head&gt;
</span><span class='line'>    &lt;body&gt;
</span><span class='line'>        &lt;h2&gt;ajax+javascript实现对xml处理&lt;/h2&gt;
</span><span class='line'>        &lt;input type="button" value="处理" onclick="f1()" /&gt;
</span><span class='line'>    &lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>xml代码（stu.xml）：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="utf-8" ?&gt;
</span><span class='line'>&lt;students&gt;
</span><span class='line'>  &lt;student&gt;
</span><span class='line'>      &lt;name&gt;张三&lt;/name&gt;
</span><span class='line'>      &lt;age&gt;22&lt;/age&gt;
</span><span class='line'>      &lt;addr&gt;河北&lt;/addr&gt;
</span><span class='line'>  &lt;/student&gt;
</span><span class='line'>  &lt;student&gt;
</span><span class='line'>      &lt;name&gt;苏您退&lt;/name&gt;
</span><span class='line'>      &lt;age&gt;21&lt;/age&gt;
</span><span class='line'>      &lt;addr&gt;河南&lt;/addr&gt;
</span><span class='line'>  &lt;/student&gt;
</span><span class='line'>  &lt;student&gt;
</span><span class='line'>      &lt;name&gt;李阳&lt;/name&gt;
</span><span class='line'>      &lt;age&gt;44&lt;/age&gt;
</span><span class='line'>      &lt;addr&gt;山东&lt;/addr&gt;
</span><span class='line'>  &lt;/student&gt;
</span><span class='line'>&lt;/students&gt;</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ajax的无刷新分页显示]]></title>
    <link href="http://hunter222.github.io/blog/2016/07/27/ajax-page/"/>
    <updated>2016-07-27T17:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/07/27/ajax-page</id>
    <content type="html"><![CDATA[<h5>1.具体实现</h5>

<p>记录总条数</p>

<p>每页显示条数</p>

<p>总页数：向上取整(总条数/每页显示条数)</p>

<p>limit  偏移量((当前页码-1)*每页条数),长度;</p>

<p><a href="http://%E7%BD%91%E5%9D%80/data.php?page=1">http://%E7%BD%91%E5%9D%80/data.php?page=1</a>  (limit 0,7)</p>

<p><a href="http://%E7%BD%91%E5%9D%80/data.php?page=2">http://%E7%BD%91%E5%9D%80/data.php?page=2</a>  (limit 7,7)</p>

<p><a href="http://%E7%BD%91%E5%9D%80/data.php?page=3">http://%E7%BD%91%E5%9D%80/data.php?page=3</a>  (limit 14,7)</p>

<p>ajax对象.open(‘get’,地址<a href="http://%E7%BD%91%E5%9D%80/data.php?page=2">http://%E7%BD%91%E5%9D%80/data.php?page=2</a>);</p>

<p>利用ajax无刷新方式获得第2页信息</p>

<h5>效果图：</h5>

<p><img src="http://ww2.sinaimg.cn/mw690/710059dfgw1f7c5fijiy3j20t40c7gpy.jpg" alt="photo" /></p>

<h5>2.代码</h5>

<p>分页代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>//传统分页效果实现
</span><span class='line'>//连接数据库，获得数据，做分页显示
</span><span class='line'>header("content-type:text/html;charset=utf-8");
</span><span class='line'>$link = mysqli_connect('localhost','root','123456','shop');
</span><span class='line'>//mysqli_select_db('shop', $link);
</span><span class='line'>mysqli_query($link, 'set names utf8');
</span><span class='line'>echo &lt;&lt;&lt;eof
</span><span class='line'>    &lt;style type="text/css"&gt;
</span><span class='line'>        table {width:700px; border:1px solid black; margin:auto; border-collapse:collapse;}
</span><span class='line'>        td {border:1px solid black; }
</span><span class='line'>    &lt;/style&gt;
</span><span class='line'>    &lt;table&gt;
</span><span class='line'>        &lt;tr style='font-weight:bold'&gt;&lt;td&gt;序号&lt;/td&gt;&lt;td&gt;名称&lt;/td&gt;&lt;td&gt;价格&lt;/td&gt;&lt;td&gt;数量&lt;/td&gt;&lt;td&gt;重量&lt;/td&gt;&lt;/tr&gt;
</span><span class='line'>eof;
</span><span class='line'>//① 引入分页类
</span><span class='line'>include "./page.class.php";
</span><span class='line'>//② 获得总条数、每页显示条数
</span><span class='line'>$sql = "select * from sw_goods";
</span><span class='line'>$qry = mysqli_query($link,$sql);
</span><span class='line'>$total = mysqli_num_rows($qry); //总条数
</span><span class='line'>$per = 7;//每页条数
</span><span class='line'>//③ 实例化分页类对象
</span><span class='line'>$page = new Page($total, $per);
</span><span class='line'>//④ 设置sql语句获得每页信息
</span><span class='line'>//$page-&gt;limit:分页类会根据当前页码参数自动把 "limit 偏移量,长度" 信息给拼装好
</span><span class='line'>$sql3 = "select * from sw_goods order by goods_id ".$page-&gt;limit;
</span><span class='line'>$qry3 = mysqli_query($link,$sql3);
</span><span class='line'>//⑤ 获得页码列表信息
</span><span class='line'>$page_list = $page -&gt; fpage(array(3,4,5,6,7,8));
</span><span class='line'>$page_num = isset($_GET['page'])?$_GET['page']:1;
</span><span class='line'>$num = ($page_num-1)*$per+1;
</span><span class='line'>while($rst3 = mysqli_fetch_assoc($qry3)){
</span><span class='line'>    printf("&lt;tr&gt;");
</span><span class='line'>    printf("&lt;td&gt;%d&lt;/td&gt;",$num);
</span><span class='line'>    printf("&lt;td&gt;%s&lt;/td&gt;",$rst3['goods_name']);
</span><span class='line'>    printf("&lt;td&gt;%s&lt;/td&gt;",$rst3['goods_price']);
</span><span class='line'>    printf("&lt;td&gt;%d&lt;/td&gt;",$rst3['goods_number']);
</span><span class='line'>    printf("&lt;td&gt;%d&lt;/td&gt;",$rst3['goods_weight']);
</span><span class='line'>    printf("&lt;/tr&gt;");
</span><span class='line'>    $num++;
</span><span class='line'>}
</span><span class='line'>printf("&lt;tr&gt;&lt;td colspan='5'&gt;%s&lt;/td&gt;&lt;/tr&gt;",$page_list);
</span><span class='line'>echo "&lt;/table&gt;";</span></code></pre></td></tr></table></div></figure>


<p>ajax代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>    &lt;head&gt;
</span><span class='line'>        &lt;title&gt;新建网页&lt;/title&gt;
</span><span class='line'>        &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
</span><span class='line'>        &lt;meta name="description" content="" /&gt;
</span><span class='line'>        &lt;meta name="keywords" content="" /&gt;
</span><span class='line'>        &lt;script type="text/javascript"&gt;
</span><span class='line'>        //函数封装，实现ajax获取分页信息
</span><span class='line'>        function showpage(url){
</span><span class='line'>            var xhr = new XMLHttpRequest();
</span><span class='line'>            xhr.onreadystatechange = function(){
</span><span class='line'>                if(xhr.readyState==4){
</span><span class='line'>                    document.getElementById('result').innerHTML = xhr.responseText;
</span><span class='line'>                }
</span><span class='line'>            }
</span><span class='line'>            xhr.open('get',url);
</span><span class='line'>            xhr.send(null);
</span><span class='line'>        }
</span><span class='line'>        window.onload = function(){
</span><span class='line'>            showpage('./data.php');
</span><span class='line'>        }
</span><span class='line'>        &lt;/script&gt;
</span><span class='line'>        &lt;style type="text/css"&gt;
</span><span class='line'>        h2,div {width:700px; margin:auto;}
</span><span class='line'>        h2 {text-align:center;}
</span><span class='line'>        &lt;/style&gt;
</span><span class='line'>    &lt;/head&gt;
</span><span class='line'>    &lt;body&gt;
</span><span class='line'>        &lt;h2&gt;ajax无刷新分页&lt;/h2&gt;
</span><span class='line'>        &lt;div id="result"&gt;&lt;/div&gt;
</span><span class='line'>    &lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>用于分页包装好的代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>  class Page {
</span><span class='line'>      private $total; //数据表中总记录数
</span><span class='line'>      private $listRows; //每页显示行数
</span><span class='line'>      private $limit;
</span><span class='line'>      private $uri;
</span><span class='line'>      private $pageNum; //页数
</span><span class='line'>      private $config=array('header'=&gt;"个记录", "prev"=&gt;"上一页", "next"=&gt;"下一页", "first"=&gt;"首 页", "last"=&gt;"尾 页");
</span><span class='line'>      private $listNum=8;
</span><span class='line'>      /*
</span><span class='line'>       * $total 
</span><span class='line'>       * $listRows
</span><span class='line'>       */
</span><span class='line'>      public function __construct($total, $listRows=10, $pa=""){
</span><span class='line'>          $this-&gt;total=$total;
</span><span class='line'>          $this-&gt;listRows=$listRows;
</span><span class='line'>          $this-&gt;uri=$this-&gt;getUri($pa);
</span><span class='line'>          $this-&gt;page=!empty($_GET["page"]) ? $_GET["page"] : 1;
</span><span class='line'>          $this-&gt;pageNum=ceil($this-&gt;total/$this-&gt;listRows);
</span><span class='line'>          $this-&gt;limit=$this-&gt;setLimit();
</span><span class='line'>      }
</span><span class='line'>      private function setLimit(){
</span><span class='line'>          return "Limit ".($this-&gt;page-1)*$this-&gt;listRows.", {$this-&gt;listRows}";
</span><span class='line'>      }
</span><span class='line'>      private function getUri($pa){
</span><span class='line'>          $url=$_SERVER["REQUEST_URI"].(strpos($_SERVER["REQUEST_URI"], '?')?'':"?").$pa;
</span><span class='line'>          $parse=parse_url($url);
</span><span class='line'>          if(isset($parse["query"])){
</span><span class='line'>              parse_str($parse['query'],$params);
</span><span class='line'>              unset($params["page"]);
</span><span class='line'>              $url=$parse['path'].'?'.http_build_query($params);              
</span><span class='line'>          }
</span><span class='line'>          return $url;
</span><span class='line'>      }
</span><span class='line'>      function __get($args){
</span><span class='line'>          if($args=="limit")
</span><span class='line'>              return $this-&gt;limit;
</span><span class='line'>          else
</span><span class='line'>              return null;
</span><span class='line'>      }
</span><span class='line'>      private function start(){
</span><span class='line'>          if($this-&gt;total==0)
</span><span class='line'>              return 0;
</span><span class='line'>          else
</span><span class='line'>              return ($this-&gt;page-1)*$this-&gt;listRows+1;
</span><span class='line'>      }
</span><span class='line'>      private function end(){
</span><span class='line'>          return min($this-&gt;page*$this-&gt;listRows,$this-&gt;total);
</span><span class='line'>      }
</span><span class='line'>      private function first(){
</span><span class='line'>            $html = "";
</span><span class='line'>          if($this-&gt;page==1)
</span><span class='line'>              $html.='';
</span><span class='line'>          else
</span><span class='line'>              $html.="&nbsp;&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page=1\")'&gt;{$this-&gt;config["first"]}&lt;/a&gt;&nbsp;&nbsp;";
</span><span class='line'>          return $html;
</span><span class='line'>      }
</span><span class='line'>      private function prev(){
</span><span class='line'>            $html = "";
</span><span class='line'>          if($this-&gt;page==1)
</span><span class='line'>              $html.='';
</span><span class='line'>          else
</span><span class='line'>              $html.="&nbsp;&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page=".($this-&gt;page-1)."\")'&gt;{$this-&gt;config["prev"]}&lt;/a&gt;&nbsp;&nbsp;";
</span><span class='line'>          return $html;
</span><span class='line'>      }
</span><span class='line'>      private function pageList(){
</span><span class='line'>          $linkPage="";       
</span><span class='line'>          $inum=floor($this-&gt;listNum/2);   
</span><span class='line'>          for($i=$inum; $i&gt;=1; $i--){
</span><span class='line'>              $page=$this-&gt;page-$i;
</span><span class='line'>              if($page&lt;1)
</span><span class='line'>                  continue;
</span><span class='line'>              //$linkPage.="&nbsp;&lt;a href='{$this-&gt;uri}&page={$page}'&gt;{$page}&lt;/a&gt;&nbsp;";
</span><span class='line'>              $linkPage.="&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page={$page}\")'&gt;{$page}&lt;/a&gt;&nbsp;";
</span><span class='line'>          }   
</span><span class='line'>          $linkPage.="&nbsp;{$this-&gt;page}&nbsp;";
</span><span class='line'>          for($i=1; $i&lt;=$inum; $i++){
</span><span class='line'>              $page=$this-&gt;page+$i;
</span><span class='line'>              if($page&lt;=$this-&gt;pageNum){
</span><span class='line'>                  //$linkPage.="&nbsp;&lt;a href='{$this-&gt;uri}&page={$page}'&gt;{$page}&lt;/a&gt;&nbsp;";
</span><span class='line'>                    //把a超链接变为是showpage函数(ajax执行)调用
</span><span class='line'>                  $linkPage.="&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page={$page}\")'&gt;{$page}&lt;/a&gt;&nbsp;";
</span><span class='line'>              }else{
</span><span class='line'>                  break;
</span><span class='line'>                }
</span><span class='line'>          }
</span><span class='line'>          return $linkPage;
</span><span class='line'>      }
</span><span class='line'>      private function next(){
</span><span class='line'>            $html = "";
</span><span class='line'>          if($this-&gt;page==$this-&gt;pageNum)
</span><span class='line'>              $html.='';
</span><span class='line'>          else
</span><span class='line'>              $html.="&nbsp;&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page=".($this-&gt;page+1)."\")'&gt;{$this-&gt;config["next"]}&lt;/a&gt;&nbsp;&nbsp;";
</span><span class='line'>          return $html;
</span><span class='line'>      }
</span><span class='line'>      private function last(){
</span><span class='line'>            $html = "";
</span><span class='line'>          if($this-&gt;page==$this-&gt;pageNum)
</span><span class='line'>              $html.='';
</span><span class='line'>          else
</span><span class='line'>              $html.="&nbsp;&nbsp;&lt;a href='javascript:showpage(\"{$this-&gt;uri}&page=".($this-&gt;pageNum)."\")'&gt;{$this-&gt;config["last"]}&lt;/a&gt;&nbsp;&nbsp;";
</span><span class='line'>          return $html;
</span><span class='line'>      }
</span><span class='line'>      private function goPage(){
</span><span class='line'>          return '&nbsp;&nbsp;&lt;input type="text" onkeydown="javascript:if(event.keyCode==13){var page=(this.value&gt;'.$this-&gt;pageNum.')?'.$this-&gt;pageNum.':this.value;showpage(\''.$this-&gt;uri.'&page=\'+page+\'\')}" value="'.$this-&gt;page.'" style="width:25px"&gt;&lt;input type="button" value="GO" onclick="javascript:var page=(this.previousSibling.value&gt;'.$this-&gt;pageNum.')?'.$this-&gt;pageNum.':this.previousSibling.value;showpage(\''.$this-&gt;uri.'&page=\'+page+\'\')"&gt;&nbsp;&nbsp;';
</span><span class='line'>          //return '&nbsp;&nbsp;&lt;input type="text" onkeydown="javascript:if(event.keyCode==13){var page=(this.value&gt;'.$this-&gt;pageNum.')?'.$this-&gt;pageNum.':this.value;location=\''.$this-&gt;uri.'&page=\'+page+\'\'}" value="'.$this-&gt;page.'" style="width:25px"&gt;&lt;input type="button" value="GO" onclick="javascript:var page=(this.previousSibling.value&gt;'.$this-&gt;pageNum.')?'.$this-&gt;pageNum.':this.previousSibling.value;location=\''.$this-&gt;uri.'&page=\'+page+\'\'"&gt;&nbsp;&nbsp;';
</span><span class='line'>      }
</span><span class='line'>      function fpage($display=array(0,1,2,3,4,5,6,7,8)){
</span><span class='line'>          $html[0]="&nbsp;&nbsp;共有&lt;b&gt;{$this-&gt;total}&lt;/b&gt;{$this-&gt;config["header"]}&nbsp;&nbsp;";
</span><span class='line'>          $html[1]="&nbsp;&nbsp;每页显示&lt;b&gt;".($this-&gt;end()-$this-&gt;start()+1)."&lt;/b&gt;条，本页&lt;b&gt;{$this-&gt;start()}-{$this-&gt;end()}&lt;/b&gt;条&nbsp;&nbsp;";
</span><span class='line'>          $html[2]="&nbsp;&nbsp;&lt;b&gt;{$this-&gt;page}/{$this-&gt;pageNum}&lt;/b&gt;页&nbsp;&nbsp;";      
</span><span class='line'>          $html[3]=$this-&gt;first();
</span><span class='line'>          $html[4]=$this-&gt;prev();
</span><span class='line'>          $html[5]=$this-&gt;pageList();
</span><span class='line'>          $html[6]=$this-&gt;next();
</span><span class='line'>          $html[7]=$this-&gt;last();
</span><span class='line'>          $html[8]=$this-&gt;goPage();
</span><span class='line'>          $fpage='';
</span><span class='line'>          foreach($display as $index){
</span><span class='line'>              $fpage.=$html[$index];
</span><span class='line'>          }
</span><span class='line'>          return $fpage;
</span><span class='line'>      }
</span><span class='line'>  }</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ajax的get和post请求方式示例]]></title>
    <link href="http://hunter222.github.io/blog/2016/07/27/ajax-get-post/"/>
    <updated>2016-07-27T17:19:26+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/07/27/ajax-get-post</id>
    <content type="html"><![CDATA[<h5>1.两者的不同:</h5>

<p>① 给服务器传递数据量，get最多是2k
                       post原则没有限制，php.ini对其限制为8M</p>

<p>② 安全方面，post传递数据较安全</p>

<p>③ 传递数据的形式不一样
    get方式在url地址后边以请求字符串形式传递参数
    <a href="http://%E7%BD%91%E5%9D%80/index.php?name=tom&amp;age=23&amp;addr=beijing">http://%E7%BD%91%E5%9D%80/index.php?name=tom&amp;age=23&amp;addr=beijing</a>
    蓝色部分就是请求字符串，就是一些“名-值”对，中间使用&amp;符号连接。
    post方式是把form表单的数据给请求出来以xml形式传递给服务器</p>

<h5>2.处理特殊符号函数：</h5>

<p>在浏览器的地址栏里边传递一些特殊符号信息，会被误解，例如 &amp;  =  空格  中文。</p>

<p>在php里边可以函数函数 urlencode()/urldecode()对特殊符号进行编码、反编码处理
(url_encode()可以把中文转变为浏览器可以识别的信息。转变之后的信息具体为%号后接两个十六进制数)</p>

<p>在javascript里边可以通过encodeURIComponent ()对特殊符号等信息进行编码。
经过以上红色函数编码的内容在服务器端可以正常接收，不需要反编码。</p>

<h5>3.ajax总结：</h5>

<p>1.ajax对象创建</p>

<p> var xhr = new XMLHttpRequest();</p>

<p> var xhr = new ActiveXObject(‘Msxml2.XMLHTTP.6.0’);</p>

<p>2.ajax对象属性</p>

<p>readyState</p>

<p>responseText</p>

<p>onreadystatechange</p>

<p>3.ajax对象方法</p>

<p>open()</p>

<p>send()</p>

<p>setRequestHeader()</p>

<h5>4.实例代码:</h5>

<p>代码（get方式）:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>    &lt;head&gt;
</span><span class='line'>        &lt;title&gt;新建网页&lt;/title&gt;
</span><span class='line'>        &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
</span><span class='line'>        &lt;meta name="description" content="" /&gt;
</span><span class='line'>        &lt;meta name="keywords" content="" /&gt;
</span><span class='line'>        &lt;script type="text/javascript"&gt;
</span><span class='line'>        function checkname(){
</span><span class='line'>            //ajax负责抓取用户名信息，传递给服务器进行校验
</span><span class='line'>            //获得用户名信息
</span><span class='line'>            var nm = document.getElementById('username').value;
</span><span class='line'>            nm = encodeURIComponent(nm);//对浏览器容易混淆的信息进行编码处理
</span><span class='line'>            var xhr = new XMLHttpRequest();
</span><span class='line'>            xhr.onreadystatechange = function(){
</span><span class='line'>                if(xhr.readyState==4){
</span><span class='line'>                    alert(xhr.responseText);
</span><span class='line'>                }
</span><span class='line'>            }
</span><span class='line'>            xhr.open('get','./04.php?name='+nm);
</span><span class='line'>            xhr.send(null);
</span><span class='line'>        }
</span><span class='line'>        &lt;/script&gt;
</span><span class='line'>        &lt;style type="text/css"&gt;
</span><span class='line'>        &lt;/style&gt;
</span><span class='line'>    &lt;/head&gt;
</span><span class='line'>    &lt;body&gt;
</span><span class='line'>        &lt;h2&gt;get方式请求&lt;/h2&gt;
</span><span class='line'>        &lt;form method="post" action=""&gt;
</span><span class='line'>            &lt;p&gt;用户名：&lt;input type="text" name="username" id="username" onblur="checkname()"&gt;&lt;/p&gt;
</span><span class='line'>            &lt;p&gt;密码：&lt;input type="text" name="userpwd"&gt;&lt;/p&gt;
</span><span class='line'>            &lt;p&gt;&lt;input type="submit" value="注册"&gt;&lt;/p&gt;
</span><span class='line'>        &lt;/form&gt;
</span><span class='line'>    &lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>js代码(post方式)：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function checkname() 
</span><span class='line'>                  {
</span><span class='line'>                        //ajax负责抓取用户名信息，传递给服务器进行校验
</span><span class='line'>                        //获得用户名信息
</span><span class='line'>                        var nm = document.getElementById('username').value;
</span><span class='line'>                        nm = encodeURIComponent(nm);
</span><span class='line'>                        var xhr = new XMLHttpRequest();
</span><span class='line'>                        xhr.onreadystatechange = function () {
</span><span class='line'>                            if (xhr.readyState == 4) {
</span><span class='line'>                                alert(xhr.responseText);
</span><span class='line'>                            }
</span><span class='line'>                        }
</span><span class='line'>                        xhr.open('post', './06.php');
</span><span class='line'>                        //post模仿form表单把数据传递给服务器端
</span><span class='line'>                        //form表单把数据组织为“xml格式”传递给服务器端
</span><span class='line'>                        //把传递的数据组织为请求字符串
</span><span class='line'>                        //以下方法设置header头信息，作用把传递的数据组织为xml格式
</span><span class='line'>                        //(要在open()方法执行之后设置)
</span><span class='line'>                        xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');
</span><span class='line'>                        var info = "name=" + nm;
</span><span class='line'>                        xhr.send(info);
</span><span class='line'>                   }</span></code></pre></td></tr></table></div></figure>


<p>06.php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>header('Content-Type:text/html;charset=utf8');
</span><span class='line'>$conn = mysqli_connect("localhost","root","1234567","db_liuyanben");
</span><span class='line'>$sql=mysqli_query($conn,"select Username from tb_user where Username='".$_POST["name"]."'");
</span><span class='line'>$sq = mysqli_fetch_array($sql, MYSQLI_BOTH);
</span><span class='line'>if($_POST['name']==$sq['Username']){
</span><span class='line'>    echo '正确';
</span><span class='line'>}  else {
</span><span class='line'>    echo '不正确';
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<hr />

<p>layout: post
title: &ldquo;ajax的无刷新分页显示&rdquo;
date: 2016-07-27 17:19:26 +0800
comments: true</p>

<h2>categories: [js,php,ajax]</h2>

<h5>1.两者的不同:</h5>

<p>① 给服务器传递数据量，get最多是2k
                       post原则没有限制，php.ini对其限制为8M</p>

<p>② 安全方面，post传递数据较安全</p>

<p>③ 传递数据的形式不一样
    get方式在url地址后边以请求字符串形式传递参数
    <a href="http://%E7%BD%91%E5%9D%80/index.php?name=tom&amp;age=23&amp;addr=beijing">http://%E7%BD%91%E5%9D%80/index.php?name=tom&amp;age=23&amp;addr=beijing</a>
    蓝色部分就是请求字符串，就是一些“名-值”对，中间使用&amp;符号连接。
    post方式是把form表单的数据给请求出来以xml形式传递给服务器</p>

<h5>2.处理特殊符号函数：</h5>

<p>在浏览器的地址栏里边传递一些特殊符号信息，会被误解，例如 &amp;  =  空格  中文。</p>

<p>在php里边可以函数函数 urlencode()/urldecode()对特殊符号进行编码、反编码处理
(url_encode()可以把中文转变为浏览器可以识别的信息。转变之后的信息具体为%号后接两个十六进制数)</p>

<p>在javascript里边可以通过encodeURIComponent ()对特殊符号等信息进行编码。
经过以上红色函数编码的内容在服务器端可以正常接收，不需要反编码。</p>

<h5>3.ajax总结：</h5>

<p>1.ajax对象创建</p>

<p> var xhr = new XMLHttpRequest();</p>

<p> var xhr = new ActiveXObject(‘Msxml2.XMLHTTP.6.0’);</p>

<p>2.ajax对象属性</p>

<p>readyState</p>

<p>responseText</p>

<p>onreadystatechange</p>

<p>3.ajax对象方法</p>

<p>open()</p>

<p>send()</p>

<p>setRequestHeader()</p>

<h5>4.实例代码:</h5>

<p>代码（get方式）:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>    &lt;head&gt;
</span><span class='line'>        &lt;title&gt;新建网页&lt;/title&gt;
</span><span class='line'>        &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
</span><span class='line'>        &lt;meta name="description" content="" /&gt;
</span><span class='line'>        &lt;meta name="keywords" content="" /&gt;
</span><span class='line'>        &lt;script type="text/javascript"&gt;
</span><span class='line'>        function checkname(){
</span><span class='line'>            //ajax负责抓取用户名信息，传递给服务器进行校验
</span><span class='line'>            //获得用户名信息
</span><span class='line'>            var nm = document.getElementById('username').value;
</span><span class='line'>            nm = encodeURIComponent(nm);//对浏览器容易混淆的信息进行编码处理
</span><span class='line'>            var xhr = new XMLHttpRequest();
</span><span class='line'>            xhr.onreadystatechange = function(){
</span><span class='line'>                if(xhr.readyState==4){
</span><span class='line'>                    alert(xhr.responseText);
</span><span class='line'>                }
</span><span class='line'>            }
</span><span class='line'>            xhr.open('get','./04.php?name='+nm);
</span><span class='line'>            xhr.send(null);
</span><span class='line'>        }
</span><span class='line'>        &lt;/script&gt;
</span><span class='line'>        &lt;style type="text/css"&gt;
</span><span class='line'>        &lt;/style&gt;
</span><span class='line'>    &lt;/head&gt;
</span><span class='line'>    &lt;body&gt;
</span><span class='line'>        &lt;h2&gt;get方式请求&lt;/h2&gt;
</span><span class='line'>        &lt;form method="post" action=""&gt;
</span><span class='line'>            &lt;p&gt;用户名：&lt;input type="text" name="username" id="username" onblur="checkname()"&gt;&lt;/p&gt;
</span><span class='line'>            &lt;p&gt;密码：&lt;input type="text" name="userpwd"&gt;&lt;/p&gt;
</span><span class='line'>            &lt;p&gt;&lt;input type="submit" value="注册"&gt;&lt;/p&gt;
</span><span class='line'>        &lt;/form&gt;
</span><span class='line'>    &lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>js代码(post方式)：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function checkname() 
</span><span class='line'>                  {
</span><span class='line'>                        //ajax负责抓取用户名信息，传递给服务器进行校验
</span><span class='line'>                        //获得用户名信息
</span><span class='line'>                        var nm = document.getElementById('username').value;
</span><span class='line'>                        nm = encodeURIComponent(nm);
</span><span class='line'>                        var xhr = new XMLHttpRequest();
</span><span class='line'>                        xhr.onreadystatechange = function () {
</span><span class='line'>                            if (xhr.readyState == 4) {
</span><span class='line'>                                alert(xhr.responseText);
</span><span class='line'>                            }
</span><span class='line'>                        }
</span><span class='line'>                        xhr.open('post', './06.php');
</span><span class='line'>                        //post模仿form表单把数据传递给服务器端
</span><span class='line'>                        //form表单把数据组织为“xml格式”传递给服务器端
</span><span class='line'>                        //把传递的数据组织为请求字符串
</span><span class='line'>                        //以下方法设置header头信息，作用把传递的数据组织为xml格式
</span><span class='line'>                        //(要在open()方法执行之后设置)
</span><span class='line'>                        xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');
</span><span class='line'>                        var info = "name=" + nm;
</span><span class='line'>                        xhr.send(info);
</span><span class='line'>                   }</span></code></pre></td></tr></table></div></figure>


<p>06.php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>header('Content-Type:text/html;charset=utf8');
</span><span class='line'>$conn = mysqli_connect("localhost","root","1234567","db_liuyanben");
</span><span class='line'>$sql=mysqli_query($conn,"select Username from tb_user where Username='".$_POST["name"]."'");
</span><span class='line'>$sq = mysqli_fetch_array($sql, MYSQLI_BOTH);
</span><span class='line'>if($_POST['name']==$sq['Username']){
</span><span class='line'>    echo '正确';
</span><span class='line'>}  else {
</span><span class='line'>    echo '不正确';
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[49点php编程重点知识]]></title>
    <link href="http://hunter222.github.io/blog/2016/07/27/php/"/>
    <updated>2016-07-27T10:46:19+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/07/27/php</id>
    <content type="html"><![CDATA[<h5>php是门复杂而繁琐的语言，想要学好它，那必须得下点功夫，春哥技术博客总结一些提高PHP编程效率的要点，供大家学习参考。</h5>

<h5>前奏：用单引号代替双引号来包含字符串，这样做会更快一些。因为PHP会在双引号包围的字符串中搜寻变量，单引号则不会，注意：只有echo能这么做，它是一种可以把多个字符串当作参数的“函数”（译注：PHP手册中说echo是语言结构，不是真正的函数，故把函数加上了双引号）</h5>

<p>1、如果能将类的方法定义成static，就尽量定义成static，它的速度会提升将近4倍。</p>

<p>2、$row[’id’] 的速度是$row[id]的7倍。</p>

<p>3、echo 比 print 快，并且使用echo的多重参数（译注：指用逗号而不是句点）代替字符串连接，比如echo $str1,$str2。</p>

<p>4、在执行for循环之前确定最大循环数，不要每循环一次都计算最大值，最好运用foreach代替。</p>

<p>5、注销那些不用的变量尤其是大数组，以便释放内存。</p>

<p>6、尽量避免使用<strong>get，</strong>set，__autoload。</p>

<p>7、require_once()代价昂贵。</p>

<p>8、include文件时尽量使用绝对路径，因为它避免了PHP去include_path里查找文件的速度，解析操作系统路径所需的时间会更少。</p>

<p>9、如果你想知道脚本开始执行（译注：即服务器端收到客户端请求）的时刻，使用$_SERVER[‘REQUEST_TIME’]要好于time()。</p>

<p>10、函数代替正则表达式完成相同功能。</p>

<p>11、str_replace函数比preg_replace函数快，但strtr函数的效率是str_replace函数的四倍。</p>

<p>12、如果一个字符串替换函数，可接受数组或字符作为参数，并且参数长度不太长，那么可以考虑额外写一段替换代码，使得每次传递参数是一个字符，而不是只写一行代码接受数组作为查询和替</p>

<p>换的参数。</p>

<p>13、使用选择分支语句（译注：即switch case）好于使用多个if，else if语句。</p>

<p>14、用@屏蔽错误消息的做法非常低效，极其低效。</p>

<p>15、打开apache的mod_deflate模块，可以提高网页的浏览速度。</p>

<p>16、数据库连接当使用完毕时应关掉，不要用长连接。</p>

<p>17、错误消息代价昂贵。</p>

<p>18、在方法中递增局部变量，速度是最快的。几乎与在函数中调用局部变量的速度相当。</p>

<p>19、递增一个全局变量要比递增一个局部变量慢2倍。</p>

<p>20、递增一个对象属性（如：$this->prop++）要比递增一个局部变量慢3倍。</p>

<p>21、递增一个未预定义的局部变量要比递增一个预定义的局部变量慢9至10倍。</p>

<p>22、仅定义一个局部变量而没在函数中调用它，同样会减慢速度（其程度相当于递增一个局部变量）。PHP大概会检查看是否存在全局变量。</p>

<p>23、方法调用看来与类中定义的方法的数量无关，因为我（在测试方法之前和之后都）添加了10个方法，但性能上没有变化。</p>

<p>24、派生类中的方法运行起来要快于在基类中定义的同样的方法。</p>

<p>25、调用带有一个参数的空函数，其花费的时间相当于执行7至8次的局部变量递增操作。类似的方法调用所花费的时间接近于15次的局部变量递增操作。</p>

<p>26、Apache解析一个PHP脚本的时间要比解析一个静态HTML页面慢2至10倍。尽量多用静态HTML页面，少用脚本。</p>

<p>27、除非脚本可以缓存，否则每次调用时都会重新编译一次。引入一套PHP缓存机制通常可以提升25%至100%的性能，以免除编译开销。</p>

<p>28、尽量做缓存，可使用memcached。memcached是一款高性能的内存对象缓存系统，可用来加速动态Web应用程序，减轻数据库负载。对运算码 (OP code)的缓存很有用，使得脚本不必为每个请求做</p>

<p>重新编译。</p>

<p>29、当操作字符串并需要检验其长度是否满足某种要求时，你想当然地会使用strlen()函数。此函数执行起来相当快，因为它不做任何计算，只返回在zval 结构（C的内置数据结构，用于存储PHP变</p>

<p>量）中存储的已知字符串长度。但是，由于strlen()是函数，多多少少会有些慢，因为函数调用会经过诸多步骤，如字母小写化（译注：指函数名小写化，PHP不区分函数名大小写）、哈希查找，会跟随</p>

<p>被调用的函数一起执行。在某些情况下，你可以使用isset() 技巧加速执行你的代码。</p>

<p>（举例如下）</p>

<p>if (strlen($foo) &lt; 5) { echo “Foo is too short”$$ }</p>

<p>（与下面的技巧做比较）</p>

<p>if (!isset($foo{5})) { echo “Foo is too short”$$ }</p>

<p>调用isset()恰巧比strlen()快，因为与后者不同的是，isset()作为一种语言结构，意味着它的执行不需要函数查找和字母小写化。也就是说，实际上在检验字符串长度的顶层代码中你没有花太多</p>

<p>开销。</p>

<p>30、当执行变量$i的递增或递减时，$i++会比++$i慢一些。这种差异是PHP特有的，并不适用于其他语言，所以请不要修改你的C或Java代码并指望它们能立即变快，没用的。++$i更快是因为它只需</p>

<p>要3条指令(opcodes)，$i++则需要4条指令。后置递增实际上会产生一个临时变量，这个临时变量随后被递增。而前置递增直接在原值上递增。这是最优化处理的一种，正如Zend的PHP优化器所作的那样</p>

<p>。牢记这个优化处理不失为一个好主意，因为并不是所有的指令优化器都会做同样的优化处理，并且存在大量没有装配指令优化器的互联网服务提供商（ISPs）和服务器。</p>

<p>31、并不是事必面向对象(OOP)，面向对象往往开销很大，每个方法和对象调用都会消耗很多内存。</p>

<p>32、并非要用类实现所有的数据结构，数组也很有用。</p>

<p>33、不要把方法细分得过多，仔细想想你真正打算重用的是哪些代码？</p>

<p>34、当你需要时，你总能把代码分解成方法。</p>

<p>35、尽量采用大量的PHP内置函数。</p>

<p>36、如果在代码中存在大量耗时的函数，你可以考虑用C扩展的方式实现它们。</p>

<p>37、评估检验(profile)你的代码。检验器会告诉你，代码的哪些部分消耗了多少时间。Xdebug调试器包含了检验程序，评估检验总体上可以显示出代码的瓶颈。</p>

<p>38、mod_zip可作为Apache模块，用来即时压缩你的数据，并可让数据传输量降低80%。</p>

<p>39、在可以用file_get_contents替代file、fopen、feof、fgets等系列方法的情况下，尽量用file_get_contents，因为他的效率高得多！但是要注意file_get_contents在打开一个URL文件时候的</p>

<p>PHP版本问题；</p>

<p>40、尽量的少进行文件操作，虽然PHP的文件操作效率也不低的；</p>

<p>41、优化Select SQL语句，在可能的情况下尽量少的进行Insert、Update操作(在update上，我被恶批过)；</p>

<p>42、尽可能的使用PHP内部函数（但是我却为了找个PHP里面不存在的函数，浪费了本可以写出一个自定义函数的时间，经验问题啊！）；</p>

<p>43、循环内部不要声明变量，尤其是大变量：对象(这好像不只是PHP里面要注意的问题吧？)；</p>

<p>44、多维数组尽量不要循环嵌套赋值；</p>

<p>45、在可以用PHP内部字符串操作函数的情况下，不要用正则表达式；</p>

<p>46、foreach效率更高，尽量用foreach代替while和for循环；</p>

<p>47、用单引号替代双引号引用字符串；</p>

<p>48、“用i+=1代替i=i+1。符合c/c++的习惯，效率还高”；</p>

<p>49、对global变量，应该用完就unset()掉；</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHP mysql函数及其Mysqli函数代替用法]]></title>
    <link href="http://hunter222.github.io/blog/2016/07/27/mysqli/"/>
    <updated>2016-07-27T10:27:18+08:00</updated>
    <id>http://hunter222.github.io/blog/2016/07/27/mysqli</id>
    <content type="html"><![CDATA[<h4>由于MySQL扩展从php 5.5开始弃用，所以以后不推荐大家再用MySQL扩展，请用MySQLi或PDO代替，以下是MySQL对应的MySQLi函数（绿色字体）供大家参考。（注：PHP手册上的有误，这里是最准的）</h4>

<h4>MySQL>>(从PHP 5.5开始弃用)</h4>

<h4>mysql_affected_rows — （mysqli_affected_rows()）取得前一次 MySQL 操作所影响的记录行数</h4>

<h4>mysql_client_encoding — （mysqli_character_set_name()）返回字符集的名称(返回当前连接的默认字符集名称。)</h4>

<h4>mysql_close — （mysqli_close()）关闭 MySQL 连接</h4>

<h4>mysql_connect — （mysqli_connect()）打开一个到 MySQL 服务器的连接</h4>

<h4>mysql_create_db — （mysqli_query() then CREATE DATABASE）新建一个 MySQL 数据库(废弃)(用 mysql_query() 来提交一条 SQL 的 CREATE DATABASE 语句来代替)</h4>

<h4>mysql_data_seek — （mysqli_data_seek()）移动内部结果的指针</h4>

<h4>mysql_db_name — （Query: SELECT DATABASE()非全等）取得 mysql_list_dbs() 调用所返回的数据库名</h4>

<h4>mysql_db_query — （mysqli_select_db() then the mysqli_query()）选择一个数据库并在它上面执行一个查询 从 PHP 5.3.0 起弃用 用 mysql_select_db() 和 mysql_query() 代替</h4>

<h4>mysql_drop_db — （Execute a DROP DATABASE query）丢弃（删除）一个 MySQL 数据库(废弃)(用 mysql_query() 提交一条 SQL DROP DATABASE 语句来替代)</h4>

<h4>mysql_errno — （mysqli_errno()）返回上一个 MySQL 操作中的错误信息的数字编码</h4>

<h4>mysql_error — （mysqli_error()）返回上一个 MySQL 操作产生的文本错误信息</h4>

<h4>mysql_escape_string — （mysqli_escape_string()）转义一个字符串用于mysql_query从PHP 5.3.0起弃用用 mysql_real_escape_string() 代替</h4>

<h4>mysql_fetch_array — （mysqli_fetch_array()）从结果集中取得一行作为关联数组，或数字数组，或二者兼有</h4>

<h4>mysql_fetch_assoc — （mysqli_fetch_assoc()）从结果集中取得一行作为关联数组</h4>

<h4>mysql_fetch_field — （mysqli_fetch_field()）从结果集中取得列信息并作为对象返回</h4>

<h4>mysql_fetch_lengths — （mysqli_fetch_lengths()）取得结果集中每个输出的长度</h4>

<h4>mysql_fetch_object — （mysqli_fetch_object()）从结果集中取得一行作为对象</h4>

<h4>mysql_fetch_row — （mysqli_fetch_row()）从结果集中取得一行作为枚举数组</h4>

<h4>mysql_field_flags — （mysqli_fetch_fields() [flags]?）从结果中取得和指定字段关联的标志</h4>

<h4>mysql_field_len — （mysqli_fetch_field_direct() [length]）返回指定字段的长度</h4>

<h4>mysql_field_name — （mysqli_fetch_field_direct() [name] or [orgname]）取得结果中指定字段的字段名</h4>

<h4>mysql_field_seek — （mysqli_field_seek()）将结果集中的指针设定为指定的字段偏移量</h4>

<h4>mysql_field_table — （mysqli_fetch_field_direct() [table] or [orgtable]）取得指定字段所在的表名</h4>

<h4>mysql_field_type — （mysqli_fetch_field_direct() [type]）取得结果集中指定字段的类型</h4>

<h4>mysql_free_result — （mysqli_free_result()）释放结果内存</h4>

<h4>mysql_get_client_info — （mysqli_get_client_info()）取得 MySQL 客户端信息</h4>

<h4>mysql_get_host_info — （mysqli_get_host_info()）取得 MySQL 主机信息</h4>

<h4>mysql_get_proto_info — （mysqli_get_proto_info()）取得 MySQL 协议信息</h4>

<h4>mysql_get_server_info — （mysqli_get_server_info()）取得 MySQL 服务器信息</h4>

<h4>mysql_info — （mysqli_info()）取得最近一条查询的信息</h4>

<h4>mysql_insert_id — （mysqli_insert_id()）取得上一步 INSERT 操作产生的 ID（得到在最后一次查询生成的id）</h4>

<h4>mysql_list_dbs — （SQL Query: SHOW DATABASES）列出 MySQL 服务器中所有可用的数据库（从php5.4.0弃用）(用SQL 查询: SHOW DATABASES代替)</h4>

<h4>mysql_list_fields — （SQL Query: SHOW COLUMNS FROM sometable）列出 MySQL 表字段（取得给定表名的信息）（弃用）(已过时。最好用 mysql_query() 来发出一条 SHOW COLUMNS FROM table [LIKE &lsquo;name&rsquo;] 的 SQL 语句来代替。)</h4>

<h4>mysql_list_processes — （mysqli_thread_id()不全等）列出 MySQL 进程</h4>

<h4>mysql_list_tables —（SQL Query: SHOW TABLES FROM db_name） 列出 MySQL 数据库中的表（弃用）(已弃用。 使用 mysql_query() 发出一个SQL SHOW TABLES [FROM db_name] [LIKE &lsquo;pattern&rsquo;]语句代替. )</h4>

<h4>mysql_num_fields — （mysqli_field_count()）取得结果集中字段的数目</h4>

<h4>mysql_num_rows — （mysqli_num_rows(),mysqli_stmt_num_rows()）取得结果集中行的数目</h4>

<h4>mysql_pconnect — （mysqli_connect() with p: host prefix）打开一个到 MySQL 服务器的持久连接</h4>

<h4>mysql_ping — （mysqli_ping()）Ping 一个服务器连接，如果没有连接则重新连接</h4>

<h4>mysql_query — （mysqli_query()）发送一条 MySQL 查询</h4>

<h4>mysql_real_escape_string — （mysqli_real_escape_string()）转义 SQL 语句中使用的字符串中的特殊字符，并考虑到连接的当前字符集</h4>

<h4>mysql_result — （mysqli_data_seek() 联合 mysqli_field_seek() and mysqli_fetch_field()）取得结果数据</h4>

<h4>mysql_select_db — （mysqli_select_db()）选择 MySQL 数据库</h4>

<h4>mysql_set_charset — （mysqli_set_charset()）设置客户端字符集</h4>

<h4>mysql_stat — （mysqli_stat()）取得当前系统状态</h4>

<h4>mysql_tablename — （SQL Query: SHOW TABLES）取得表名（取得字段的表名）（弃用）(已弃用。 使用 mysql_query() 发出一个 SQL SHOW TABLES [FROM db_name] [LIKE &lsquo;pattern&rsquo;] 语句代替. )</h4>

<h4>mysql_thread_id — （mysqli_thread_id()）返回当前线程的 ID</h4>

<h4>mysql_unbuffered_query — （mysqli_query(“SQL语句”, MYSQLI_USE_RESULT); ）向 MySQL 发送一条 SQL 查询，并不获取和缓存结果的行</h4>
]]></content>
  </entry>
  
</feed>
